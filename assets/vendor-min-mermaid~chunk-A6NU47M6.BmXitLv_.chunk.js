const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/vendor-mermaid.B3CZdIAj.chunk.js","assets/vendor-min-mermaid~architectureDiagram-4X3Z3J56.BpJofp52.chunk.js","assets/vendor-min-mermaid~architecture-U656AL7Q-3ZQKGQJL.j2WEiM7o.chunk.js","assets/vendor-min-mermaid~blockDiagram-MFEFEJY7.BcfquVtv.chunk.js","assets/vendor-min-mermaid~chunk-5V7UUW6L.qEQJ-_fG.chunk.js","assets/vendor-min-mermaid~chunk-QK4BHB5Z.4LdOR-E5.chunk.js","assets/vendor-min-mermaid~dagre-5ZHZFEXP.BV11ku3m.chunk.js","assets/vendor-mermaid.DqVWL8RZ.chunk.js","assets/vendor-min-mermaid~cose-bilkent-AZ5BDB2T.DePJWmvX.chunk.js"])))=>i.map(i=>d[i]);
import{Bt as e,Gt as t,H as n,Ht as r,Kt as i,Nn as a,Nt as o,Pt as s,Qt as c,St as l,Vt as u,W as d,Zt as f,_ as p,an as m,bt as h,dt as g,gt as _,h as v,hn as y,ht as b,jt as x,l as S,ln as C,nt as w,q as T,s as E,sn as D,u as O,v as k,vt as A,w as j,x as M,yn as N}from"./vendor-min-mermaid~architectureDiagram-4X3Z3J56.BpJofp52.chunk.js";import{Q as P}from"./vendor-min-mermaid~architecture-U656AL7Q-3ZQKGQJL.j2WEiM7o.chunk.js";import{a as ee,i as te,n as ne,r as re}from"./vendor-min-mermaid~blockDiagram-MFEFEJY7.BcfquVtv.chunk.js";import{a as F,i as I,n as L,r as R,t as z}from"./vendor-min-mermaid~chunk-5V7UUW6L.qEQJ-_fG.chunk.js";var B=P(async(e,t,r)=>{let i,a=t.useHtmlLabels||n(_()?.htmlLabels);i=r||`node default`;let o=e.insert(`g`).attr(`class`,i).attr(`id`,t.domId||t.id),s=o.insert(`g`).attr(`class`,`label`).attr(`style`,k(t.labelStyle)),c;c=t.label===void 0?``:typeof t.label==`string`?t.label:t.label[0];let l=await E(s,h(M(c),_()),{useHtmlLabels:a,width:t.width||_().flowchart?.wrappingWidth,cssClasses:`markdown-node-label`,style:t.labelStyle,addSvgBackground:!!t.icon||!!t.img}),u=l.getBBox(),f=(t?.padding??0)/2;if(a){let e=l.children[0],t=C(l),n=e.getElementsByTagName(`img`);if(n){let e=c.replace(/<img[^>]*>/g,``).trim()===``;await Promise.all([...n].map(t=>new Promise(n=>{function r(){if(t.style.display=`flex`,t.style.flexDirection=`column`,e){let[e=d.fontSize]=O(_().fontSize?_().fontSize:window.getComputedStyle(document.body).fontSize),n=e*5+`px`;t.style.minWidth=n,t.style.maxWidth=n}else t.style.width=`100%`;n(t)}P(r,`setupImage`),setTimeout(()=>{t.complete&&r()}),t.addEventListener(`error`,r),t.addEventListener(`load`,r)})))}u=e.getBoundingClientRect(),t.attr(`width`,u.width),t.attr(`height`,u.height)}return a?s.attr(`transform`,`translate(`+-u.width/2+`, `+-u.height/2+`)`):s.attr(`transform`,`translate(0, `+-u.height/2+`)`),t.centerLabel&&s.attr(`transform`,`translate(`+-u.width/2+`, `+-u.height/2+`)`),s.insert(`rect`,`:first-child`),{shapeSvg:o,bbox:u,halfPadding:f,label:s}},`labelHelper`),ie=P(async(e,t,r)=>{let i=r.useHtmlLabels||n(_()?.flowchart?.htmlLabels),a=e.insert(`g`).attr(`class`,`label`).attr(`style`,r.labelStyle||``),o=await E(a,h(M(t),_()),{useHtmlLabels:i,width:r.width||_()?.flowchart?.wrappingWidth,style:r.labelStyle,addSvgBackground:!!r.icon||!!r.img}),s=o.getBBox(),c=r.padding/2;if(n(_()?.flowchart?.htmlLabels)){let e=o.children[0],t=C(o);s=e.getBoundingClientRect(),t.attr(`width`,s.width),t.attr(`height`,s.height)}return i?a.attr(`transform`,`translate(`+-s.width/2+`, `+-s.height/2+`)`):a.attr(`transform`,`translate(0, `+-s.height/2+`)`),r.centerLabel&&a.attr(`transform`,`translate(`+-s.width/2+`, `+-s.height/2+`)`),a.insert(`rect`,`:first-child`),{shapeSvg:e,bbox:s,halfPadding:c,label:a}},`insertLabel`),V=P((e,t)=>{let n=t.node().getBBox();e.width=n.width,e.height=n.height},`updateNodeBounds`),H=P((e,t)=>(e.look===`handDrawn`?`rough-node`:`node`)+` `+e.cssClasses+` `+(t||``),`getNodeClasses`);function U(e){let t=e.map((e,t)=>`${t===0?`M`:`L`}${e.x},${e.y}`);return t.push(`Z`),t.join(` `)}P(U,`createPathFromPoints`);function W(e,t,n,r,i,a){let o=[],s=n-e,c=r-t,l=s/a,u=2*Math.PI/l,d=t+c/2;for(let t=0;t<=50;t++){let n=e+t/50*s,r=d+i*Math.sin(u*(n-e));o.push({x:n,y:r})}return o}P(W,`generateFullSineWavePoints`);function ae(e,t,n,r,i,a){let o=[],s=i*Math.PI/180,c=(a*Math.PI/180-s)/(r-1);for(let i=0;i<r;i++){let r=s+i*c,a=e+n*Math.cos(r),l=t+n*Math.sin(r);o.push({x:-a,y:-l})}return o}P(ae,`generateCirclePoints`);function oe(e,t,n){if(e&&e.length){let[r,i]=t,a=Math.PI/180*n,o=Math.cos(a),s=Math.sin(a);for(let t of e){let[e,n]=t;t[0]=(e-r)*o-(n-i)*s+r,t[1]=(e-r)*s+(n-i)*o+i}}}P(oe,`t`);function se(e,t){return e[0]===t[0]&&e[1]===t[1]}P(se,`e`);function ce(e,t,n,r=1){let i=n,a=Math.max(t,.1),o=e[0]&&e[0][0]&&typeof e[0][0]==`number`?[e]:e,s=[0,0];if(i)for(let e of o)oe(e,s,i);let c=function(e,t,n){let r=[];for(let t of e){let e=[...t];se(e[0],e[e.length-1])||e.push([e[0][0],e[0][1]]),e.length>2&&r.push(e)}let i=[];t=Math.max(t,.1);let a=[];for(let e of r)for(let t=0;t<e.length-1;t++){let n=e[t],r=e[t+1];if(n[1]!==r[1]){let e=Math.min(n[1],r[1]);a.push({ymin:e,ymax:Math.max(n[1],r[1]),x:e===n[1]?n[0]:r[0],islope:(r[0]-n[0])/(r[1]-n[1])})}}if(a.sort((e,t)=>e.ymin<t.ymin?-1:e.ymin>t.ymin?1:e.x<t.x?-1:e.x>t.x?1:e.ymax===t.ymax?0:(e.ymax-t.ymax)/Math.abs(e.ymax-t.ymax)),!a.length)return i;let o=[],s=a[0].ymin,c=0;for(;o.length||a.length;){if(a.length){let e=-1;for(let t=0;t<a.length&&!(a[t].ymin>s);t++)e=t;a.splice(0,e+1).forEach(e=>{o.push({s,edge:e})})}if(o=o.filter(e=>!(e.edge.ymax<=s)),o.sort((e,t)=>e.edge.x===t.edge.x?0:(e.edge.x-t.edge.x)/Math.abs(e.edge.x-t.edge.x)),(n!==1||c%t==0)&&o.length>1)for(let e=0;e<o.length;e+=2){let t=e+1;if(t>=o.length)break;let n=o[e].edge,r=o[t].edge;i.push([[Math.round(n.x),s],[Math.round(r.x),s]])}s+=n,o.forEach(e=>{e.edge.x=e.edge.x+n*e.edge.islope}),c++}return i}(o,a,r);if(i){for(let e of o)oe(e,s,-i);(function(e,t,n){let r=[];e.forEach(e=>r.push(...e)),oe(r,t,n)})(c,s,-i)}return c}P(ce,`s`);function le(e,t){let n=t.hachureAngle+90,r=t.hachureGap;r<0&&(r=4*t.strokeWidth),r=Math.round(Math.max(r,.1));let i=1;return t.roughness>=1&&(t.randomizer?.next()||Math.random())>.7&&(i=r),ce(e,r,n,i||1)}P(le,`n`);var ue=class{static{P(this,`o`)}constructor(e){this.helper=e}fillPolygons(e,t){return this._fillPolygons(e,t)}_fillPolygons(e,t){let n=le(e,t);return{type:`fillSketch`,ops:this.renderLines(n,t)}}renderLines(e,t){let n=[];for(let r of e)n.push(...this.helper.doubleLineOps(r[0][0],r[0][1],r[1][0],r[1][1],t));return n}};function de(e){let t=e[0],n=e[1];return Math.sqrt((t[0]-n[0])**2+(t[1]-n[1])**2)}P(de,`a`);var fe=class extends ue{static{P(this,`h`)}fillPolygons(e,t){let n=t.hachureGap;n<0&&(n=4*t.strokeWidth),n=Math.max(n,.1);let r=le(e,Object.assign({},t,{hachureGap:n})),i=Math.PI/180*t.hachureAngle,a=[],o=.5*n*Math.cos(i),s=.5*n*Math.sin(i);for(let[e,t]of r)de([e,t])&&a.push([[e[0]-o,e[1]+s],[...t]],[[e[0]+o,e[1]-s],[...t]]);return{type:`fillSketch`,ops:this.renderLines(a,t)}}},pe=class extends ue{static{P(this,`r`)}fillPolygons(e,t){let n=this._fillPolygons(e,t),r=Object.assign({},t,{hachureAngle:t.hachureAngle+90}),i=this._fillPolygons(e,r);return n.ops=n.ops.concat(i.ops),n}},me=class{static{P(this,`i`)}constructor(e){this.helper=e}fillPolygons(e,t){let n=le(e,t=Object.assign({},t,{hachureAngle:0}));return this.dotsOnLines(n,t)}dotsOnLines(e,t){let n=[],r=t.hachureGap;r<0&&(r=4*t.strokeWidth),r=Math.max(r,.1);let i=t.fillWeight;i<0&&(i=t.strokeWidth/2);let a=r/4;for(let o of e){let e=de(o),s=e/r,c=Math.ceil(s)-1,l=e-c*r,u=(o[0][0]+o[1][0])/2-r/4,d=Math.min(o[0][1],o[1][1]);for(let e=0;e<c;e++){let o=d+l+e*r,s=u-a+2*Math.random()*a,c=o-a+2*Math.random()*a,f=this.helper.ellipse(s,c,i,i,t);n.push(...f.ops)}}return{type:`fillSketch`,ops:n}}},he=class{static{P(this,`c`)}constructor(e){this.helper=e}fillPolygons(e,t){let n=le(e,t);return{type:`fillSketch`,ops:this.dashedLine(n,t)}}dashedLine(e,t){let n=t.dashOffset<0?t.hachureGap<0?4*t.strokeWidth:t.hachureGap:t.dashOffset,r=t.dashGap<0?t.hachureGap<0?4*t.strokeWidth:t.hachureGap:t.dashGap,i=[];return e.forEach(e=>{let a=de(e),o=Math.floor(a/(n+r)),s=(a+r-o*(n+r))/2,c=e[0],l=e[1];c[0]>l[0]&&(c=e[1],l=e[0]);let u=Math.atan((l[1]-c[1])/(l[0]-c[0]));for(let e=0;e<o;e++){let a=e*(n+r),o=a+n,l=[c[0]+a*Math.cos(u)+s*Math.cos(u),c[1]+a*Math.sin(u)+s*Math.sin(u)],d=[c[0]+o*Math.cos(u)+s*Math.cos(u),c[1]+o*Math.sin(u)+s*Math.sin(u)];i.push(...this.helper.doubleLineOps(l[0],l[1],d[0],d[1],t))}}),i}},ge=class{static{P(this,`l`)}constructor(e){this.helper=e}fillPolygons(e,t){let n=t.hachureGap<0?4*t.strokeWidth:t.hachureGap,r=t.zigzagOffset<0?n:t.zigzagOffset,i=le(e,t=Object.assign({},t,{hachureGap:n+r}));return{type:`fillSketch`,ops:this.zigzagLines(i,r,t)}}zigzagLines(e,t,n){let r=[];return e.forEach(e=>{let i=de(e),a=Math.round(i/(2*t)),o=e[0],s=e[1];o[0]>s[0]&&(o=e[1],s=e[0]);let c=Math.atan((s[1]-o[1])/(s[0]-o[0]));for(let e=0;e<a;e++){let i=2*e*t,a=2*(e+1)*t,s=Math.sqrt(2*t**2),l=[o[0]+i*Math.cos(c),o[1]+i*Math.sin(c)],u=[o[0]+a*Math.cos(c),o[1]+a*Math.sin(c)],d=[l[0]+s*Math.cos(c+Math.PI/4),l[1]+s*Math.sin(c+Math.PI/4)];r.push(...this.helper.doubleLineOps(l[0],l[1],d[0],d[1],n),...this.helper.doubleLineOps(d[0],d[1],u[0],u[1],n))}}),r}},G={},_e=class{static{P(this,`p`)}constructor(e){this.seed=e}next(){return this.seed?(2**31-1&(this.seed=Math.imul(48271,this.seed)))/2**31:Math.random()}},ve=0,ye=1,be=2,xe={A:7,a:7,C:6,c:6,H:1,h:1,L:2,l:2,M:2,m:2,Q:4,q:4,S:4,s:4,T:2,t:2,V:1,v:1,Z:0,z:0};function Se(e,t){return e.type===t}P(Se,`k`);function Ce(e){let t=[],n=function(e){let t=[];for(;e!==``;)if(e.match(/^([ \t\r\n,]+)/))e=e.substr(RegExp.$1.length);else if(e.match(/^([aAcChHlLmMqQsStTvVzZ])/))t[t.length]={type:ve,text:RegExp.$1},e=e.substr(RegExp.$1.length);else{if(!e.match(/^(([-+]?[0-9]+(\.[0-9]*)?|[-+]?\.[0-9]+)([eE][-+]?[0-9]+)?)/))return[];t[t.length]={type:ye,text:`${parseFloat(RegExp.$1)}`},e=e.substr(RegExp.$1.length)}return t[t.length]={type:be,text:``},t}(e),r=`BOD`,i=0,a=n[i];for(;!Se(a,be);){let o=0,s=[];if(r===`BOD`){if(a.text!==`M`&&a.text!==`m`)return Ce(`M0,0`+e);i++,o=xe[a.text],r=a.text}else Se(a,ye)?o=xe[r]:(i++,o=xe[a.text],r=a.text);if(!(i+o<n.length))throw Error(`Path data ended short`);for(let e=i;e<i+o;e++){let t=n[e];if(!Se(t,ye))throw Error(`Param not a number: `+r+`,`+t.text);s[s.length]=+t.text}if(typeof xe[r]!=`number`)throw Error(`Bad segment: `+r);{let e={key:r,data:s};t.push(e),i+=o,a=n[i],r===`M`&&(r=`L`),r===`m`&&(r=`l`)}}return t}P(Ce,`b`);function we(e){let t=0,n=0,r=0,i=0,a=[];for(let{key:o,data:s}of e)switch(o){case`M`:a.push({key:`M`,data:[...s]}),[t,n]=s,[r,i]=s;break;case`m`:t+=s[0],n+=s[1],a.push({key:`M`,data:[t,n]}),r=t,i=n;break;case`L`:a.push({key:`L`,data:[...s]}),[t,n]=s;break;case`l`:t+=s[0],n+=s[1],a.push({key:`L`,data:[t,n]});break;case`C`:a.push({key:`C`,data:[...s]}),t=s[4],n=s[5];break;case`c`:{let e=s.map((e,r)=>r%2?e+n:e+t);a.push({key:`C`,data:e}),t=e[4],n=e[5];break}case`Q`:a.push({key:`Q`,data:[...s]}),t=s[2],n=s[3];break;case`q`:{let e=s.map((e,r)=>r%2?e+n:e+t);a.push({key:`Q`,data:e}),t=e[2],n=e[3];break}case`A`:a.push({key:`A`,data:[...s]}),t=s[5],n=s[6];break;case`a`:t+=s[5],n+=s[6],a.push({key:`A`,data:[s[0],s[1],s[2],s[3],s[4],t,n]});break;case`H`:a.push({key:`H`,data:[...s]}),t=s[0];break;case`h`:t+=s[0],a.push({key:`H`,data:[t]});break;case`V`:a.push({key:`V`,data:[...s]}),n=s[0];break;case`v`:n+=s[0],a.push({key:`V`,data:[n]});break;case`S`:a.push({key:`S`,data:[...s]}),t=s[2],n=s[3];break;case`s`:{let e=s.map((e,r)=>r%2?e+n:e+t);a.push({key:`S`,data:e}),t=e[2],n=e[3];break}case`T`:a.push({key:`T`,data:[...s]}),t=s[0],n=s[1];break;case`t`:t+=s[0],n+=s[1],a.push({key:`T`,data:[t,n]});break;case`Z`:case`z`:a.push({key:`Z`,data:[]}),t=r,n=i}return a}P(we,`y`);function Te(e){let t=[],n=``,r=0,i=0,a=0,o=0,s=0,c=0;for(let{key:l,data:u}of e){switch(l){case`M`:t.push({key:`M`,data:[...u]}),[r,i]=u,[a,o]=u;break;case`C`:t.push({key:`C`,data:[...u]}),r=u[4],i=u[5],s=u[2],c=u[3];break;case`L`:t.push({key:`L`,data:[...u]}),[r,i]=u;break;case`H`:r=u[0],t.push({key:`L`,data:[r,i]});break;case`V`:i=u[0],t.push({key:`L`,data:[r,i]});break;case`S`:{let e=0,a=0;n===`C`||n===`S`?(e=r+(r-s),a=i+(i-c)):(e=r,a=i),t.push({key:`C`,data:[e,a,...u]}),s=u[0],c=u[1],r=u[2],i=u[3];break}case`T`:{let[e,a]=u,o=0,l=0;n===`Q`||n===`T`?(o=r+(r-s),l=i+(i-c)):(o=r,l=i);let d=r+2*(o-r)/3,f=i+2*(l-i)/3,p=e+2*(o-e)/3,m=a+2*(l-a)/3;t.push({key:`C`,data:[d,f,p,m,e,a]}),s=o,c=l,r=e,i=a;break}case`Q`:{let[e,n,a,o]=u,l=r+2*(e-r)/3,d=i+2*(n-i)/3,f=a+2*(e-a)/3,p=o+2*(n-o)/3;t.push({key:`C`,data:[l,d,f,p,a,o]}),s=e,c=n,r=a,i=o;break}case`A`:{let e=Math.abs(u[0]),n=Math.abs(u[1]),a=u[2],o=u[3],s=u[4],c=u[5],l=u[6];e===0||n===0?(t.push({key:`C`,data:[r,i,c,l,c,l]}),r=c,i=l):(r!==c||i!==l)&&(De(r,i,c,l,e,n,a,o,s).forEach(function(e){t.push({key:`C`,data:e})}),r=c,i=l);break}case`Z`:t.push({key:`Z`,data:[]}),r=a,i=o}n=l}return t}P(Te,`m`);function Ee(e,t,n){return[e*Math.cos(n)-t*Math.sin(n),e*Math.sin(n)+t*Math.cos(n)]}P(Ee,`w`);function De(e,t,n,r,i,a,o,s,c,l){let u=(d=o,Math.PI*d/180);var d;let f=[],p=0,m=0,h=0,g=0;if(l)[p,m,h,g]=l;else{[e,t]=Ee(e,t,-u),[n,r]=Ee(n,r,-u);let o=(e-n)/2,l=(t-r)/2,d=o*o/(i*i)+l*l/(a*a);d>1&&(d=Math.sqrt(d),i*=d,a*=d);let f=i*i,_=a*a,v=f*_-f*l*l-_*o*o,y=f*l*l+_*o*o,b=(s===c?-1:1)*Math.sqrt(Math.abs(v/y));h=b*i*l/a+(e+n)/2,g=b*-a*o/i+(t+r)/2,p=Math.asin(parseFloat(((t-g)/a).toFixed(9))),m=Math.asin(parseFloat(((r-g)/a).toFixed(9))),e<h&&(p=Math.PI-p),n<h&&(m=Math.PI-m),p<0&&(p=2*Math.PI+p),m<0&&(m=2*Math.PI+m),c&&p>m&&(p-=2*Math.PI),!c&&m>p&&(m-=2*Math.PI)}let _=m-p;if(Math.abs(_)>120*Math.PI/180){let e=m,t=n,s=r;m=c&&m>p?p+120*Math.PI/180*1:p+120*Math.PI/180*-1,f=De(n=h+i*Math.cos(m),r=g+a*Math.sin(m),t,s,i,a,o,0,c,[m,e,h,g])}_=m-p;let v=Math.cos(p),y=Math.sin(p),b=Math.cos(m),x=Math.sin(m),S=Math.tan(_/4),C=4/3*i*S,w=4/3*a*S,T=[e,t],E=[e+C*y,t-w*v],D=[n+C*x,r-w*b],O=[n,r];if(E[0]=2*T[0]-E[0],E[1]=2*T[1]-E[1],l)return[E,D,O].concat(f);{f=[E,D,O].concat(f);let e=[];for(let t=0;t<f.length;t+=3){let n=Ee(f[t][0],f[t][1],u),r=Ee(f[t+1][0],f[t+1][1],u),i=Ee(f[t+2][0],f[t+2][1],u);e.push([n[0],n[1],r[0],r[1],i[0],i[1]])}return e}}P(De,`x`);var Oe={randOffset:P(function(e,t){return K(e,t)},`randOffset`),randOffsetWithRange:P(function(e,t,n){return Ve(e,t,n)},`randOffsetWithRange`),ellipse:P(function(e,t,n,r,i){return Pe(e,t,i,Ne(n,r,i)).opset},`ellipse`),doubleLineOps:P(function(e,t,n,r,i){return q(e,t,n,r,i,!0)},`doubleLineOps`)};function ke(e,t,n,r,i){return{type:`path`,ops:q(e,t,n,r,i)}}P(ke,`v`);function Ae(e,t,n){let r=(e||[]).length;if(r>2){let i=[];for(let t=0;t<r-1;t++)i.push(...q(e[t][0],e[t][1],e[t+1][0],e[t+1][1],n));return t&&i.push(...q(e[r-1][0],e[r-1][1],e[0][0],e[0][1],n)),{type:`path`,ops:i}}return r===2?ke(e[0][0],e[0][1],e[1][0],e[1][1],n):{type:`path`,ops:[]}}P(Ae,`S`);function je(e,t,n,r,i){return function(e,t){return Ae(e,!0,t)}([[e,t],[e+n,t],[e+n,t+r],[e,t+r]],i)}P(je,`O`);function Me(e,t){if(e.length){let n=typeof e[0][0]==`number`?[e]:e,r=Ue(n[0],1*(1+.2*t.roughness),t),i=t.disableMultiStroke?[]:Ue(n[0],1.5*(1+.22*t.roughness),ze(t));for(let e=1;e<n.length;e++){let a=n[e];if(a.length){let e=Ue(a,1*(1+.2*t.roughness),t),n=t.disableMultiStroke?[]:Ue(a,1.5*(1+.22*t.roughness),ze(t));for(let t of e)t.op!==`move`&&r.push(t);for(let e of n)e.op!==`move`&&i.push(e)}}return{type:`path`,ops:r.concat(i)}}return{type:`path`,ops:[]}}P(Me,`L`);function Ne(e,t,n){let r=Math.sqrt(2*Math.PI*Math.sqrt(((e/2)**2+(t/2)**2)/2)),i=Math.ceil(Math.max(n.curveStepCount,n.curveStepCount/Math.sqrt(200)*r)),a=2*Math.PI/i,o=Math.abs(e/2),s=Math.abs(t/2),c=1-n.curveFitting;return o+=K(o*c,n),s+=K(s*c,n),{increment:a,rx:o,ry:s}}P(Ne,`T`);function Pe(e,t,n,r){let[i,a]=Ge(r.increment,e,t,r.rx,r.ry,1,r.increment*Ve(.1,Ve(.4,1,n),n),n),o=We(i,null,n);if(!n.disableMultiStroke&&n.roughness!==0){let[i]=Ge(r.increment,e,t,r.rx,r.ry,1.5,0,n),a=We(i,null,n);o=o.concat(a)}return{estimatedPoints:a,opset:{type:`path`,ops:o}}}P(Pe,`D`);function Fe(e,t,n,r,i,a,o,s,c){let l=e,u=t,d=Math.abs(n/2),f=Math.abs(r/2);d+=K(.01*d,c),f+=K(.01*f,c);let p=i,m=a;for(;p<0;)p+=2*Math.PI,m+=2*Math.PI;m-p>2*Math.PI&&(p=0,m=2*Math.PI);let h=2*Math.PI/c.curveStepCount,g=Math.min(h/2,(m-p)/2),_=Ke(g,l,u,d,f,p,m,1,c);if(!c.disableMultiStroke){let e=Ke(g,l,u,d,f,p,m,1.5,c);_.push(...e)}return o&&(s?_.push(...q(l,u,l+d*Math.cos(p),u+f*Math.sin(p),c),...q(l,u,l+d*Math.cos(m),u+f*Math.sin(m),c)):_.push({op:`lineTo`,data:[l,u]},{op:`lineTo`,data:[l+d*Math.cos(p),u+f*Math.sin(p)]})),{type:`path`,ops:_}}P(Fe,`A`);function Ie(e,t){let n=Te(we(Ce(e))),r=[],i=[0,0],a=[0,0];for(let{key:e,data:o}of n)switch(e){case`M`:a=[o[0],o[1]],i=[o[0],o[1]];break;case`L`:r.push(...q(a[0],a[1],o[0],o[1],t)),a=[o[0],o[1]];break;case`C`:{let[e,n,i,s,c,l]=o;r.push(...qe(e,n,i,s,c,l,a,t)),a=[c,l];break}case`Z`:r.push(...q(a[0],a[1],i[0],i[1],t)),a=[i[0],i[1]]}return{type:`path`,ops:r}}P(Ie,`_`);function Le(e,t){let n=[];for(let r of e)if(r.length){let e=t.maxRandomnessOffset||0,i=r.length;if(i>2){n.push({op:`move`,data:[r[0][0]+K(e,t),r[0][1]+K(e,t)]});for(let a=1;a<i;a++)n.push({op:`lineTo`,data:[r[a][0]+K(e,t),r[a][1]+K(e,t)]})}}return{type:`fillPath`,ops:n}}P(Le,`I`);function Re(e,t){return(function(e,t){let n=e.fillStyle||`hachure`;if(!G[n])switch(n){case`zigzag`:G[n]||(G[n]=new fe(t));break;case`cross-hatch`:G[n]||(G[n]=new pe(t));break;case`dots`:G[n]||(G[n]=new me(t));break;case`dashed`:G[n]||(G[n]=new he(t));break;case`zigzag-line`:G[n]||(G[n]=new ge(t));break;default:n=`hachure`,G[n]||(G[n]=new ue(t))}return G[n]})(t,Oe).fillPolygons(e,t)}P(Re,`C`);function ze(e){let t=Object.assign({},e);return t.randomizer=void 0,e.seed&&(t.seed=e.seed+1),t}P(ze,`z`);function Be(e){return e.randomizer||=new _e(e.seed||0),e.randomizer.next()}P(Be,`W`);function Ve(e,t,n,r=1){return n.roughness*r*(Be(n)*(t-e)+e)}P(Ve,`E`);function K(e,t,n=1){return Ve(-e,e,t,n)}P(K,`G`);function q(e,t,n,r,i,a=!1){let o=a?i.disableMultiStrokeFill:i.disableMultiStroke,s=He(e,t,n,r,i,!0,!1);if(o)return s;let c=He(e,t,n,r,i,!0,!0);return s.concat(c)}P(q,`$`);function He(e,t,n,r,i,a,o){let s=(e-n)**2+(t-r)**2,c=Math.sqrt(s),l=1;l=c<200?1:c>500?.4:-.0016668*c+1.233334;let u=i.maxRandomnessOffset||0;u*u*100>s&&(u=c/10);let d=u/2,f=.2+.2*Be(i),p=i.bowing*i.maxRandomnessOffset*(r-t)/200,m=i.bowing*i.maxRandomnessOffset*(e-n)/200;p=K(p,i,l),m=K(m,i,l);let h=[],g=P(()=>K(d,i,l),`M`),_=P(()=>K(u,i,l),`k`),v=i.preserveVertices;return a&&(o?h.push({op:`move`,data:[e+(v?0:g()),t+(v?0:g())]}):h.push({op:`move`,data:[e+(v?0:K(u,i,l)),t+(v?0:K(u,i,l))]})),o?h.push({op:`bcurveTo`,data:[p+e+(n-e)*f+g(),m+t+(r-t)*f+g(),p+e+2*(n-e)*f+g(),m+t+2*(r-t)*f+g(),n+(v?0:g()),r+(v?0:g())]}):h.push({op:`bcurveTo`,data:[p+e+(n-e)*f+_(),m+t+(r-t)*f+_(),p+e+2*(n-e)*f+_(),m+t+2*(r-t)*f+_(),n+(v?0:_()),r+(v?0:_())]}),h}P(He,`R`);function Ue(e,t,n){if(!e.length)return[];let r=[];r.push([e[0][0]+K(t,n),e[0][1]+K(t,n)]),r.push([e[0][0]+K(t,n),e[0][1]+K(t,n)]);for(let i=1;i<e.length;i++)r.push([e[i][0]+K(t,n),e[i][1]+K(t,n)]),i===e.length-1&&r.push([e[i][0]+K(t,n),e[i][1]+K(t,n)]);return We(r,null,n)}P(Ue,`j`);function We(e,t,n){let r=e.length,i=[];if(r>3){let a=[],o=1-n.curveTightness;i.push({op:`move`,data:[e[1][0],e[1][1]]});for(let t=1;t+2<r;t++){let n=e[t];a[0]=[n[0],n[1]],a[1]=[n[0]+(o*e[t+1][0]-o*e[t-1][0])/6,n[1]+(o*e[t+1][1]-o*e[t-1][1])/6],a[2]=[e[t+1][0]+(o*e[t][0]-o*e[t+2][0])/6,e[t+1][1]+(o*e[t][1]-o*e[t+2][1])/6],a[3]=[e[t+1][0],e[t+1][1]],i.push({op:`bcurveTo`,data:[a[1][0],a[1][1],a[2][0],a[2][1],a[3][0],a[3][1]]})}if(t&&t.length===2){let e=n.maxRandomnessOffset;i.push({op:`lineTo`,data:[t[0]+K(e,n),t[1]+K(e,n)]})}}else r===3?(i.push({op:`move`,data:[e[1][0],e[1][1]]}),i.push({op:`bcurveTo`,data:[e[1][0],e[1][1],e[2][0],e[2][1],e[2][0],e[2][1]]})):r===2&&i.push(...He(e[0][0],e[0][1],e[1][0],e[1][1],n,!0,!0));return i}P(We,`q`);function Ge(e,t,n,r,i,a,o,s){let c=[],l=[];if(s.roughness===0){e/=4,l.push([t+r*Math.cos(-e),n+i*Math.sin(-e)]);for(let a=0;a<=2*Math.PI;a+=e){let e=[t+r*Math.cos(a),n+i*Math.sin(a)];c.push(e),l.push(e)}l.push([t+r*Math.cos(0),n+i*Math.sin(0)]),l.push([t+r*Math.cos(e),n+i*Math.sin(e)])}else{let u=K(.5,s)-Math.PI/2;l.push([K(a,s)+t+.9*r*Math.cos(u-e),K(a,s)+n+.9*i*Math.sin(u-e)]);let d=2*Math.PI+u-.01;for(let o=u;o<d;o+=e){let e=[K(a,s)+t+r*Math.cos(o),K(a,s)+n+i*Math.sin(o)];c.push(e),l.push(e)}l.push([K(a,s)+t+r*Math.cos(u+2*Math.PI+.5*o),K(a,s)+n+i*Math.sin(u+2*Math.PI+.5*o)]),l.push([K(a,s)+t+.98*r*Math.cos(u+o),K(a,s)+n+.98*i*Math.sin(u+o)]),l.push([K(a,s)+t+.9*r*Math.cos(u+.5*o),K(a,s)+n+.9*i*Math.sin(u+.5*o)])}return[l,c]}P(Ge,`F`);function Ke(e,t,n,r,i,a,o,s,c){let l=a+K(.1,c),u=[];u.push([K(s,c)+t+.9*r*Math.cos(l-e),K(s,c)+n+.9*i*Math.sin(l-e)]);for(let a=l;a<=o;a+=e)u.push([K(s,c)+t+r*Math.cos(a),K(s,c)+n+i*Math.sin(a)]);return u.push([t+r*Math.cos(o),n+i*Math.sin(o)]),u.push([t+r*Math.cos(o),n+i*Math.sin(o)]),We(u,null,c)}P(Ke,`V`);function qe(e,t,n,r,i,a,o,s){let c=[],l=[s.maxRandomnessOffset||1,(s.maxRandomnessOffset||1)+.3],u=[0,0],d=s.disableMultiStroke?1:2,f=s.preserveVertices;for(let p=0;p<d;p++)p===0?c.push({op:`move`,data:[o[0],o[1]]}):c.push({op:`move`,data:[o[0]+(f?0:K(l[0],s)),o[1]+(f?0:K(l[0],s))]}),u=f?[i,a]:[i+K(l[p],s),a+K(l[p],s)],c.push({op:`bcurveTo`,data:[e+K(l[p],s),t+K(l[p],s),n+K(l[p],s),r+K(l[p],s),u[0],u[1]]});return c}P(qe,`Z`);function Je(e){return[...e]}P(Je,`Q`);function Ye(e,t=0){let n=e.length;if(n<3)throw Error(`A curve must have at least three points.`);let r=[];if(n===3)r.push(Je(e[0]),Je(e[1]),Je(e[2]),Je(e[2]));else{let n=[];n.push(e[0],e[0]);for(let t=1;t<e.length;t++)n.push(e[t]),t===e.length-1&&n.push(e[t]);let i=[],a=1-t;r.push(Je(n[0]));for(let e=1;e+2<n.length;e++){let t=n[e];i[0]=[t[0],t[1]],i[1]=[t[0]+(a*n[e+1][0]-a*n[e-1][0])/6,t[1]+(a*n[e+1][1]-a*n[e-1][1])/6],i[2]=[n[e+1][0]+(a*n[e][0]-a*n[e+2][0])/6,n[e+1][1]+(a*n[e][1]-a*n[e+2][1])/6],i[3]=[n[e+1][0],n[e+1][1]],r.push(i[1],i[2],i[3])}}return r}P(Ye,`H`);function Xe(e,t){return(e[0]-t[0])**2+(e[1]-t[1])**2}P(Xe,`N`);function Ze(e,t,n){let r=Xe(t,n);if(r===0)return Xe(e,t);let i=((e[0]-t[0])*(n[0]-t[0])+(e[1]-t[1])*(n[1]-t[1]))/r;return i=Math.max(0,Math.min(1,i)),Xe(e,Qe(t,n,i))}P(Ze,`B`);function Qe(e,t,n){return[e[0]+(t[0]-e[0])*n,e[1]+(t[1]-e[1])*n]}P(Qe,`J`);function $e(e,t,n,r){let i=r||[];if(function(e,t){let n=e[t+0],r=e[t+1],i=e[t+2],a=e[t+3],o=3*r[0]-2*n[0]-a[0];o*=o;let s=3*r[1]-2*n[1]-a[1];s*=s;let c=3*i[0]-2*a[0]-n[0];c*=c;let l=3*i[1]-2*a[1]-n[1];return l*=l,o<c&&(o=c),s<l&&(s=l),o+s}(e,t)<n){let n=e[t+0];i.length?(a=i[i.length-1],o=n,Math.sqrt(Xe(a,o))>1&&i.push(n)):i.push(n),i.push(e[t+3])}else{let r=e[t+0],a=e[t+1],o=e[t+2],s=e[t+3],c=Qe(r,a,.5),l=Qe(a,o,.5),u=Qe(o,s,.5),d=Qe(c,l,.5),f=Qe(l,u,.5),p=Qe(d,f,.5);$e([r,c,d,p],0,n,i),$e([p,f,u,s],0,n,i)}var a,o;return i}P($e,`K`);function et(e,t){return tt(e,0,e.length,t)}P(et,`U`);function tt(e,t,n,r,i){let a=i||[],o=e[t],s=e[n-1],c=0,l=1;for(let r=t+1;r<n-1;++r){let t=Ze(e[r],o,s);t>c&&(c=t,l=r)}return Math.sqrt(c)>r?(tt(e,t,l+1,r,a),tt(e,l,n,r,a)):(a.length||a.push(o),a.push(s)),a}P(tt,`X`);function nt(e,t=.15,n){let r=[],i=(e.length-1)/3;for(let n=0;n<i;n++)$e(e,3*n,t,r);return n&&n>0?tt(r,0,r.length,n):r}P(nt,`Y`);var J=`none`,rt=class{static{P(this,`et`)}constructor(e){this.defaultOptions={maxRandomnessOffset:2,roughness:1,bowing:1,stroke:`#000`,strokeWidth:1,curveTightness:0,curveFitting:.95,curveStepCount:9,fillStyle:`hachure`,fillWeight:-1,hachureAngle:-41,hachureGap:-1,dashOffset:-1,dashGap:-1,zigzagOffset:-1,seed:0,disableMultiStroke:!1,disableMultiStrokeFill:!1,preserveVertices:!1,fillShapeRoughnessGain:.8},this.config=e||{},this.config.options&&(this.defaultOptions=this._o(this.config.options))}static newSeed(){return Math.floor(Math.random()*2**31)}_o(e){return e?Object.assign({},this.defaultOptions,e):this.defaultOptions}_d(e,t,n){return{shape:e,sets:t||[],options:n||this.defaultOptions}}line(e,t,n,r,i){let a=this._o(i);return this._d(`line`,[ke(e,t,n,r,a)],a)}rectangle(e,t,n,r,i){let a=this._o(i),o=[],s=je(e,t,n,r,a);if(a.fill){let i=[[e,t],[e+n,t],[e+n,t+r],[e,t+r]];a.fillStyle===`solid`?o.push(Le([i],a)):o.push(Re([i],a))}return a.stroke!==J&&o.push(s),this._d(`rectangle`,o,a)}ellipse(e,t,n,r,i){let a=this._o(i),o=[],s=Ne(n,r,a),c=Pe(e,t,a,s);if(a.fill)if(a.fillStyle===`solid`){let n=Pe(e,t,a,s).opset;n.type=`fillPath`,o.push(n)}else o.push(Re([c.estimatedPoints],a));return a.stroke!==J&&o.push(c.opset),this._d(`ellipse`,o,a)}circle(e,t,n,r){let i=this.ellipse(e,t,n,n,r);return i.shape=`circle`,i}linearPath(e,t){let n=this._o(t);return this._d(`linearPath`,[Ae(e,!1,n)],n)}arc(e,t,n,r,i,a,o=!1,s){let c=this._o(s),l=[],u=Fe(e,t,n,r,i,a,o,!0,c);if(o&&c.fill)if(c.fillStyle===`solid`){let o=Object.assign({},c);o.disableMultiStroke=!0;let s=Fe(e,t,n,r,i,a,!0,!1,o);s.type=`fillPath`,l.push(s)}else l.push(function(e,t,n,r,i,a,o){let s=e,c=t,l=Math.abs(n/2),u=Math.abs(r/2);l+=K(.01*l,o),u+=K(.01*u,o);let d=i,f=a;for(;d<0;)d+=2*Math.PI,f+=2*Math.PI;f-d>2*Math.PI&&(d=0,f=2*Math.PI);let p=(f-d)/o.curveStepCount,m=[];for(let e=d;e<=f;e+=p)m.push([s+l*Math.cos(e),c+u*Math.sin(e)]);return m.push([s+l*Math.cos(f),c+u*Math.sin(f)]),m.push([s,c]),Re([m],o)}(e,t,n,r,i,a,c));return c.stroke!==J&&l.push(u),this._d(`arc`,l,c)}curve(e,t){let n=this._o(t),r=[],i=Me(e,n);if(n.fill&&n.fill!==J)if(n.fillStyle===`solid`){let t=Me(e,Object.assign(Object.assign({},n),{disableMultiStroke:!0,roughness:n.roughness?n.roughness+n.fillShapeRoughnessGain:0}));r.push({type:`fillPath`,ops:this._mergedShape(t.ops)})}else{let t=[],i=e;if(i.length){let e=typeof i[0][0]==`number`?[i]:i;for(let r of e)r.length<3?t.push(...r):r.length===3?t.push(...nt(Ye([r[0],r[0],r[1],r[2]]),10,(1+n.roughness)/2)):t.push(...nt(Ye(r),10,(1+n.roughness)/2))}t.length&&r.push(Re([t],n))}return n.stroke!==J&&r.push(i),this._d(`curve`,r,n)}polygon(e,t){let n=this._o(t),r=[],i=Ae(e,!0,n);return n.fill&&(n.fillStyle===`solid`?r.push(Le([e],n)):r.push(Re([e],n))),n.stroke!==J&&r.push(i),this._d(`polygon`,r,n)}path(e,t){let n=this._o(t),r=[];if(!e)return this._d(`path`,r,n);e=(e||``).replace(/\n/g,` `).replace(/(-\s)/g,`-`).replace(`/(ss)/g`,` `);let i=n.fill&&n.fill!==`transparent`&&n.fill!==J,a=n.stroke!==J,o=!!(n.simplification&&n.simplification<1),s=function(e,t,n){let r=Te(we(Ce(e))),i=[],a=[],o=[0,0],s=[],c=P(()=>{s.length>=4&&a.push(...nt(s,t)),s=[]},`i`),l=P(()=>{c(),a.length&&(i.push(a),a=[])},`c`);for(let{key:e,data:t}of r)switch(e){case`M`:l(),o=[t[0],t[1]],a.push(o);break;case`L`:c(),a.push([t[0],t[1]]);break;case`C`:if(!s.length){let e=a.length?a[a.length-1]:o;s.push([e[0],e[1]])}s.push([t[0],t[1]]),s.push([t[2],t[3]]),s.push([t[4],t[5]]);break;case`Z`:c(),a.push([o[0],o[1]])}if(l(),!n)return i;let u=[];for(let e of i){let t=et(e,n);t.length&&u.push(t)}return u}(e,1,o?4-4*(n.simplification||1):(1+n.roughness)/2),c=Ie(e,n);if(i)if(n.fillStyle===`solid`)if(s.length===1){let t=Ie(e,Object.assign(Object.assign({},n),{disableMultiStroke:!0,roughness:n.roughness?n.roughness+n.fillShapeRoughnessGain:0}));r.push({type:`fillPath`,ops:this._mergedShape(t.ops)})}else r.push(Le(s,n));else r.push(Re(s,n));return a&&(o?s.forEach(e=>{r.push(Ae(e,!1,n))}):r.push(c)),this._d(`path`,r,n)}opsToPath(e,t){let n=``;for(let r of e.ops){let e=typeof t==`number`&&t>=0?r.data.map(e=>+e.toFixed(t)):r.data;switch(r.op){case`move`:n+=`M${e[0]} ${e[1]} `;break;case`bcurveTo`:n+=`C${e[0]} ${e[1]}, ${e[2]} ${e[3]}, ${e[4]} ${e[5]} `;break;case`lineTo`:n+=`L${e[0]} ${e[1]} `}}return n.trim()}toPaths(e){let t=e.sets||[],n=e.options||this.defaultOptions,r=[];for(let e of t){let t=null;switch(e.type){case`path`:t={d:this.opsToPath(e),stroke:n.stroke,strokeWidth:n.strokeWidth,fill:J};break;case`fillPath`:t={d:this.opsToPath(e),stroke:J,strokeWidth:0,fill:n.fill||J};break;case`fillSketch`:t=this.fillSketch(e,n)}t&&r.push(t)}return r}fillSketch(e,t){let n=t.fillWeight;return n<0&&(n=t.strokeWidth/2),{d:this.opsToPath(e),stroke:t.fill||J,strokeWidth:n,fill:J}}_mergedShape(e){return e.filter((e,t)=>t===0||e.op!==`move`)}},it=class{static{P(this,`st`)}constructor(e,t){this.canvas=e,this.ctx=this.canvas.getContext(`2d`),this.gen=new rt(t)}draw(e){let t=e.sets||[],n=e.options||this.getDefaultOptions(),r=this.ctx,i=e.options.fixedDecimalPlaceDigits;for(let a of t)switch(a.type){case`path`:r.save(),r.strokeStyle=n.stroke===`none`?`transparent`:n.stroke,r.lineWidth=n.strokeWidth,n.strokeLineDash&&r.setLineDash(n.strokeLineDash),n.strokeLineDashOffset&&(r.lineDashOffset=n.strokeLineDashOffset),this._drawToContext(r,a,i),r.restore();break;case`fillPath`:{r.save(),r.fillStyle=n.fill||``;let t=e.shape===`curve`||e.shape===`polygon`||e.shape===`path`?`evenodd`:`nonzero`;this._drawToContext(r,a,i,t),r.restore();break}case`fillSketch`:this.fillSketch(r,a,n)}}fillSketch(e,t,n){let r=n.fillWeight;r<0&&(r=n.strokeWidth/2),e.save(),n.fillLineDash&&e.setLineDash(n.fillLineDash),n.fillLineDashOffset&&(e.lineDashOffset=n.fillLineDashOffset),e.strokeStyle=n.fill||``,e.lineWidth=r,this._drawToContext(e,t,n.fixedDecimalPlaceDigits),e.restore()}_drawToContext(e,t,n,r=`nonzero`){e.beginPath();for(let r of t.ops){let t=typeof n==`number`&&n>=0?r.data.map(e=>+e.toFixed(n)):r.data;switch(r.op){case`move`:e.moveTo(t[0],t[1]);break;case`bcurveTo`:e.bezierCurveTo(t[0],t[1],t[2],t[3],t[4],t[5]);break;case`lineTo`:e.lineTo(t[0],t[1])}}t.type===`fillPath`?e.fill(r):e.stroke()}get generator(){return this.gen}getDefaultOptions(){return this.gen.defaultOptions}line(e,t,n,r,i){let a=this.gen.line(e,t,n,r,i);return this.draw(a),a}rectangle(e,t,n,r,i){let a=this.gen.rectangle(e,t,n,r,i);return this.draw(a),a}ellipse(e,t,n,r,i){let a=this.gen.ellipse(e,t,n,r,i);return this.draw(a),a}circle(e,t,n,r){let i=this.gen.circle(e,t,n,r);return this.draw(i),i}linearPath(e,t){let n=this.gen.linearPath(e,t);return this.draw(n),n}polygon(e,t){let n=this.gen.polygon(e,t);return this.draw(n),n}arc(e,t,n,r,i,a,o=!1,s){let c=this.gen.arc(e,t,n,r,i,a,o,s);return this.draw(c),c}curve(e,t){let n=this.gen.curve(e,t);return this.draw(n),n}path(e,t){let n=this.gen.path(e,t);return this.draw(n),n}},at=`http://www.w3.org/2000/svg`,ot=class{static{P(this,`ot`)}constructor(e,t){this.svg=e,this.gen=new rt(t)}draw(e){let t=e.sets||[],n=e.options||this.getDefaultOptions(),r=this.svg.ownerDocument||window.document,i=r.createElementNS(at,`g`),a=e.options.fixedDecimalPlaceDigits;for(let o of t){let t=null;switch(o.type){case`path`:t=r.createElementNS(at,`path`),t.setAttribute(`d`,this.opsToPath(o,a)),t.setAttribute(`stroke`,n.stroke),t.setAttribute(`stroke-width`,n.strokeWidth+``),t.setAttribute(`fill`,`none`),n.strokeLineDash&&t.setAttribute(`stroke-dasharray`,n.strokeLineDash.join(` `).trim()),n.strokeLineDashOffset&&t.setAttribute(`stroke-dashoffset`,`${n.strokeLineDashOffset}`);break;case`fillPath`:t=r.createElementNS(at,`path`),t.setAttribute(`d`,this.opsToPath(o,a)),t.setAttribute(`stroke`,`none`),t.setAttribute(`stroke-width`,`0`),t.setAttribute(`fill`,n.fill||``),e.shape!==`curve`&&e.shape!==`polygon`||t.setAttribute(`fill-rule`,`evenodd`);break;case`fillSketch`:t=this.fillSketch(r,o,n)}t&&i.appendChild(t)}return i}fillSketch(e,t,n){let r=n.fillWeight;r<0&&(r=n.strokeWidth/2);let i=e.createElementNS(at,`path`);return i.setAttribute(`d`,this.opsToPath(t,n.fixedDecimalPlaceDigits)),i.setAttribute(`stroke`,n.fill||``),i.setAttribute(`stroke-width`,r+``),i.setAttribute(`fill`,`none`),n.fillLineDash&&i.setAttribute(`stroke-dasharray`,n.fillLineDash.join(` `).trim()),n.fillLineDashOffset&&i.setAttribute(`stroke-dashoffset`,`${n.fillLineDashOffset}`),i}get generator(){return this.gen}getDefaultOptions(){return this.gen.defaultOptions}opsToPath(e,t){return this.gen.opsToPath(e,t)}line(e,t,n,r,i){let a=this.gen.line(e,t,n,r,i);return this.draw(a)}rectangle(e,t,n,r,i){let a=this.gen.rectangle(e,t,n,r,i);return this.draw(a)}ellipse(e,t,n,r,i){let a=this.gen.ellipse(e,t,n,r,i);return this.draw(a)}circle(e,t,n,r){let i=this.gen.circle(e,t,n,r);return this.draw(i)}linearPath(e,t){let n=this.gen.linearPath(e,t);return this.draw(n)}polygon(e,t){let n=this.gen.polygon(e,t);return this.draw(n)}arc(e,t,n,r,i,a,o=!1,s){let c=this.gen.arc(e,t,n,r,i,a,o,s);return this.draw(c)}curve(e,t){let n=this.gen.curve(e,t);return this.draw(n)}path(e,t){let n=this.gen.path(e,t);return this.draw(n)}},Y={canvas:P((e,t)=>new it(e,t),`canvas`),svg:P((e,t)=>new ot(e,t),`svg`),generator:P(e=>new rt(e),`generator`),newSeed:P(()=>rt.newSeed(),`newSeed`)},st=P((e,t)=>{var n=e.x,r=e.y,i=t.x-n,a=t.y-r,o=e.width/2,s=e.height/2,c,l;return Math.abs(a)*o>Math.abs(i)*s?(a<0&&(s=-s),c=a===0?0:s*i/a,l=s):(i<0&&(o=-o),c=o,l=i===0?0:o*a/i),{x:n+c,y:r+l}},`intersectRect`);function ct(e,t){t&&e.attr(`style`,t)}P(ct,`applyStyle`);async function lt(e){let t=C(document.createElementNS(`http://www.w3.org/2000/svg`,`foreignObject`)),n=t.append(`xhtml:div`),r=_(),i=e.label;e.label&&A(e.label)&&(i=await l(e.label.replace(g.lineBreakRegex,`
`),r));let a=`<span class="`+(e.isNode?`nodeLabel`:`edgeLabel`)+`" `+(e.labelStyle?`style="`+e.labelStyle+`"`:``)+`>`+i+`</span>`;return n.html(h(a,r)),ct(n,e.labelStyle),n.style(`display`,`inline-block`),n.style(`padding-right`,`1px`),n.style(`white-space`,`nowrap`),n.attr(`xmlns`,`http://www.w3.org/1999/xhtml`),t.node()}P(lt,`addHtmlLabel`);var ut=P(async(e,t,r,i)=>{let a=e||``;if(typeof a==`object`&&(a=a[0]),n(_().flowchart.htmlLabels))return a=a.replace(/\\n|\n/g,`<br />`),y.info(`vertexText`+a),await lt({isNode:i,label:M(a).replace(/fa[blrs]?:fa-[\w-]+/g,e=>`<i class='${e.replace(`:`,` `)}'></i>`),labelStyle:t&&t.replace(`fill:`,`color:`)});{let e=document.createElementNS(`http://www.w3.org/2000/svg`,`text`);e.setAttribute(`style`,t.replace(`color:`,`fill:`));let n=[];n=typeof a==`string`?a.split(/\\n|\n|<br\s*\/?>/gi):Array.isArray(a)?a:[];for(let t of n){let n=document.createElementNS(`http://www.w3.org/2000/svg`,`tspan`);n.setAttributeNS(`http://www.w3.org/XML/1998/namespace`,`xml:space`,`preserve`),n.setAttribute(`dy`,`1em`),n.setAttribute(`x`,`0`),r?n.setAttribute(`class`,`title-row`):n.setAttribute(`class`,`row`),n.textContent=t.trim(),e.appendChild(n)}return e}},`createLabel`),dt=P((e,t,n,r,i)=>[`M`,e+i,t,`H`,e+n-i,`A`,i,i,0,0,1,e+n,t+i,`V`,t+r-i,`A`,i,i,0,0,1,e+n-i,t+r,`H`,e+i,`A`,i,i,0,0,1,e,t+r-i,`V`,t+i,`A`,i,i,0,0,1,e+i,t,`Z`].join(` `),`createRoundedRectPathD`),ft=P(async(e,t)=>{y.info(`Creating subgraph rect for `,t.id,t);let r=_(),{themeVariables:i,handDrawnSeed:a}=r,{clusterBkg:o,clusterBorder:s}=i,{labelStyles:c,nodeStyles:l,borderStyles:u,backgroundStyles:d}=R(t),f=e.insert(`g`).attr(`class`,`cluster `+t.cssClasses).attr(`id`,t.id).attr(`data-look`,t.look),p=n(r.flowchart.htmlLabels),m=f.insert(`g`).attr(`class`,`cluster-label `),h=await E(m,t.label,{style:t.labelStyle,useHtmlLabels:p,isNode:!0}),g=h.getBBox();if(n(r.flowchart.htmlLabels)){let e=h.children[0],t=C(h);g=e.getBoundingClientRect(),t.attr(`width`,g.width),t.attr(`height`,g.height)}let v=t.width<=g.width+t.padding?g.width+t.padding:t.width;t.width<=g.width+t.padding?t.diff=(v-t.width)/2-t.padding:t.diff=-t.padding;let b=t.height,x=t.x-v/2,S=t.y-b/2;y.trace(`Data `,t,JSON.stringify(t));let w;if(t.look===`handDrawn`){let e=Y.svg(f),n=z(t,{roughness:.7,fill:o,stroke:s,fillWeight:3,seed:a}),r=e.path(dt(x,S,v,b,0),n);w=f.insert(()=>(y.debug(`Rough node insert CXC`,r),r),`:first-child`),w.select(`path:nth-child(2)`).attr(`style`,u.join(`;`)),w.select(`path`).attr(`style`,d.join(`;`).replace(`fill`,`stroke`))}else w=f.insert(`rect`,`:first-child`),w.attr(`style`,l).attr(`rx`,t.rx).attr(`ry`,t.ry).attr(`x`,x).attr(`y`,S).attr(`width`,v).attr(`height`,b);let{subGraphTitleTopMargin:T}=ne(r);if(m.attr(`transform`,`translate(${t.x-g.width/2}, ${t.y-t.height/2+T})`),c){let e=m.select(`span`);e&&e.attr(`style`,c)}let D=w.node().getBBox();return t.offsetX=0,t.width=D.width,t.height=D.height,t.offsetY=g.height-t.padding/2,t.intersect=function(e){return st(t,e)},{cluster:f,labelBBox:g}},`rect`),pt={rect:ft,squareRect:ft,roundedWithTitle:P(async(e,t)=>{let r=_(),{themeVariables:i,handDrawnSeed:a}=r,{altBackground:o,compositeBackground:s,compositeTitleBackground:c,nodeBorder:l}=i,u=e.insert(`g`).attr(`class`,t.cssClasses).attr(`id`,t.id).attr(`data-id`,t.id).attr(`data-look`,t.look),d=u.insert(`g`,`:first-child`),f=u.insert(`g`).attr(`class`,`cluster-label`),p=u.append(`rect`),m=f.node().appendChild(await ut(t.label,t.labelStyle,void 0,!0)),h=m.getBBox();if(n(r.flowchart.htmlLabels)){let e=m.children[0],t=C(m);h=e.getBoundingClientRect(),t.attr(`width`,h.width),t.attr(`height`,h.height)}let g=0*t.padding,v=g/2,y=(t.width<=h.width+t.padding?h.width+t.padding:t.width)+g;t.width<=h.width+t.padding?t.diff=(y-t.width)/2-t.padding:t.diff=-t.padding;let b=t.height+g,x=t.height+g-h.height-6,S=t.x-y/2,w=t.y-b/2;t.width=y;let T=t.y-t.height/2-v+h.height+2,E;if(t.look===`handDrawn`){let e=t.cssClasses.includes(`statediagram-cluster-alt`),n=Y.svg(u),r=t.rx||t.ry?n.path(dt(S,w,y,b,10),{roughness:.7,fill:c,fillStyle:`solid`,stroke:l,seed:a}):n.rectangle(S,w,y,b,{seed:a});E=u.insert(()=>r,`:first-child`);let i=n.rectangle(S,T,y,x,{fill:e?o:s,fillStyle:e?`hachure`:`solid`,stroke:l,seed:a});E=u.insert(()=>r,`:first-child`),p=u.insert(()=>i)}else E=d.insert(`rect`,`:first-child`),E.attr(`class`,`outer`).attr(`x`,S).attr(`y`,w).attr(`width`,y).attr(`height`,b).attr(`data-look`,t.look),p.attr(`class`,`inner`).attr(`x`,S).attr(`y`,T).attr(`width`,y).attr(`height`,x);return f.attr(`transform`,`translate(${t.x-h.width/2}, ${w+1-(n(r.flowchart.htmlLabels)?0:3)})`),t.height=E.node().getBBox().height,t.offsetX=0,t.offsetY=h.height-t.padding/2,t.labelBBox=h,t.intersect=function(e){return st(t,e)},{cluster:u,labelBBox:h}},`roundedWithTitle`),noteGroup:P((e,t)=>{let n=e.insert(`g`).attr(`class`,`note-cluster`).attr(`id`,t.id),r=n.insert(`rect`,`:first-child`),i=0*t.padding,a=i/2;r.attr(`rx`,t.rx).attr(`ry`,t.ry).attr(`x`,t.x-t.width/2-a).attr(`y`,t.y-t.height/2-a).attr(`width`,t.width+i).attr(`height`,t.height+i).attr(`fill`,`none`);let o=r.node().getBBox();return t.width=o.width,t.height=o.height,t.intersect=function(e){return st(t,e)},{cluster:n,labelBBox:{width:0,height:0}}},`noteGroup`),divider:P((e,t)=>{let{themeVariables:n,handDrawnSeed:r}=_(),{nodeBorder:i}=n,a=e.insert(`g`).attr(`class`,t.cssClasses).attr(`id`,t.id).attr(`data-look`,t.look),o=a.insert(`g`,`:first-child`),s=0*t.padding,c=t.width+s;t.diff=-t.padding;let l=t.height+s,u=t.x-c/2,d=t.y-l/2;t.width=c;let f;if(t.look===`handDrawn`){let e=Y.svg(a).rectangle(u,d,c,l,{fill:`lightgrey`,roughness:.5,strokeLineDash:[5],stroke:i,seed:r});f=a.insert(()=>e,`:first-child`)}else f=o.insert(`rect`,`:first-child`),f.attr(`class`,`divider`).attr(`x`,u).attr(`y`,d).attr(`width`,c).attr(`height`,l).attr(`data-look`,t.look);return t.height=f.node().getBBox().height,t.offsetX=0,t.offsetY=0,t.intersect=function(e){return st(t,e)},{cluster:a,labelBBox:{}}},`divider`),kanbanSection:P(async(e,t)=>{y.info(`Creating subgraph rect for `,t.id,t);let r=_(),{themeVariables:i,handDrawnSeed:a}=r,{clusterBkg:o,clusterBorder:s}=i,{labelStyles:c,nodeStyles:l,borderStyles:u,backgroundStyles:d}=R(t),f=e.insert(`g`).attr(`class`,`cluster `+t.cssClasses).attr(`id`,t.id).attr(`data-look`,t.look),p=n(r.flowchart.htmlLabels),m=f.insert(`g`).attr(`class`,`cluster-label `),h=await E(m,t.label,{style:t.labelStyle,useHtmlLabels:p,isNode:!0,width:t.width}),g=h.getBBox();if(n(r.flowchart.htmlLabels)){let e=h.children[0],t=C(h);g=e.getBoundingClientRect(),t.attr(`width`,g.width),t.attr(`height`,g.height)}let v=t.width<=g.width+t.padding?g.width+t.padding:t.width;t.width<=g.width+t.padding?t.diff=(v-t.width)/2-t.padding:t.diff=-t.padding;let b=t.height,x=t.x-v/2,S=t.y-b/2;y.trace(`Data `,t,JSON.stringify(t));let w;if(t.look===`handDrawn`){let e=Y.svg(f),n=z(t,{roughness:.7,fill:o,stroke:s,fillWeight:4,seed:a}),r=e.path(dt(x,S,v,b,t.rx),n);w=f.insert(()=>(y.debug(`Rough node insert CXC`,r),r),`:first-child`),w.select(`path:nth-child(2)`).attr(`style`,u.join(`;`)),w.select(`path`).attr(`style`,d.join(`;`).replace(`fill`,`stroke`))}else w=f.insert(`rect`,`:first-child`),w.attr(`style`,l).attr(`rx`,t.rx).attr(`ry`,t.ry).attr(`x`,x).attr(`y`,S).attr(`width`,v).attr(`height`,b);let{subGraphTitleTopMargin:T}=ne(r);if(m.attr(`transform`,`translate(${t.x-g.width/2}, ${t.y-t.height/2+T})`),c){let e=m.select(`span`);e&&e.attr(`style`,c)}let D=w.node().getBBox();return t.offsetX=0,t.width=D.width,t.height=D.height,t.offsetY=g.height-t.padding/2,t.intersect=function(e){return st(t,e)},{cluster:f,labelBBox:g}},`kanbanSection`)},mt=new Map,ht=P(async(e,t)=>{let n=await pt[t.shape||`rect`](e,t);return mt.set(t.id,n),n},`insertCluster`),gt=P(()=>{mt=new Map},`clear`);function _t(e,t){return e.intersect(t)}P(_t,`intersectNode`);var vt=_t;function yt(e,t,n,r){var i=e.x,a=e.y,o=i-r.x,s=a-r.y,c=Math.sqrt(t*t*s*s+n*n*o*o),l=Math.abs(t*n*o/c);r.x<i&&(l=-l);var u=Math.abs(t*n*s/c);return r.y<a&&(u=-u),{x:i+l,y:a+u}}P(yt,`intersectEllipse`);var bt=yt;function xt(e,t,n){return bt(e,t,t,n)}P(xt,`intersectCircle`);var St=xt;function Ct(e,t,n,r){{let i=t.y-e.y,a=e.x-t.x,o=t.x*e.y-e.x*t.y,s=i*n.x+a*n.y+o,c=i*r.x+a*r.y+o,l=1e-6;if(s!==0&&c!==0&&wt(s,c))return;let u=r.y-n.y,d=n.x-r.x,f=r.x*n.y-n.x*r.y,p=u*e.x+d*e.y+f,m=u*t.x+d*t.y+f;if(Math.abs(p)<l&&Math.abs(m)<l&&wt(p,m))return;let h=i*d-u*a;if(h===0)return;let g=Math.abs(h/2),_=a*f-d*o,v=_<0?(_-g)/h:(_+g)/h;return _=u*o-i*f,{x:v,y:_<0?(_-g)/h:(_+g)/h}}}P(Ct,`intersectLine`);function wt(e,t){return e*t>0}P(wt,`sameSign`);var Tt=Ct;function Et(e,t,n){let r=e.x,i=e.y,a=[],o=1/0,s=1/0;typeof t.forEach==`function`?t.forEach(function(e){o=Math.min(o,e.x),s=Math.min(s,e.y)}):(o=Math.min(o,t.x),s=Math.min(s,t.y));let c=r-e.width/2-o,l=i-e.height/2-s;for(let r=0;r<t.length;r++){let i=t[r],o=t[r<t.length-1?r+1:0],s=Tt(e,n,{x:c+i.x,y:l+i.y},{x:c+o.x,y:l+o.y});s&&a.push(s)}return a.length?(a.length>1&&a.sort(function(e,t){let r=e.x-n.x,i=e.y-n.y,a=Math.sqrt(r*r+i*i),o=t.x-n.x,s=t.y-n.y,c=Math.sqrt(o*o+s*s);return a<c?-1:a===c?0:1}),a[0]):e}P(Et,`intersectPolygon`);var X={node:vt,circle:St,ellipse:bt,polygon:Et,rect:st};function Dt(e,t){let{labelStyles:n}=R(t);t.labelStyle=n;let r=H(t),i=r;r||(i=`anchor`);let a=e.insert(`g`).attr(`class`,i).attr(`id`,t.domId||t.id),{cssStyles:o}=t,s=Y.svg(a),c=z(t,{fill:`black`,stroke:`none`,fillStyle:`solid`});t.look!==`handDrawn`&&(c.roughness=0);let l=s.circle(0,0,2,c),u=a.insert(()=>l,`:first-child`);return u.attr(`class`,`anchor`).attr(`style`,k(o)),V(t,u),t.intersect=function(e){return y.info(`Circle intersect`,t,1,e),X.circle(t,1,e)},a}P(Dt,`anchor`);function Ot(e,t,n,r,i,a,o){let s=(e+n)/2,c=(t+r)/2,l=Math.atan2(r-t,n-e),u=(n-e)/2,d=(r-t)/2,f=u/i,p=d/a,m=Math.sqrt(f**2+p**2);if(m>1)throw Error(`The given radii are too small to create an arc between the points.`);let h=Math.sqrt(1-m**2),g=s+h*a*Math.sin(l)*(o?-1:1),_=c-h*i*Math.cos(l)*(o?-1:1),v=Math.atan2((t-_)/a,(e-g)/i),y=Math.atan2((r-_)/a,(n-g)/i)-v;o&&y<0&&(y+=2*Math.PI),!o&&y>0&&(y-=2*Math.PI);let b=[];for(let e=0;e<20;e++){let t=v+e/19*y,n=g+i*Math.cos(t),r=_+a*Math.sin(t);b.push({x:n,y:r})}return b}P(Ot,`generateArcPoints`);async function kt(e,t){let{labelStyles:n,nodeStyles:r}=R(t);t.labelStyle=n;let{shapeSvg:i,bbox:a}=await B(e,t,H(t)),o=a.width+t.padding+20,s=a.height+t.padding,c=s/2,l=c/(2.5+s/50),{cssStyles:u}=t,d=[{x:o/2,y:-s/2},{x:-o/2,y:-s/2},...Ot(-o/2,-s/2,-o/2,s/2,l,c,!1),{x:o/2,y:s/2},...Ot(o/2,s/2,o/2,-s/2,l,c,!0)],f=Y.svg(i),p=z(t,{});t.look!==`handDrawn`&&(p.roughness=0,p.fillStyle=`solid`);let m=U(d),h=f.path(m,p),g=i.insert(()=>h,`:first-child`);return g.attr(`class`,`basic label-container`),u&&t.look!==`handDrawn`&&g.selectAll(`path`).attr(`style`,u),r&&t.look!==`handDrawn`&&g.selectAll(`path`).attr(`style`,r),g.attr(`transform`,`translate(${l/2}, 0)`),V(t,g),t.intersect=function(e){return X.polygon(t,d,e)},i}P(kt,`bowTieRect`);function At(e,t,n,r){return e.insert(`polygon`,`:first-child`).attr(`points`,r.map(function(e){return e.x+`,`+e.y}).join(` `)).attr(`class`,`label-container`).attr(`transform`,`translate(`+-t/2+`,`+n/2+`)`)}P(At,`insertPolygonShape`);async function jt(e,t){let{labelStyles:n,nodeStyles:r}=R(t);t.labelStyle=n;let{shapeSvg:i,bbox:a}=await B(e,t,H(t)),o=a.height+t.padding,s=a.width+t.padding+12,c=s,l=-o,u=[{x:12,y:l},{x:c,y:l},{x:c,y:0},{x:0,y:0},{x:0,y:l+12},{x:12,y:l}],d,{cssStyles:f}=t;if(t.look===`handDrawn`){let e=Y.svg(i),n=z(t,{}),r=U(u),a=e.path(r,n);d=i.insert(()=>a,`:first-child`).attr(`transform`,`translate(${-s/2}, ${o/2})`),f&&d.attr(`style`,f)}else d=At(i,s,o,u);return r&&d.attr(`style`,r),V(t,d),t.intersect=function(e){return X.polygon(t,u,e)},i}P(jt,`card`);function Mt(e,t){let{nodeStyles:n}=R(t);t.label=``;let r=e.insert(`g`).attr(`class`,H(t)).attr(`id`,t.domId??t.id),{cssStyles:i}=t,a=Math.max(28,t.width??0),o=[{x:0,y:a/2},{x:a/2,y:0},{x:0,y:-a/2},{x:-a/2,y:0}],s=Y.svg(r),c=z(t,{});t.look!==`handDrawn`&&(c.roughness=0,c.fillStyle=`solid`);let l=U(o),u=s.path(l,c),d=r.insert(()=>u,`:first-child`);return i&&t.look!==`handDrawn`&&d.selectAll(`path`).attr(`style`,i),n&&t.look!==`handDrawn`&&d.selectAll(`path`).attr(`style`,n),t.width=28,t.height=28,t.intersect=function(e){return X.polygon(t,o,e)},r}P(Mt,`choice`);async function Nt(e,t,n){let{labelStyles:r,nodeStyles:i}=R(t);t.labelStyle=r;let{shapeSvg:a,bbox:o,halfPadding:s}=await B(e,t,H(t)),c=n?.padding??s,l=o.width/2+c,u,{cssStyles:d}=t;if(t.look===`handDrawn`){let e=Y.svg(a),n=z(t,{}),r=e.circle(0,0,l*2,n);u=a.insert(()=>r,`:first-child`),u.attr(`class`,`basic label-container`).attr(`style`,k(d))}else u=a.insert(`circle`,`:first-child`).attr(`class`,`basic label-container`).attr(`style`,i).attr(`r`,l).attr(`cx`,0).attr(`cy`,0);return V(t,u),t.calcIntersect=function(e,t){let n=e.width/2;return X.circle(e,n,t)},t.intersect=function(e){return y.info(`Circle intersect`,t,l,e),X.circle(t,l,e)},a}P(Nt,`circle`);function Pt(e){let t=Math.cos(Math.PI/4),n=Math.sin(Math.PI/4),r=e*2,i={x:r/2*t,y:r/2*n},a={x:-(r/2)*t,y:r/2*n},o={x:-(r/2)*t,y:-(r/2)*n},s={x:r/2*t,y:-(r/2)*n};return`M ${a.x},${a.y} L ${s.x},${s.y}
                   M ${i.x},${i.y} L ${o.x},${o.y}`}P(Pt,`createLine`);function Ft(e,t){let{labelStyles:n,nodeStyles:r}=R(t);t.labelStyle=n,t.label=``;let i=e.insert(`g`).attr(`class`,H(t)).attr(`id`,t.domId??t.id),a=Math.max(30,t?.width??0),{cssStyles:o}=t,s=Y.svg(i),c=z(t,{});t.look!==`handDrawn`&&(c.roughness=0,c.fillStyle=`solid`);let l=s.circle(0,0,a*2,c),u=Pt(a),d=s.path(u,c),f=i.insert(()=>l,`:first-child`);return f.insert(()=>d),o&&t.look!==`handDrawn`&&f.selectAll(`path`).attr(`style`,o),r&&t.look!==`handDrawn`&&f.selectAll(`path`).attr(`style`,r),V(t,f),t.intersect=function(e){return y.info(`crossedCircle intersect`,t,{radius:a,point:e}),X.circle(t,a,e)},i}P(Ft,`crossedCircle`);function It(e,t,n,r=100,i=0,a=180){let o=[],s=i*Math.PI/180,c=(a*Math.PI/180-s)/(r-1);for(let i=0;i<r;i++){let r=s+i*c,a=e+n*Math.cos(r),l=t+n*Math.sin(r);o.push({x:-a,y:-l})}return o}P(It,`generateCirclePoints`);async function Lt(e,t){let{labelStyles:n,nodeStyles:r}=R(t);t.labelStyle=n;let{shapeSvg:i,bbox:a,label:o}=await B(e,t,H(t)),s=a.width+(t.padding??0),c=a.height+(t.padding??0),l=Math.max(5,c*.1),{cssStyles:u}=t,d=[...It(s/2,-c/2,l,30,-90,0),{x:-s/2-l,y:l},...It(s/2+l*2,-l,l,20,-180,-270),...It(s/2+l*2,l,l,20,-90,-180),{x:-s/2-l,y:-c/2},...It(s/2,c/2,l,20,0,90)],f=[{x:s/2,y:-c/2-l},{x:-s/2,y:-c/2-l},...It(s/2,-c/2,l,20,-90,0),{x:-s/2-l,y:-l},...It(s/2+s*.1,-l,l,20,-180,-270),...It(s/2+s*.1,l,l,20,-90,-180),{x:-s/2-l,y:c/2},...It(s/2,c/2,l,20,0,90),{x:-s/2,y:c/2+l},{x:s/2,y:c/2+l}],p=Y.svg(i),m=z(t,{fill:`none`});t.look!==`handDrawn`&&(m.roughness=0,m.fillStyle=`solid`);let h=U(d).replace(`Z`,``),g=p.path(h,m),_=U(f),v=p.path(_,{...m}),y=i.insert(`g`,`:first-child`);return y.insert(()=>v,`:first-child`).attr(`stroke-opacity`,0),y.insert(()=>g,`:first-child`),y.attr(`class`,`text`),u&&t.look!==`handDrawn`&&y.selectAll(`path`).attr(`style`,u),r&&t.look!==`handDrawn`&&y.selectAll(`path`).attr(`style`,r),y.attr(`transform`,`translate(${l}, 0)`),o.attr(`transform`,`translate(${-s/2+l-(a.x-(a.left??0))},${-c/2+(t.padding??0)/2-(a.y-(a.top??0))})`),V(t,y),t.intersect=function(e){return X.polygon(t,f,e)},i}P(Lt,`curlyBraceLeft`);function Rt(e,t,n,r=100,i=0,a=180){let o=[],s=i*Math.PI/180,c=(a*Math.PI/180-s)/(r-1);for(let i=0;i<r;i++){let r=s+i*c,a=e+n*Math.cos(r),l=t+n*Math.sin(r);o.push({x:a,y:l})}return o}P(Rt,`generateCirclePoints`);async function zt(e,t){let{labelStyles:n,nodeStyles:r}=R(t);t.labelStyle=n;let{shapeSvg:i,bbox:a,label:o}=await B(e,t,H(t)),s=a.width+(t.padding??0),c=a.height+(t.padding??0),l=Math.max(5,c*.1),{cssStyles:u}=t,d=[...Rt(s/2,-c/2,l,20,-90,0),{x:s/2+l,y:-l},...Rt(s/2+l*2,-l,l,20,-180,-270),...Rt(s/2+l*2,l,l,20,-90,-180),{x:s/2+l,y:c/2},...Rt(s/2,c/2,l,20,0,90)],f=[{x:-s/2,y:-c/2-l},{x:s/2,y:-c/2-l},...Rt(s/2,-c/2,l,20,-90,0),{x:s/2+l,y:-l},...Rt(s/2+l*2,-l,l,20,-180,-270),...Rt(s/2+l*2,l,l,20,-90,-180),{x:s/2+l,y:c/2},...Rt(s/2,c/2,l,20,0,90),{x:s/2,y:c/2+l},{x:-s/2,y:c/2+l}],p=Y.svg(i),m=z(t,{fill:`none`});t.look!==`handDrawn`&&(m.roughness=0,m.fillStyle=`solid`);let h=U(d).replace(`Z`,``),g=p.path(h,m),_=U(f),v=p.path(_,{...m}),y=i.insert(`g`,`:first-child`);return y.insert(()=>v,`:first-child`).attr(`stroke-opacity`,0),y.insert(()=>g,`:first-child`),y.attr(`class`,`text`),u&&t.look!==`handDrawn`&&y.selectAll(`path`).attr(`style`,u),r&&t.look!==`handDrawn`&&y.selectAll(`path`).attr(`style`,r),y.attr(`transform`,`translate(${-l}, 0)`),o.attr(`transform`,`translate(${-s/2+(t.padding??0)/2-(a.x-(a.left??0))},${-c/2+(t.padding??0)/2-(a.y-(a.top??0))})`),V(t,y),t.intersect=function(e){return X.polygon(t,f,e)},i}P(zt,`curlyBraceRight`);function Z(e,t,n,r=100,i=0,a=180){let o=[],s=i*Math.PI/180,c=(a*Math.PI/180-s)/(r-1);for(let i=0;i<r;i++){let r=s+i*c,a=e+n*Math.cos(r),l=t+n*Math.sin(r);o.push({x:-a,y:-l})}return o}P(Z,`generateCirclePoints`);async function Bt(e,t){let{labelStyles:n,nodeStyles:r}=R(t);t.labelStyle=n;let{shapeSvg:i,bbox:a,label:o}=await B(e,t,H(t)),s=a.width+(t.padding??0),c=a.height+(t.padding??0),l=Math.max(5,c*.1),{cssStyles:u}=t,d=[...Z(s/2,-c/2,l,30,-90,0),{x:-s/2-l,y:l},...Z(s/2+l*2,-l,l,20,-180,-270),...Z(s/2+l*2,l,l,20,-90,-180),{x:-s/2-l,y:-c/2},...Z(s/2,c/2,l,20,0,90)],f=[...Z(-s/2+l+l/2,-c/2,l,20,-90,-180),{x:s/2-l/2,y:l},...Z(-s/2-l/2,-l,l,20,0,90),...Z(-s/2-l/2,l,l,20,-90,0),{x:s/2-l/2,y:-l},...Z(-s/2+l+l/2,c/2,l,30,-180,-270)],p=[{x:s/2,y:-c/2-l},{x:-s/2,y:-c/2-l},...Z(s/2,-c/2,l,20,-90,0),{x:-s/2-l,y:-l},...Z(s/2+l*2,-l,l,20,-180,-270),...Z(s/2+l*2,l,l,20,-90,-180),{x:-s/2-l,y:c/2},...Z(s/2,c/2,l,20,0,90),{x:-s/2,y:c/2+l},{x:s/2-l-l/2,y:c/2+l},...Z(-s/2+l+l/2,-c/2,l,20,-90,-180),{x:s/2-l/2,y:l},...Z(-s/2-l/2,-l,l,20,0,90),...Z(-s/2-l/2,l,l,20,-90,0),{x:s/2-l/2,y:-l},...Z(-s/2+l+l/2,c/2,l,30,-180,-270)],m=Y.svg(i),h=z(t,{fill:`none`});t.look!==`handDrawn`&&(h.roughness=0,h.fillStyle=`solid`);let g=U(d).replace(`Z`,``),_=m.path(g,h),v=U(f).replace(`Z`,``),y=m.path(v,h),b=U(p),x=m.path(b,{...h}),S=i.insert(`g`,`:first-child`);return S.insert(()=>x,`:first-child`).attr(`stroke-opacity`,0),S.insert(()=>_,`:first-child`),S.insert(()=>y,`:first-child`),S.attr(`class`,`text`),u&&t.look!==`handDrawn`&&S.selectAll(`path`).attr(`style`,u),r&&t.look!==`handDrawn`&&S.selectAll(`path`).attr(`style`,r),S.attr(`transform`,`translate(${l-l/4}, 0)`),o.attr(`transform`,`translate(${-s/2+(t.padding??0)/2-(a.x-(a.left??0))},${-c/2+(t.padding??0)/2-(a.y-(a.top??0))})`),V(t,S),t.intersect=function(e){return X.polygon(t,p,e)},i}P(Bt,`curlyBraces`);async function Vt(e,t){let{labelStyles:n,nodeStyles:r}=R(t);t.labelStyle=n;let{shapeSvg:i,bbox:a}=await B(e,t,H(t)),o=Math.max(80,(a.width+(t.padding??0)*2)*1.25,t?.width??0),s=Math.max(20,a.height+(t.padding??0)*2,t?.height??0),c=s/2,{cssStyles:l}=t,u=Y.svg(i),d=z(t,{});t.look!==`handDrawn`&&(d.roughness=0,d.fillStyle=`solid`);let f=o,p=s,m=f-c,h=p/4,g=[{x:m,y:0},{x:h,y:0},{x:0,y:p/2},{x:h,y:p},{x:m,y:p},...ae(-m,-p/2,c,50,270,90)],_=U(g),v=u.path(_,d),y=i.insert(()=>v,`:first-child`);return y.attr(`class`,`basic label-container`),l&&t.look!==`handDrawn`&&y.selectChildren(`path`).attr(`style`,l),r&&t.look!==`handDrawn`&&y.selectChildren(`path`).attr(`style`,r),y.attr(`transform`,`translate(${-o/2}, ${-s/2})`),V(t,y),t.intersect=function(e){return X.polygon(t,g,e)},i}P(Vt,`curvedTrapezoid`);var Ht=P((e,t,n,r,i,a)=>[`M${e},${t+a}`,`a${i},${a} 0,0,0 ${n},0`,`a${i},${a} 0,0,0 ${-n},0`,`l0,${r}`,`a${i},${a} 0,0,0 ${n},0`,`l0,${-r}`].join(` `),`createCylinderPathD`),Ut=P((e,t,n,r,i,a)=>[`M${e},${t+a}`,`M${e+n},${t+a}`,`a${i},${a} 0,0,0 ${-n},0`,`l0,${r}`,`a${i},${a} 0,0,0 ${n},0`,`l0,${-r}`].join(` `),`createOuterCylinderPathD`),Wt=P((e,t,n,r,i,a)=>[`M${e-n/2},${-r/2}`,`a${i},${a} 0,0,0 ${n},0`].join(` `),`createInnerCylinderPathD`);async function Gt(e,t){let{labelStyles:n,nodeStyles:r}=R(t);t.labelStyle=n;let{shapeSvg:i,bbox:a,label:o}=await B(e,t,H(t)),s=Math.max(a.width+t.padding,t.width??0),c=s/2,l=c/(2.5+s/50),u=Math.max(a.height+l+t.padding,t.height??0),d,{cssStyles:f}=t;if(t.look===`handDrawn`){let e=Y.svg(i),n=Ut(0,0,s,u,c,l),r=Wt(0,l,s,u,c,l),a=e.path(n,z(t,{})),o=e.path(r,z(t,{fill:`none`}));d=i.insert(()=>o,`:first-child`),d=i.insert(()=>a,`:first-child`),d.attr(`class`,`basic label-container`),f&&d.attr(`style`,f)}else{let e=Ht(0,0,s,u,c,l);d=i.insert(`path`,`:first-child`).attr(`d`,e).attr(`class`,`basic label-container`).attr(`style`,k(f)).attr(`style`,r)}return d.attr(`label-offset-y`,l),d.attr(`transform`,`translate(${-s/2}, ${-(u/2+l)})`),V(t,d),o.attr(`transform`,`translate(${-(a.width/2)-(a.x-(a.left??0))}, ${-(a.height/2)+(t.padding??0)/1.5-(a.y-(a.top??0))})`),t.intersect=function(e){let n=X.rect(t,e),r=n.x-(t.x??0);if(c!=0&&(Math.abs(r)<(t.width??0)/2||Math.abs(r)==(t.width??0)/2&&Math.abs(n.y-(t.y??0))>(t.height??0)/2-l)){let i=l*l*(1-r*r/(c*c));i>0&&(i=Math.sqrt(i)),i=l-i,e.y-(t.y??0)>0&&(i=-i),n.y+=i}return n},i}P(Gt,`cylinder`);async function Kt(e,t){let{labelStyles:n,nodeStyles:r}=R(t);t.labelStyle=n;let{shapeSvg:i,bbox:a,label:o}=await B(e,t,H(t)),s=a.width+t.padding,c=a.height+t.padding,l=c*.2,u=-s/2,d=-c/2-l/2,{cssStyles:f}=t,p=Y.svg(i),m=z(t,{});t.look!==`handDrawn`&&(m.roughness=0,m.fillStyle=`solid`);let h=[{x:u,y:d+l},{x:-u,y:d+l},{x:-u,y:-d},{x:u,y:-d},{x:u,y:d},{x:-u,y:d},{x:-u,y:d+l}],g=p.polygon(h.map(e=>[e.x,e.y]),m),_=i.insert(()=>g,`:first-child`);return _.attr(`class`,`basic label-container`),f&&t.look!==`handDrawn`&&_.selectAll(`path`).attr(`style`,f),r&&t.look!==`handDrawn`&&_.selectAll(`path`).attr(`style`,r),o.attr(`transform`,`translate(${u+(t.padding??0)/2-(a.x-(a.left??0))}, ${d+l+(t.padding??0)/2-(a.y-(a.top??0))})`),V(t,_),t.intersect=function(e){return X.rect(t,e)},i}P(Kt,`dividedRectangle`);async function qt(e,t){let{labelStyles:n,nodeStyles:r}=R(t);t.labelStyle=n;let{shapeSvg:i,bbox:a,halfPadding:o}=await B(e,t,H(t)),s=a.width/2+o+5,c=a.width/2+o,l,{cssStyles:u}=t;if(t.look===`handDrawn`){let e=Y.svg(i),n=z(t,{roughness:.2,strokeWidth:2.5}),r=z(t,{roughness:.2,strokeWidth:1.5}),a=e.circle(0,0,s*2,n),o=e.circle(0,0,c*2,r);l=i.insert(`g`,`:first-child`),l.attr(`class`,k(t.cssClasses)).attr(`style`,k(u)),l.node()?.appendChild(a),l.node()?.appendChild(o)}else{l=i.insert(`g`,`:first-child`);let e=l.insert(`circle`,`:first-child`),t=l.insert(`circle`);l.attr(`class`,`basic label-container`).attr(`style`,r),e.attr(`class`,`outer-circle`).attr(`style`,r).attr(`r`,s).attr(`cx`,0).attr(`cy`,0),t.attr(`class`,`inner-circle`).attr(`style`,r).attr(`r`,c).attr(`cx`,0).attr(`cy`,0)}return V(t,l),t.intersect=function(e){return y.info(`DoubleCircle intersect`,t,s,e),X.circle(t,s,e)},i}P(qt,`doublecircle`);function Jt(e,t,{config:{themeVariables:n}}){let{labelStyles:r,nodeStyles:i}=R(t);t.label=``,t.labelStyle=r;let a=e.insert(`g`).attr(`class`,H(t)).attr(`id`,t.domId??t.id),{cssStyles:o}=t,s=Y.svg(a),{nodeBorder:c}=n,l=z(t,{fillStyle:`solid`});t.look!==`handDrawn`&&(l.roughness=0);let u=s.circle(0,0,14,l),d=a.insert(()=>u,`:first-child`);return d.selectAll(`path`).attr(`style`,`fill: ${c} !important;`),o&&o.length>0&&t.look!==`handDrawn`&&d.selectAll(`path`).attr(`style`,o),i&&t.look!==`handDrawn`&&d.selectAll(`path`).attr(`style`,i),V(t,d),t.intersect=function(e){return y.info(`filledCircle intersect`,t,{radius:7,point:e}),X.circle(t,7,e)},a}P(Jt,`filledCircle`);async function Yt(e,t){let{labelStyles:n,nodeStyles:r}=R(t);t.labelStyle=n;let{shapeSvg:i,bbox:a,label:o}=await B(e,t,H(t)),s=a.width+(t.padding??0),c=s+a.height,l=s+a.height,u=[{x:0,y:-c},{x:l,y:-c},{x:l/2,y:0}],{cssStyles:d}=t,f=Y.svg(i),p=z(t,{});t.look!==`handDrawn`&&(p.roughness=0,p.fillStyle=`solid`);let m=U(u),h=f.path(m,p),g=i.insert(()=>h,`:first-child`).attr(`transform`,`translate(${-c/2}, ${c/2})`);return d&&t.look!==`handDrawn`&&g.selectChildren(`path`).attr(`style`,d),r&&t.look!==`handDrawn`&&g.selectChildren(`path`).attr(`style`,r),t.width=s,t.height=c,V(t,g),o.attr(`transform`,`translate(${-a.width/2-(a.x-(a.left??0))}, ${-c/2+(t.padding??0)/2+(a.y-(a.top??0))})`),t.intersect=function(e){return y.info(`Triangle intersect`,t,u,e),X.polygon(t,u,e)},i}P(Yt,`flippedTriangle`);function Xt(e,t,{dir:n,config:{state:r,themeVariables:i}}){let{nodeStyles:a}=R(t);t.label=``;let o=e.insert(`g`).attr(`class`,H(t)).attr(`id`,t.domId??t.id),{cssStyles:s}=t,c=Math.max(70,t?.width??0),l=Math.max(10,t?.height??0);n===`LR`&&(c=Math.max(10,t?.width??0),l=Math.max(70,t?.height??0));let u=-1*c/2,d=-1*l/2,f=Y.svg(o),p=z(t,{stroke:i.lineColor,fill:i.lineColor});t.look!==`handDrawn`&&(p.roughness=0,p.fillStyle=`solid`);let m=f.rectangle(u,d,c,l,p),h=o.insert(()=>m,`:first-child`);s&&t.look!==`handDrawn`&&h.selectAll(`path`).attr(`style`,s),a&&t.look!==`handDrawn`&&h.selectAll(`path`).attr(`style`,a),V(t,h);let g=r?.padding??0;return t.width&&t.height&&(t.width+=g/2||0,t.height+=g/2||0),t.intersect=function(e){return X.rect(t,e)},o}P(Xt,`forkJoin`);async function Zt(e,t){let{labelStyles:n,nodeStyles:r}=R(t);t.labelStyle=n;let{shapeSvg:i,bbox:a}=await B(e,t,H(t)),o=Math.max(80,a.width+(t.padding??0)*2,t?.width??0),s=Math.max(50,a.height+(t.padding??0)*2,t?.height??0),c=s/2,{cssStyles:l}=t,u=Y.svg(i),d=z(t,{});t.look!==`handDrawn`&&(d.roughness=0,d.fillStyle=`solid`);let f=[{x:-o/2,y:-s/2},{x:o/2-c,y:-s/2},...ae(-o/2+c,0,c,50,90,270),{x:o/2-c,y:s/2},{x:-o/2,y:s/2}],p=U(f),m=u.path(p,d),h=i.insert(()=>m,`:first-child`);return h.attr(`class`,`basic label-container`),l&&t.look!==`handDrawn`&&h.selectChildren(`path`).attr(`style`,l),r&&t.look!==`handDrawn`&&h.selectChildren(`path`).attr(`style`,r),V(t,h),t.intersect=function(e){return y.info(`Pill intersect`,t,{radius:c,point:e}),X.polygon(t,f,e)},i}P(Zt,`halfRoundedRectangle`);async function Qt(e,t){let{labelStyles:n,nodeStyles:r}=R(t);t.labelStyle=n;let{shapeSvg:i,bbox:a}=await B(e,t,H(t)),o=a.height+(t.padding??0),s=a.width+(t.padding??0)*2.5,{cssStyles:c}=t,l=Y.svg(i),u=z(t,{});t.look!==`handDrawn`&&(u.roughness=0,u.fillStyle=`solid`);let d=s/2,f=d/6;d+=f;let p=o/2,m=p/2,h=d-m,g=[{x:-h,y:-p},{x:0,y:-p},{x:h,y:-p},{x:d,y:0},{x:h,y:p},{x:0,y:p},{x:-h,y:p},{x:-d,y:0}],_=U(g),v=l.path(_,u),y=i.insert(()=>v,`:first-child`);return y.attr(`class`,`basic label-container`),c&&t.look!==`handDrawn`&&y.selectChildren(`path`).attr(`style`,c),r&&t.look!==`handDrawn`&&y.selectChildren(`path`).attr(`style`,r),t.width=s,t.height=o,V(t,y),t.intersect=function(e){return X.polygon(t,g,e)},i}P(Qt,`hexagon`);async function $t(e,t){let{labelStyles:n,nodeStyles:r}=R(t);t.label=``,t.labelStyle=n;let{shapeSvg:i}=await B(e,t,H(t)),a=Math.max(30,t?.width??0),o=Math.max(30,t?.height??0),{cssStyles:s}=t,c=Y.svg(i),l=z(t,{});t.look!==`handDrawn`&&(l.roughness=0,l.fillStyle=`solid`);let u=[{x:0,y:0},{x:a,y:0},{x:0,y:o},{x:a,y:o}],d=U(u),f=c.path(d,l),p=i.insert(()=>f,`:first-child`);return p.attr(`class`,`basic label-container`),s&&t.look!==`handDrawn`&&p.selectChildren(`path`).attr(`style`,s),r&&t.look!==`handDrawn`&&p.selectChildren(`path`).attr(`style`,r),p.attr(`transform`,`translate(${-a/2}, ${-o/2})`),V(t,p),t.intersect=function(e){return y.info(`Pill intersect`,t,{points:u}),X.polygon(t,u,e)},i}P($t,`hourglass`);async function en(e,t,{config:{themeVariables:n,flowchart:r}}){let{labelStyles:i}=R(t);t.labelStyle=i;let a=t.assetHeight??48,o=t.assetWidth??48,s=Math.max(a,o),c=r?.wrappingWidth;t.width=Math.max(s,c??0);let{shapeSvg:l,bbox:u,label:d}=await B(e,t,`icon-shape default`),f=t.pos===`t`,p=s,m=s,{nodeBorder:h}=n,{stylesMap:g}=I(t),_=-m/2,v=-p/2,b=t.label?8:0,x=Y.svg(l),C=z(t,{stroke:`none`,fill:`none`});t.look!==`handDrawn`&&(C.roughness=0,C.fillStyle=`solid`);let w=x.rectangle(_,v,m,p,C),T=Math.max(m,u.width),E=p+u.height+b,D=x.rectangle(-T/2,-E/2,T,E,{...C,fill:`transparent`,stroke:`none`}),O=l.insert(()=>w,`:first-child`),k=l.insert(()=>D);if(t.icon){let e=l.append(`g`);e.html(`<g>${await S(t.icon,{height:s,width:s,fallbackPrefix:``})}</g>`);let n=e.node().getBBox(),r=n.width,i=n.height,a=n.x,o=n.y;e.attr(`transform`,`translate(${-r/2-a},${f?u.height/2+b/2-i/2-o:-u.height/2-b/2-i/2-o})`),e.attr(`style`,`color: ${g.get(`stroke`)??h};`)}return d.attr(`transform`,`translate(${-u.width/2-(u.x-(u.left??0))},${f?-E/2:E/2-u.height})`),O.attr(`transform`,`translate(0,${f?u.height/2+b/2:-u.height/2-b/2})`),V(t,k),t.intersect=function(e){if(y.info(`iconSquare intersect`,t,e),!t.label)return X.rect(t,e);let n=t.x??0,r=t.y??0,i=t.height??0,a=[];return a=f?[{x:n-u.width/2,y:r-i/2},{x:n+u.width/2,y:r-i/2},{x:n+u.width/2,y:r-i/2+u.height+b},{x:n+m/2,y:r-i/2+u.height+b},{x:n+m/2,y:r+i/2},{x:n-m/2,y:r+i/2},{x:n-m/2,y:r-i/2+u.height+b},{x:n-u.width/2,y:r-i/2+u.height+b}]:[{x:n-m/2,y:r-i/2},{x:n+m/2,y:r-i/2},{x:n+m/2,y:r-i/2+p},{x:n+u.width/2,y:r-i/2+p},{x:n+u.width/2/2,y:r+i/2},{x:n-u.width/2,y:r+i/2},{x:n-u.width/2,y:r-i/2+p},{x:n-m/2,y:r-i/2+p}],X.polygon(t,a,e)},l}P(en,`icon`);async function tn(e,t,{config:{themeVariables:n,flowchart:r}}){let{labelStyles:i}=R(t);t.labelStyle=i;let a=t.assetHeight??48,o=t.assetWidth??48,s=Math.max(a,o),c=r?.wrappingWidth;t.width=Math.max(s,c??0);let{shapeSvg:l,bbox:u,label:d}=await B(e,t,`icon-shape default`),f=t.label?8:0,p=t.pos===`t`,{nodeBorder:m,mainBkg:h}=n,{stylesMap:g}=I(t),_=Y.svg(l),v=z(t,{});t.look!==`handDrawn`&&(v.roughness=0,v.fillStyle=`solid`),v.stroke=g.get(`fill`)??h;let b=l.append(`g`);t.icon&&b.html(`<g>${await S(t.icon,{height:s,width:s,fallbackPrefix:``})}</g>`);let x=b.node().getBBox(),C=x.width,w=x.height,T=x.x,E=x.y,D=Math.max(C,w)*Math.SQRT2+40,O=_.circle(0,0,D,v),k=Math.max(D,u.width),A=D+u.height+f,j=_.rectangle(-k/2,-A/2,k,A,{...v,fill:`transparent`,stroke:`none`}),M=l.insert(()=>O,`:first-child`),N=l.insert(()=>j);return b.attr(`transform`,`translate(${-C/2-T},${p?u.height/2+f/2-w/2-E:-u.height/2-f/2-w/2-E})`),b.attr(`style`,`color: ${g.get(`stroke`)??m};`),d.attr(`transform`,`translate(${-u.width/2-(u.x-(u.left??0))},${p?-A/2:A/2-u.height})`),M.attr(`transform`,`translate(0,${p?u.height/2+f/2:-u.height/2-f/2})`),V(t,N),t.intersect=function(e){return y.info(`iconSquare intersect`,t,e),X.rect(t,e)},l}P(tn,`iconCircle`);async function nn(e,t,{config:{themeVariables:n,flowchart:r}}){let{labelStyles:i}=R(t);t.labelStyle=i;let a=t.assetHeight??48,o=t.assetWidth??48,s=Math.max(a,o),c=r?.wrappingWidth;t.width=Math.max(s,c??0);let{shapeSvg:l,bbox:u,halfPadding:d,label:f}=await B(e,t,`icon-shape default`),p=t.pos===`t`,m=s+d*2,h=s+d*2,{nodeBorder:g,mainBkg:_}=n,{stylesMap:v}=I(t),b=-h/2,x=-m/2,C=t.label?8:0,w=Y.svg(l),T=z(t,{});t.look!==`handDrawn`&&(T.roughness=0,T.fillStyle=`solid`),T.stroke=v.get(`fill`)??_;let E=w.path(dt(b,x,h,m,5),T),D=Math.max(h,u.width),O=m+u.height+C,k=w.rectangle(-D/2,-O/2,D,O,{...T,fill:`transparent`,stroke:`none`}),A=l.insert(()=>E,`:first-child`).attr(`class`,`icon-shape2`),j=l.insert(()=>k);if(t.icon){let e=l.append(`g`);e.html(`<g>${await S(t.icon,{height:s,width:s,fallbackPrefix:``})}</g>`);let n=e.node().getBBox(),r=n.width,i=n.height,a=n.x,o=n.y;e.attr(`transform`,`translate(${-r/2-a},${p?u.height/2+C/2-i/2-o:-u.height/2-C/2-i/2-o})`),e.attr(`style`,`color: ${v.get(`stroke`)??g};`)}return f.attr(`transform`,`translate(${-u.width/2-(u.x-(u.left??0))},${p?-O/2:O/2-u.height})`),A.attr(`transform`,`translate(0,${p?u.height/2+C/2:-u.height/2-C/2})`),V(t,j),t.intersect=function(e){if(y.info(`iconSquare intersect`,t,e),!t.label)return X.rect(t,e);let n=t.x??0,r=t.y??0,i=t.height??0,a=[];return a=p?[{x:n-u.width/2,y:r-i/2},{x:n+u.width/2,y:r-i/2},{x:n+u.width/2,y:r-i/2+u.height+C},{x:n+h/2,y:r-i/2+u.height+C},{x:n+h/2,y:r+i/2},{x:n-h/2,y:r+i/2},{x:n-h/2,y:r-i/2+u.height+C},{x:n-u.width/2,y:r-i/2+u.height+C}]:[{x:n-h/2,y:r-i/2},{x:n+h/2,y:r-i/2},{x:n+h/2,y:r-i/2+m},{x:n+u.width/2,y:r-i/2+m},{x:n+u.width/2/2,y:r+i/2},{x:n-u.width/2,y:r+i/2},{x:n-u.width/2,y:r-i/2+m},{x:n-h/2,y:r-i/2+m}],X.polygon(t,a,e)},l}P(nn,`iconRounded`);async function rn(e,t,{config:{themeVariables:n,flowchart:r}}){let{labelStyles:i}=R(t);t.labelStyle=i;let a=t.assetHeight??48,o=t.assetWidth??48,s=Math.max(a,o),c=r?.wrappingWidth;t.width=Math.max(s,c??0);let{shapeSvg:l,bbox:u,halfPadding:d,label:f}=await B(e,t,`icon-shape default`),p=t.pos===`t`,m=s+d*2,h=s+d*2,{nodeBorder:g,mainBkg:_}=n,{stylesMap:v}=I(t),b=-h/2,x=-m/2,C=t.label?8:0,w=Y.svg(l),T=z(t,{});t.look!==`handDrawn`&&(T.roughness=0,T.fillStyle=`solid`),T.stroke=v.get(`fill`)??_;let E=w.path(dt(b,x,h,m,.1),T),D=Math.max(h,u.width),O=m+u.height+C,k=w.rectangle(-D/2,-O/2,D,O,{...T,fill:`transparent`,stroke:`none`}),A=l.insert(()=>E,`:first-child`),j=l.insert(()=>k);if(t.icon){let e=l.append(`g`);e.html(`<g>${await S(t.icon,{height:s,width:s,fallbackPrefix:``})}</g>`);let n=e.node().getBBox(),r=n.width,i=n.height,a=n.x,o=n.y;e.attr(`transform`,`translate(${-r/2-a},${p?u.height/2+C/2-i/2-o:-u.height/2-C/2-i/2-o})`),e.attr(`style`,`color: ${v.get(`stroke`)??g};`)}return f.attr(`transform`,`translate(${-u.width/2-(u.x-(u.left??0))},${p?-O/2:O/2-u.height})`),A.attr(`transform`,`translate(0,${p?u.height/2+C/2:-u.height/2-C/2})`),V(t,j),t.intersect=function(e){if(y.info(`iconSquare intersect`,t,e),!t.label)return X.rect(t,e);let n=t.x??0,r=t.y??0,i=t.height??0,a=[];return a=p?[{x:n-u.width/2,y:r-i/2},{x:n+u.width/2,y:r-i/2},{x:n+u.width/2,y:r-i/2+u.height+C},{x:n+h/2,y:r-i/2+u.height+C},{x:n+h/2,y:r+i/2},{x:n-h/2,y:r+i/2},{x:n-h/2,y:r-i/2+u.height+C},{x:n-u.width/2,y:r-i/2+u.height+C}]:[{x:n-h/2,y:r-i/2},{x:n+h/2,y:r-i/2},{x:n+h/2,y:r-i/2+m},{x:n+u.width/2,y:r-i/2+m},{x:n+u.width/2/2,y:r+i/2},{x:n-u.width/2,y:r+i/2},{x:n-u.width/2,y:r-i/2+m},{x:n-h/2,y:r-i/2+m}],X.polygon(t,a,e)},l}P(rn,`iconSquare`);async function an(e,t,{config:{flowchart:n}}){let r=new Image;r.src=t?.img??``,await r.decode();let i=Number(r.naturalWidth.toString().replace(`px`,``)),a=Number(r.naturalHeight.toString().replace(`px`,``));t.imageAspectRatio=i/a;let{labelStyles:o}=R(t);t.labelStyle=o;let s=n?.wrappingWidth;t.defaultWidth=n?.wrappingWidth;let c=Math.max(t.label?s??0:0,t?.assetWidth??i),l=t.constraint===`on`&&t?.assetHeight?t.assetHeight*t.imageAspectRatio:c,u=t.constraint===`on`?l/t.imageAspectRatio:t?.assetHeight??a;t.width=Math.max(l,s??0);let{shapeSvg:d,bbox:f,label:p}=await B(e,t,`image-shape default`),m=t.pos===`t`,h=-l/2,g=-u/2,_=t.label?8:0,v=Y.svg(d),b=z(t,{});t.look!==`handDrawn`&&(b.roughness=0,b.fillStyle=`solid`);let x=v.rectangle(h,g,l,u,b),S=Math.max(l,f.width),C=u+f.height+_,w=v.rectangle(-S/2,-C/2,S,C,{...b,fill:`none`,stroke:`none`}),T=d.insert(()=>x,`:first-child`),E=d.insert(()=>w);if(t.img){let e=d.append(`image`);e.attr(`href`,t.img),e.attr(`width`,l),e.attr(`height`,u),e.attr(`preserveAspectRatio`,`none`),e.attr(`transform`,`translate(${-l/2},${m?C/2-u:-C/2})`)}return p.attr(`transform`,`translate(${-f.width/2-(f.x-(f.left??0))},${m?-u/2-f.height/2-_/2:u/2-f.height/2+_/2})`),T.attr(`transform`,`translate(0,${m?f.height/2+_/2:-f.height/2-_/2})`),V(t,E),t.intersect=function(e){if(y.info(`iconSquare intersect`,t,e),!t.label)return X.rect(t,e);let n=t.x??0,r=t.y??0,i=t.height??0,a=[];return a=m?[{x:n-f.width/2,y:r-i/2},{x:n+f.width/2,y:r-i/2},{x:n+f.width/2,y:r-i/2+f.height+_},{x:n+l/2,y:r-i/2+f.height+_},{x:n+l/2,y:r+i/2},{x:n-l/2,y:r+i/2},{x:n-l/2,y:r-i/2+f.height+_},{x:n-f.width/2,y:r-i/2+f.height+_}]:[{x:n-l/2,y:r-i/2},{x:n+l/2,y:r-i/2},{x:n+l/2,y:r-i/2+u},{x:n+f.width/2,y:r-i/2+u},{x:n+f.width/2/2,y:r+i/2},{x:n-f.width/2,y:r+i/2},{x:n-f.width/2,y:r-i/2+u},{x:n-l/2,y:r-i/2+u}],X.polygon(t,a,e)},d}P(an,`imageSquare`);async function on(e,t){let{labelStyles:n,nodeStyles:r}=R(t);t.labelStyle=n;let{shapeSvg:i,bbox:a}=await B(e,t,H(t)),o=Math.max(a.width+(t.padding??0)*2,t?.width??0),s=Math.max(a.height+(t.padding??0)*2,t?.height??0),c=[{x:0,y:0},{x:o,y:0},{x:o+3*s/6,y:-s},{x:-3*s/6,y:-s}],l,{cssStyles:u}=t;if(t.look===`handDrawn`){let e=Y.svg(i),n=z(t,{}),r=U(c),a=e.path(r,n);l=i.insert(()=>a,`:first-child`).attr(`transform`,`translate(${-o/2}, ${s/2})`),u&&l.attr(`style`,u)}else l=At(i,o,s,c);return r&&l.attr(`style`,r),t.width=o,t.height=s,V(t,l),t.intersect=function(e){return X.polygon(t,c,e)},i}P(on,`inv_trapezoid`);async function sn(e,t,n){let{labelStyles:r,nodeStyles:i}=R(t);t.labelStyle=r;let{shapeSvg:a,bbox:o}=await B(e,t,H(t)),s=Math.max(o.width+n.labelPaddingX*2,t?.width||0),c=Math.max(o.height+n.labelPaddingY*2,t?.height||0),l=-s/2,u=-c/2,d,{rx:f,ry:p}=t,{cssStyles:m}=t;if(n?.rx&&n.ry&&(f=n.rx,p=n.ry),t.look===`handDrawn`){let e=Y.svg(a),n=z(t,{}),r=f||p?e.path(dt(l,u,s,c,f||0),n):e.rectangle(l,u,s,c,n);d=a.insert(()=>r,`:first-child`),d.attr(`class`,`basic label-container`).attr(`style`,k(m))}else d=a.insert(`rect`,`:first-child`),d.attr(`class`,`basic label-container`).attr(`style`,i).attr(`rx`,k(f)).attr(`ry`,k(p)).attr(`x`,l).attr(`y`,u).attr(`width`,s).attr(`height`,c);return V(t,d),t.calcIntersect=function(e,t){return X.rect(e,t)},t.intersect=function(e){return X.rect(t,e)},a}P(sn,`drawRect`);async function cn(e,t){let{shapeSvg:n,bbox:r,label:i}=await B(e,t,`label`),a=n.insert(`rect`,`:first-child`);return a.attr(`width`,.1).attr(`height`,.1),n.attr(`class`,`label edgeLabel`),i.attr(`transform`,`translate(${-(r.width/2)-(r.x-(r.left??0))}, ${-(r.height/2)-(r.y-(r.top??0))})`),V(t,a),t.intersect=function(e){return X.rect(t,e)},n}P(cn,`labelRect`);async function ln(e,t){let{labelStyles:n,nodeStyles:r}=R(t);t.labelStyle=n;let{shapeSvg:i,bbox:a}=await B(e,t,H(t)),o=Math.max(a.width+(t.padding??0),t?.width??0),s=Math.max(a.height+(t.padding??0),t?.height??0),c=[{x:0,y:0},{x:o+3*s/6,y:0},{x:o,y:-s},{x:-(3*s)/6,y:-s}],l,{cssStyles:u}=t;if(t.look===`handDrawn`){let e=Y.svg(i),n=z(t,{}),r=U(c),a=e.path(r,n);l=i.insert(()=>a,`:first-child`).attr(`transform`,`translate(${-o/2}, ${s/2})`),u&&l.attr(`style`,u)}else l=At(i,o,s,c);return r&&l.attr(`style`,r),t.width=o,t.height=s,V(t,l),t.intersect=function(e){return X.polygon(t,c,e)},i}P(ln,`lean_left`);async function un(e,t){let{labelStyles:n,nodeStyles:r}=R(t);t.labelStyle=n;let{shapeSvg:i,bbox:a}=await B(e,t,H(t)),o=Math.max(a.width+(t.padding??0),t?.width??0),s=Math.max(a.height+(t.padding??0),t?.height??0),c=[{x:-3*s/6,y:0},{x:o,y:0},{x:o+3*s/6,y:-s},{x:0,y:-s}],l,{cssStyles:u}=t;if(t.look===`handDrawn`){let e=Y.svg(i),n=z(t,{}),r=U(c),a=e.path(r,n);l=i.insert(()=>a,`:first-child`).attr(`transform`,`translate(${-o/2}, ${s/2})`),u&&l.attr(`style`,u)}else l=At(i,o,s,c);return r&&l.attr(`style`,r),t.width=o,t.height=s,V(t,l),t.intersect=function(e){return X.polygon(t,c,e)},i}P(un,`lean_right`);function dn(e,t){let{labelStyles:n,nodeStyles:r}=R(t);t.label=``,t.labelStyle=n;let i=e.insert(`g`).attr(`class`,H(t)).attr(`id`,t.domId??t.id),{cssStyles:a}=t,o=Math.max(35,t?.width??0),s=Math.max(35,t?.height??0),c=[{x:o,y:0},{x:0,y:s+7/2},{x:o-14,y:s+7/2},{x:0,y:2*s},{x:o,y:s-7/2},{x:14,y:s-7/2}],l=Y.svg(i),u=z(t,{});t.look!==`handDrawn`&&(u.roughness=0,u.fillStyle=`solid`);let d=U(c),f=l.path(d,u),p=i.insert(()=>f,`:first-child`);return a&&t.look!==`handDrawn`&&p.selectAll(`path`).attr(`style`,a),r&&t.look!==`handDrawn`&&p.selectAll(`path`).attr(`style`,r),p.attr(`transform`,`translate(-${o/2},${-s})`),V(t,p),t.intersect=function(e){return y.info(`lightningBolt intersect`,t,e),X.polygon(t,c,e)},i}P(dn,`lightningBolt`);var fn=P((e,t,n,r,i,a,o)=>[`M${e},${t+a}`,`a${i},${a} 0,0,0 ${n},0`,`a${i},${a} 0,0,0 ${-n},0`,`l0,${r}`,`a${i},${a} 0,0,0 ${n},0`,`l0,${-r}`,`M${e},${t+a+o}`,`a${i},${a} 0,0,0 ${n},0`].join(` `),`createCylinderPathD`),pn=P((e,t,n,r,i,a,o)=>[`M${e},${t+a}`,`M${e+n},${t+a}`,`a${i},${a} 0,0,0 ${-n},0`,`l0,${r}`,`a${i},${a} 0,0,0 ${n},0`,`l0,${-r}`,`M${e},${t+a+o}`,`a${i},${a} 0,0,0 ${n},0`].join(` `),`createOuterCylinderPathD`),mn=P((e,t,n,r,i,a)=>[`M${e-n/2},${-r/2}`,`a${i},${a} 0,0,0 ${n},0`].join(` `),`createInnerCylinderPathD`);async function hn(e,t){let{labelStyles:n,nodeStyles:r}=R(t);t.labelStyle=n;let{shapeSvg:i,bbox:a,label:o}=await B(e,t,H(t)),s=Math.max(a.width+(t.padding??0),t.width??0),c=s/2,l=c/(2.5+s/50),u=Math.max(a.height+l+(t.padding??0),t.height??0),d=u*.1,f,{cssStyles:p}=t;if(t.look===`handDrawn`){let e=Y.svg(i),n=pn(0,0,s,u,c,l,d),r=mn(0,l,s,u,c,l),a=z(t,{}),o=e.path(n,a),m=e.path(r,a);i.insert(()=>m,`:first-child`).attr(`class`,`line`),f=i.insert(()=>o,`:first-child`),f.attr(`class`,`basic label-container`),p&&f.attr(`style`,p)}else{let e=fn(0,0,s,u,c,l,d);f=i.insert(`path`,`:first-child`).attr(`d`,e).attr(`class`,`basic label-container`).attr(`style`,k(p)).attr(`style`,r)}return f.attr(`label-offset-y`,l),f.attr(`transform`,`translate(${-s/2}, ${-(u/2+l)})`),V(t,f),o.attr(`transform`,`translate(${-(a.width/2)-(a.x-(a.left??0))}, ${-(a.height/2)+l-(a.y-(a.top??0))})`),t.intersect=function(e){let n=X.rect(t,e),r=n.x-(t.x??0);if(c!=0&&(Math.abs(r)<(t.width??0)/2||Math.abs(r)==(t.width??0)/2&&Math.abs(n.y-(t.y??0))>(t.height??0)/2-l)){let i=l*l*(1-r*r/(c*c));i>0&&(i=Math.sqrt(i)),i=l-i,e.y-(t.y??0)>0&&(i=-i),n.y+=i}return n},i}P(hn,`linedCylinder`);async function gn(e,t){let{labelStyles:n,nodeStyles:r}=R(t);t.labelStyle=n;let{shapeSvg:i,bbox:a,label:o}=await B(e,t,H(t)),s=Math.max(a.width+(t.padding??0)*2,t?.width??0),c=Math.max(a.height+(t.padding??0)*2,t?.height??0),l=c/4,u=c+l,{cssStyles:d}=t,f=Y.svg(i),p=z(t,{});t.look!==`handDrawn`&&(p.roughness=0,p.fillStyle=`solid`);let m=[{x:-s/2-s/2*.1,y:-u/2},{x:-s/2-s/2*.1,y:u/2},...W(-s/2-s/2*.1,u/2,s/2+s/2*.1,u/2,l,.8),{x:s/2+s/2*.1,y:-u/2},{x:-s/2-s/2*.1,y:-u/2},{x:-s/2,y:-u/2},{x:-s/2,y:u/2*1.1},{x:-s/2,y:-u/2}],h=f.polygon(m.map(e=>[e.x,e.y]),p),g=i.insert(()=>h,`:first-child`);return g.attr(`class`,`basic label-container`),d&&t.look!==`handDrawn`&&g.selectAll(`path`).attr(`style`,d),r&&t.look!==`handDrawn`&&g.selectAll(`path`).attr(`style`,r),g.attr(`transform`,`translate(0,${-l/2})`),o.attr(`transform`,`translate(${-s/2+(t.padding??0)+s/2*.1/2-(a.x-(a.left??0))},${-c/2+(t.padding??0)-l/2-(a.y-(a.top??0))})`),V(t,g),t.intersect=function(e){return X.polygon(t,m,e)},i}P(gn,`linedWaveEdgedRect`);async function _n(e,t){let{labelStyles:n,nodeStyles:r}=R(t);t.labelStyle=n;let{shapeSvg:i,bbox:a,label:o}=await B(e,t,H(t)),s=Math.max(a.width+(t.padding??0)*2,t?.width??0),c=Math.max(a.height+(t.padding??0)*2,t?.height??0),l=-s/2,u=-c/2,{cssStyles:d}=t,f=Y.svg(i),p=z(t,{}),m=[{x:l-5,y:u+5},{x:l-5,y:u+c+5},{x:l+s-5,y:u+c+5},{x:l+s-5,y:u+c},{x:l+s,y:u+c},{x:l+s,y:u+c-5},{x:l+s+5,y:u+c-5},{x:l+s+5,y:u-5},{x:l+5,y:u-5},{x:l+5,y:u},{x:l,y:u},{x:l,y:u+5}],h=[{x:l,y:u+5},{x:l+s-5,y:u+5},{x:l+s-5,y:u+c},{x:l+s,y:u+c},{x:l+s,y:u},{x:l,y:u}];t.look!==`handDrawn`&&(p.roughness=0,p.fillStyle=`solid`);let g=U(m),_=f.path(g,p),v=U(h),y=f.path(v,{...p,fill:`none`}),b=i.insert(()=>y,`:first-child`);return b.insert(()=>_,`:first-child`),b.attr(`class`,`basic label-container`),d&&t.look!==`handDrawn`&&b.selectAll(`path`).attr(`style`,d),r&&t.look!==`handDrawn`&&b.selectAll(`path`).attr(`style`,r),o.attr(`transform`,`translate(${-(a.width/2)-5-(a.x-(a.left??0))}, ${-(a.height/2)+5-(a.y-(a.top??0))})`),V(t,b),t.intersect=function(e){return X.polygon(t,m,e)},i}P(_n,`multiRect`);async function vn(e,t){let{labelStyles:n,nodeStyles:r}=R(t);t.labelStyle=n;let{shapeSvg:i,bbox:a,label:o}=await B(e,t,H(t)),s=Math.max(a.width+(t.padding??0)*2,t?.width??0),c=Math.max(a.height+(t.padding??0)*2,t?.height??0),l=c/4,u=c+l,d=-s/2,f=-u/2,{cssStyles:p}=t,m=W(d-5,f+u+5,d+s-5,f+u+5,l,.8),h=m?.[m.length-1],g=[{x:d-5,y:f+5},{x:d-5,y:f+u+5},...m,{x:d+s-5,y:h.y-5},{x:d+s,y:h.y-5},{x:d+s,y:h.y-10},{x:d+s+5,y:h.y-10},{x:d+s+5,y:f-5},{x:d+5,y:f-5},{x:d+5,y:f},{x:d,y:f},{x:d,y:f+5}],_=[{x:d,y:f+5},{x:d+s-5,y:f+5},{x:d+s-5,y:h.y-5},{x:d+s,y:h.y-5},{x:d+s,y:f},{x:d,y:f}],v=Y.svg(i),y=z(t,{});t.look!==`handDrawn`&&(y.roughness=0,y.fillStyle=`solid`);let b=U(g),x=v.path(b,y),S=U(_),C=v.path(S,y),w=i.insert(()=>x,`:first-child`);return w.insert(()=>C),w.attr(`class`,`basic label-container`),p&&t.look!==`handDrawn`&&w.selectAll(`path`).attr(`style`,p),r&&t.look!==`handDrawn`&&w.selectAll(`path`).attr(`style`,r),w.attr(`transform`,`translate(0,${-l/2})`),o.attr(`transform`,`translate(${-(a.width/2)-5-(a.x-(a.left??0))}, ${-(a.height/2)+5-l/2-(a.y-(a.top??0))})`),V(t,w),t.intersect=function(e){return X.polygon(t,g,e)},i}P(vn,`multiWaveEdgedRectangle`);async function yn(e,t,{config:{themeVariables:n}}){let{labelStyles:r,nodeStyles:i}=R(t);t.labelStyle=r,t.useHtmlLabels||T().flowchart?.htmlLabels!==!1||(t.centerLabel=!0);let{shapeSvg:a,bbox:o,label:s}=await B(e,t,H(t)),c=Math.max(o.width+(t.padding??0)*2,t?.width??0),l=Math.max(o.height+(t.padding??0)*2,t?.height??0),u=-c/2,d=-l/2,{cssStyles:f}=t,p=Y.svg(a),m=z(t,{fill:n.noteBkgColor,stroke:n.noteBorderColor});t.look!==`handDrawn`&&(m.roughness=0,m.fillStyle=`solid`);let h=p.rectangle(u,d,c,l,m),g=a.insert(()=>h,`:first-child`);return g.attr(`class`,`basic label-container`),f&&t.look!==`handDrawn`&&g.selectAll(`path`).attr(`style`,f),i&&t.look!==`handDrawn`&&g.selectAll(`path`).attr(`style`,i),s.attr(`transform`,`translate(${-o.width/2-(o.x-(o.left??0))}, ${-(o.height/2)-(o.y-(o.top??0))})`),V(t,g),t.intersect=function(e){return X.rect(t,e)},a}P(yn,`note`);var bn=P((e,t,n)=>[`M${e+n/2},${t}`,`L${e+n},${t-n/2}`,`L${e+n/2},${t-n}`,`L${e},${t-n/2}`,`Z`].join(` `),`createDecisionBoxPathD`);async function xn(e,t){let{labelStyles:n,nodeStyles:r}=R(t);t.labelStyle=n;let{shapeSvg:i,bbox:a}=await B(e,t,H(t)),o=a.width+t.padding+(a.height+t.padding),s=.5,c=[{x:o/2,y:0},{x:o,y:-o/2},{x:o/2,y:-o},{x:0,y:-o/2}],l,{cssStyles:u}=t;if(t.look===`handDrawn`){let e=Y.svg(i),n=z(t,{}),r=bn(0,0,o),a=e.path(r,n);l=i.insert(()=>a,`:first-child`).attr(`transform`,`translate(${-o/2+s}, ${o/2})`),u&&l.attr(`style`,u)}else l=At(i,o,o,c),l.attr(`transform`,`translate(${-o/2+s}, ${o/2})`);return r&&l.attr(`style`,r),V(t,l),t.calcIntersect=function(e,t){let n=e.width,r=[{x:n/2,y:0},{x:n,y:-n/2},{x:n/2,y:-n},{x:0,y:-n/2}],i=X.polygon(e,r,t);return{x:i.x-.5,y:i.y-.5}},t.intersect=function(e){return this.calcIntersect(t,e)},i}P(xn,`question`);async function Sn(e,t){let{labelStyles:n,nodeStyles:r}=R(t);t.labelStyle=n;let{shapeSvg:i,bbox:a,label:o}=await B(e,t,H(t)),s=Math.max(a.width+(t.padding??0),t?.width??0),c=Math.max(a.height+(t.padding??0),t?.height??0),l=-s/2,u=-c/2,d=u/2,f=[{x:l+d,y:u},{x:l,y:0},{x:l+d,y:-u},{x:-l,y:-u},{x:-l,y:u}],{cssStyles:p}=t,m=Y.svg(i),h=z(t,{});t.look!==`handDrawn`&&(h.roughness=0,h.fillStyle=`solid`);let g=U(f),_=m.path(g,h),v=i.insert(()=>_,`:first-child`);return v.attr(`class`,`basic label-container`),p&&t.look!==`handDrawn`&&v.selectAll(`path`).attr(`style`,p),r&&t.look!==`handDrawn`&&v.selectAll(`path`).attr(`style`,r),v.attr(`transform`,`translate(${-d/2},0)`),o.attr(`transform`,`translate(${-d/2-a.width/2-(a.x-(a.left??0))}, ${-(a.height/2)-(a.y-(a.top??0))})`),V(t,v),t.intersect=function(e){return X.polygon(t,f,e)},i}P(Sn,`rect_left_inv_arrow`);async function Cn(e,t){let{labelStyles:r,nodeStyles:i}=R(t);t.labelStyle=r;let a;a=t.cssClasses?`node `+t.cssClasses:`node default`;let o=e.insert(`g`).attr(`class`,a).attr(`id`,t.domId||t.id),s=o.insert(`g`),c=o.insert(`g`).attr(`class`,`label`).attr(`style`,i),l=t.description,u=t.label,d=c.node().appendChild(await ut(u,t.labelStyle,!0,!0)),f={width:0,height:0};if(n(_()?.flowchart?.htmlLabels)){let e=d.children[0],t=C(d);f=e.getBoundingClientRect(),t.attr(`width`,f.width),t.attr(`height`,f.height)}y.info(`Text 2`,l);let p=l||[],m=d.getBBox(),h=c.node().appendChild(await ut(p.join?p.join(`<br/>`):p,t.labelStyle,!0,!0)),g=h.children[0],v=C(h);f=g.getBoundingClientRect(),v.attr(`width`,f.width),v.attr(`height`,f.height);let b=(t.padding||0)/2;C(h).attr(`transform`,`translate( `+(f.width>m.width?0:(m.width-f.width)/2)+`, `+(m.height+b+5)+`)`),C(d).attr(`transform`,`translate( `+(f.width<m.width?0:-(m.width-f.width)/2)+`, 0)`),f=c.node().getBBox(),c.attr(`transform`,`translate(`+-f.width/2+`, `+(-f.height/2-b+3)+`)`);let x=f.width+(t.padding||0),S=f.height+(t.padding||0),w=-f.width/2-b,T=-f.height/2-b,E,D;if(t.look===`handDrawn`){let e=Y.svg(o),n=z(t,{}),r=e.path(dt(w,T,x,S,t.rx||0),n),i=e.line(-f.width/2-b,-f.height/2-b+m.height+b,f.width/2+b,-f.height/2-b+m.height+b,n);D=o.insert(()=>(y.debug(`Rough node insert CXC`,r),i),`:first-child`),E=o.insert(()=>(y.debug(`Rough node insert CXC`,r),r),`:first-child`)}else E=s.insert(`rect`,`:first-child`),D=s.insert(`line`),E.attr(`class`,`outer title-state`).attr(`style`,i).attr(`x`,-f.width/2-b).attr(`y`,-f.height/2-b).attr(`width`,f.width+(t.padding||0)).attr(`height`,f.height+(t.padding||0)),D.attr(`class`,`divider`).attr(`x1`,-f.width/2-b).attr(`x2`,f.width/2+b).attr(`y1`,-f.height/2-b+m.height+b).attr(`y2`,-f.height/2-b+m.height+b);return V(t,E),t.intersect=function(e){return X.rect(t,e)},o}P(Cn,`rectWithTitle`);function wn(e,t,n,r,i,a,o){let s=(e+n)/2,c=(t+r)/2,l=Math.atan2(r-t,n-e),u=(n-e)/2,d=(r-t)/2,f=u/i,p=d/a,m=Math.sqrt(f**2+p**2);if(m>1)throw Error(`The given radii are too small to create an arc between the points.`);let h=Math.sqrt(1-m**2),g=s+h*a*Math.sin(l)*(o?-1:1),_=c-h*i*Math.cos(l)*(o?-1:1),v=Math.atan2((t-_)/a,(e-g)/i),y=Math.atan2((r-_)/a,(n-g)/i)-v;o&&y<0&&(y+=2*Math.PI),!o&&y>0&&(y-=2*Math.PI);let b=[];for(let e=0;e<20;e++){let t=v+e/19*y,n=g+i*Math.cos(t),r=_+a*Math.sin(t);b.push({x:n,y:r})}return b}P(wn,`generateArcPoints`);async function Tn(e,t){let{labelStyles:n,nodeStyles:r}=R(t);t.labelStyle=n;let{shapeSvg:i,bbox:a}=await B(e,t,H(t)),o=t?.padding??0,s=t?.padding??0,c=(t?.width?t?.width:a.width)+o*2,l=(t?.height?t?.height:a.height)+s*2,u=t.radius||5,d=t.taper||5,{cssStyles:f}=t,p=Y.svg(i),m=z(t,{});t.stroke&&(m.stroke=t.stroke),t.look!==`handDrawn`&&(m.roughness=0,m.fillStyle=`solid`);let h=[{x:-c/2+d,y:-l/2},{x:c/2-d,y:-l/2},...wn(c/2-d,-l/2,c/2,-l/2+d,u,u,!0),{x:c/2,y:-l/2+d},{x:c/2,y:l/2-d},...wn(c/2,l/2-d,c/2-d,l/2,u,u,!0),{x:c/2-d,y:l/2},{x:-c/2+d,y:l/2},...wn(-c/2+d,l/2,-c/2,l/2-d,u,u,!0),{x:-c/2,y:l/2-d},{x:-c/2,y:-l/2+d},...wn(-c/2,-l/2+d,-c/2+d,-l/2,u,u,!0)],g=U(h),_=p.path(g,m),v=i.insert(()=>_,`:first-child`);return v.attr(`class`,`basic label-container outer-path`),f&&t.look!==`handDrawn`&&v.selectChildren(`path`).attr(`style`,f),r&&t.look!==`handDrawn`&&v.selectChildren(`path`).attr(`style`,r),V(t,v),t.intersect=function(e){return X.polygon(t,h,e)},i}P(Tn,`roundedRect`);async function En(e,t){let{labelStyles:n,nodeStyles:r}=R(t);t.labelStyle=n;let{shapeSvg:i,bbox:a,label:o}=await B(e,t,H(t)),s=t?.padding??0,c=Math.max(a.width+(t.padding??0)*2,t?.width??0),l=Math.max(a.height+(t.padding??0)*2,t?.height??0),u=-a.width/2-s,d=-a.height/2-s,{cssStyles:f}=t,p=Y.svg(i),m=z(t,{});t.look!==`handDrawn`&&(m.roughness=0,m.fillStyle=`solid`);let h=[{x:u,y:d},{x:u+c+8,y:d},{x:u+c+8,y:d+l},{x:u-8,y:d+l},{x:u-8,y:d},{x:u,y:d},{x:u,y:d+l}],g=p.polygon(h.map(e=>[e.x,e.y]),m),_=i.insert(()=>g,`:first-child`);return _.attr(`class`,`basic label-container`).attr(`style`,k(f)),r&&t.look!==`handDrawn`&&_.selectAll(`path`).attr(`style`,r),f&&t.look!==`handDrawn`&&_.selectAll(`path`).attr(`style`,r),o.attr(`transform`,`translate(${-c/2+4+(t.padding??0)-(a.x-(a.left??0))},${-l/2+(t.padding??0)-(a.y-(a.top??0))})`),V(t,_),t.intersect=function(e){return X.rect(t,e)},i}P(En,`shadedProcess`);async function Dn(e,t){let{labelStyles:n,nodeStyles:r}=R(t);t.labelStyle=n;let{shapeSvg:i,bbox:a,label:o}=await B(e,t,H(t)),s=Math.max(a.width+(t.padding??0)*2,t?.width??0),c=Math.max(a.height+(t.padding??0)*2,t?.height??0),l=-s/2,u=-c/2,{cssStyles:d}=t,f=Y.svg(i),p=z(t,{});t.look!==`handDrawn`&&(p.roughness=0,p.fillStyle=`solid`);let m=[{x:l,y:u},{x:l,y:u+c},{x:l+s,y:u+c},{x:l+s,y:u-c/2}],h=U(m),g=f.path(h,p),_=i.insert(()=>g,`:first-child`);return _.attr(`class`,`basic label-container`),d&&t.look!==`handDrawn`&&_.selectChildren(`path`).attr(`style`,d),r&&t.look!==`handDrawn`&&_.selectChildren(`path`).attr(`style`,r),_.attr(`transform`,`translate(0, ${c/4})`),o.attr(`transform`,`translate(${-s/2+(t.padding??0)-(a.x-(a.left??0))}, ${-c/4+(t.padding??0)-(a.y-(a.top??0))})`),V(t,_),t.intersect=function(e){return X.polygon(t,m,e)},i}P(Dn,`slopedRect`);async function On(e,t){return sn(e,t,{rx:0,ry:0,classes:``,labelPaddingX:t.labelPaddingX??(t?.padding||0)*2,labelPaddingY:(t?.padding||0)*1})}P(On,`squareRect`);async function kn(e,t){let{labelStyles:n,nodeStyles:r}=R(t);t.labelStyle=n;let{shapeSvg:i,bbox:a}=await B(e,t,H(t)),o=a.height+t.padding,s=a.width+o/4+t.padding,c=o/2,{cssStyles:l}=t,u=Y.svg(i),d=z(t,{});t.look!==`handDrawn`&&(d.roughness=0,d.fillStyle=`solid`);let f=[{x:-s/2+c,y:-o/2},{x:s/2-c,y:-o/2},...ae(-s/2+c,0,c,50,90,270),{x:s/2-c,y:o/2},...ae(s/2-c,0,c,50,270,450)],p=U(f),m=u.path(p,d),h=i.insert(()=>m,`:first-child`);return h.attr(`class`,`basic label-container outer-path`),l&&t.look!==`handDrawn`&&h.selectChildren(`path`).attr(`style`,l),r&&t.look!==`handDrawn`&&h.selectChildren(`path`).attr(`style`,r),V(t,h),t.intersect=function(e){return X.polygon(t,f,e)},i}P(kn,`stadium`);async function An(e,t){return sn(e,t,{rx:5,ry:5,classes:`flowchart-node`})}P(An,`state`);function jn(e,t,{config:{themeVariables:n}}){let{labelStyles:r,nodeStyles:i}=R(t);t.labelStyle=r;let{cssStyles:a}=t,{lineColor:o,stateBorder:s,nodeBorder:c}=n,l=e.insert(`g`).attr(`class`,`node default`).attr(`id`,t.domId||t.id),u=Y.svg(l),d=z(t,{});t.look!==`handDrawn`&&(d.roughness=0,d.fillStyle=`solid`);let f=u.circle(0,0,14,{...d,stroke:o,strokeWidth:2}),p=s??c,m=u.circle(0,0,5,{...d,fill:p,stroke:p,strokeWidth:2,fillStyle:`solid`}),h=l.insert(()=>f,`:first-child`);return h.insert(()=>m),a&&h.selectAll(`path`).attr(`style`,a),i&&h.selectAll(`path`).attr(`style`,i),V(t,h),t.intersect=function(e){return X.circle(t,7,e)},l}P(jn,`stateEnd`);function Mn(e,t,{config:{themeVariables:n}}){let{lineColor:r}=n,i=e.insert(`g`).attr(`class`,`node default`).attr(`id`,t.domId||t.id),a;if(t.look===`handDrawn`){let e=Y.svg(i).circle(0,0,14,F(r));a=i.insert(()=>e),a.attr(`class`,`state-start`).attr(`r`,7).attr(`width`,14).attr(`height`,14)}else a=i.insert(`circle`,`:first-child`),a.attr(`class`,`state-start`).attr(`r`,7).attr(`width`,14).attr(`height`,14);return V(t,a),t.intersect=function(e){return X.circle(t,7,e)},i}P(Mn,`stateStart`);async function Nn(e,t){let{labelStyles:n,nodeStyles:r}=R(t);t.labelStyle=n;let{shapeSvg:i,bbox:a}=await B(e,t,H(t)),o=(t?.padding||0)/2,s=a.width+t.padding,c=a.height+t.padding,l=-a.width/2-o,u=-a.height/2-o,d=[{x:0,y:0},{x:s,y:0},{x:s,y:-c},{x:0,y:-c},{x:0,y:0},{x:-8,y:0},{x:s+8,y:0},{x:s+8,y:-c},{x:-8,y:-c},{x:-8,y:0}];if(t.look===`handDrawn`){let e=Y.svg(i),n=z(t,{}),r=e.rectangle(l-8,u,s+16,c,n),a=e.line(l,u,l,u+c,n),o=e.line(l+s,u,l+s,u+c,n);i.insert(()=>a,`:first-child`),i.insert(()=>o,`:first-child`);let d=i.insert(()=>r,`:first-child`),{cssStyles:f}=t;d.attr(`class`,`basic label-container`).attr(`style`,k(f)),V(t,d)}else{let e=At(i,s,c,d);r&&e.attr(`style`,r),V(t,e)}return t.intersect=function(e){return X.polygon(t,d,e)},i}P(Nn,`subroutine`);async function Pn(e,t){let{labelStyles:n,nodeStyles:r}=R(t);t.labelStyle=n;let{shapeSvg:i,bbox:a}=await B(e,t,H(t)),o=Math.max(a.width+(t.padding??0)*2,t?.width??0),s=Math.max(a.height+(t.padding??0)*2,t?.height??0),c=-o/2,l=-s/2,u=.2*s,d=.2*s,{cssStyles:f}=t,p=Y.svg(i),m=z(t,{}),h=[{x:c-u/2,y:l},{x:c+o+u/2,y:l},{x:c+o+u/2,y:l+s},{x:c-u/2,y:l+s}],g=[{x:c+o-u/2,y:l+s},{x:c+o+u/2,y:l+s},{x:c+o+u/2,y:l+s-d}];t.look!==`handDrawn`&&(m.roughness=0,m.fillStyle=`solid`);let _=U(h),v=p.path(_,m),y=U(g),b=p.path(y,{...m,fillStyle:`solid`}),x=i.insert(()=>b,`:first-child`);return x.insert(()=>v,`:first-child`),x.attr(`class`,`basic label-container`),f&&t.look!==`handDrawn`&&x.selectAll(`path`).attr(`style`,f),r&&t.look!==`handDrawn`&&x.selectAll(`path`).attr(`style`,r),V(t,x),t.intersect=function(e){return X.polygon(t,h,e)},i}P(Pn,`taggedRect`);async function Fn(e,t){let{labelStyles:n,nodeStyles:r}=R(t);t.labelStyle=n;let{shapeSvg:i,bbox:a,label:o}=await B(e,t,H(t)),s=Math.max(a.width+(t.padding??0)*2,t?.width??0),c=Math.max(a.height+(t.padding??0)*2,t?.height??0),l=c/4,u=.2*s,d=.2*c,f=c+l,{cssStyles:p}=t,m=Y.svg(i),h=z(t,{});t.look!==`handDrawn`&&(h.roughness=0,h.fillStyle=`solid`);let g=[{x:-s/2-s/2*.1,y:f/2},...W(-s/2-s/2*.1,f/2,s/2+s/2*.1,f/2,l,.8),{x:s/2+s/2*.1,y:-f/2},{x:-s/2-s/2*.1,y:-f/2}],_=-s/2+s/2*.1,v=-f/2-d*.4,y=[{x:_+s-u,y:(v+c)*1.4},{x:_+s,y:v+c-d},{x:_+s,y:(v+c)*.9},...W(_+s,(v+c)*1.3,_+s-u,(v+c)*1.5,-c*.03,.5)],b=U(g),x=m.path(b,h),S=U(y),C=m.path(S,{...h,fillStyle:`solid`}),w=i.insert(()=>C,`:first-child`);return w.insert(()=>x,`:first-child`),w.attr(`class`,`basic label-container`),p&&t.look!==`handDrawn`&&w.selectAll(`path`).attr(`style`,p),r&&t.look!==`handDrawn`&&w.selectAll(`path`).attr(`style`,r),w.attr(`transform`,`translate(0,${-l/2})`),o.attr(`transform`,`translate(${-s/2+(t.padding??0)-(a.x-(a.left??0))},${-c/2+(t.padding??0)-l/2-(a.y-(a.top??0))})`),V(t,w),t.intersect=function(e){return X.polygon(t,g,e)},i}P(Fn,`taggedWaveEdgedRectangle`);async function In(e,t){let{labelStyles:n,nodeStyles:r}=R(t);t.labelStyle=n;let{shapeSvg:i,bbox:a}=await B(e,t,H(t)),o=Math.max(a.width+t.padding,t?.width||0),s=Math.max(a.height+t.padding,t?.height||0),c=-o/2,l=-s/2,u=i.insert(`rect`,`:first-child`);return u.attr(`class`,`text`).attr(`style`,r).attr(`rx`,0).attr(`ry`,0).attr(`x`,c).attr(`y`,l).attr(`width`,o).attr(`height`,s),V(t,u),t.intersect=function(e){return X.rect(t,e)},i}P(In,`text`);var Ln=P((e,t,n,r,i,a)=>`M${e},${t}
    a${i},${a} 0,0,1 0,${-r}
    l${n},0
    a${i},${a} 0,0,1 0,${r}
    M${n},${-r}
    a${i},${a} 0,0,0 0,${r}
    l${-n},0`,`createCylinderPathD`),Rn=P((e,t,n,r,i,a)=>[`M${e},${t}`,`M${e+n},${t}`,`a${i},${a} 0,0,0 0,${-r}`,`l${-n},0`,`a${i},${a} 0,0,0 0,${r}`,`l${n},0`].join(` `),`createOuterCylinderPathD`),zn=P((e,t,n,r,i,a)=>[`M${e+n/2},${-r/2}`,`a${i},${a} 0,0,0 0,${r}`].join(` `),`createInnerCylinderPathD`);async function Bn(e,t){let{labelStyles:n,nodeStyles:r}=R(t);t.labelStyle=n;let{shapeSvg:i,bbox:a,label:o,halfPadding:s}=await B(e,t,H(t)),c=t.look===`neo`?s*2:s,l=a.height+c,u=l/2,d=u/(2.5+l/50),f=a.width+d+c,{cssStyles:p}=t,m;if(t.look===`handDrawn`){let e=Y.svg(i),n=Rn(0,0,f,l,d,u),r=zn(0,0,f,l,d,u),a=e.path(n,z(t,{})),o=e.path(r,z(t,{fill:`none`}));m=i.insert(()=>o,`:first-child`),m=i.insert(()=>a,`:first-child`),m.attr(`class`,`basic label-container`),p&&m.attr(`style`,p)}else{let e=Ln(0,0,f,l,d,u);m=i.insert(`path`,`:first-child`).attr(`d`,e).attr(`class`,`basic label-container`).attr(`style`,k(p)).attr(`style`,r),m.attr(`class`,`basic label-container`),p&&m.selectAll(`path`).attr(`style`,p),r&&m.selectAll(`path`).attr(`style`,r)}return m.attr(`label-offset-x`,d),m.attr(`transform`,`translate(${-f/2}, ${l/2} )`),o.attr(`transform`,`translate(${-(a.width/2)-d-(a.x-(a.left??0))}, ${-(a.height/2)-(a.y-(a.top??0))})`),V(t,m),t.intersect=function(e){let n=X.rect(t,e),r=n.y-(t.y??0);if(u!=0&&(Math.abs(r)<(t.height??0)/2||Math.abs(r)==(t.height??0)/2&&Math.abs(n.x-(t.x??0))>(t.width??0)/2-d)){let i=d*d*(1-r*r/(u*u));i!=0&&(i=Math.sqrt(Math.abs(i))),i=d-i,e.x-(t.x??0)>0&&(i=-i),n.x+=i}return n},i}P(Bn,`tiltedCylinder`);async function Vn(e,t){let{labelStyles:n,nodeStyles:r}=R(t);t.labelStyle=n;let{shapeSvg:i,bbox:a}=await B(e,t,H(t)),o=a.width+t.padding,s=a.height+t.padding,c=[{x:-3*s/6,y:0},{x:o+3*s/6,y:0},{x:o,y:-s},{x:0,y:-s}],l,{cssStyles:u}=t;if(t.look===`handDrawn`){let e=Y.svg(i),n=z(t,{}),r=U(c),a=e.path(r,n);l=i.insert(()=>a,`:first-child`).attr(`transform`,`translate(${-o/2}, ${s/2})`),u&&l.attr(`style`,u)}else l=At(i,o,s,c);return r&&l.attr(`style`,r),t.width=o,t.height=s,V(t,l),t.intersect=function(e){return X.polygon(t,c,e)},i}P(Vn,`trapezoid`);async function Hn(e,t){let{labelStyles:n,nodeStyles:r}=R(t);t.labelStyle=n;let{shapeSvg:i,bbox:a}=await B(e,t,H(t)),o=Math.max(60,a.width+(t.padding??0)*2,t?.width??0),s=Math.max(20,a.height+(t.padding??0)*2,t?.height??0),{cssStyles:c}=t,l=Y.svg(i),u=z(t,{});t.look!==`handDrawn`&&(u.roughness=0,u.fillStyle=`solid`);let d=[{x:-o/2*.8,y:-s/2},{x:o/2*.8,y:-s/2},{x:o/2,y:-s/2*.6},{x:o/2,y:s/2},{x:-o/2,y:s/2},{x:-o/2,y:-s/2*.6}],f=U(d),p=l.path(f,u),m=i.insert(()=>p,`:first-child`);return m.attr(`class`,`basic label-container`),c&&t.look!==`handDrawn`&&m.selectChildren(`path`).attr(`style`,c),r&&t.look!==`handDrawn`&&m.selectChildren(`path`).attr(`style`,r),V(t,m),t.intersect=function(e){return X.polygon(t,d,e)},i}P(Hn,`trapezoidalPentagon`);async function Un(e,t){let{labelStyles:r,nodeStyles:i}=R(t);t.labelStyle=r;let{shapeSvg:a,bbox:o,label:s}=await B(e,t,H(t)),c=n(_().flowchart?.htmlLabels),l=o.width+(t.padding??0),u=l+o.height,d=l+o.height,f=[{x:0,y:0},{x:d,y:0},{x:d/2,y:-u}],{cssStyles:p}=t,m=Y.svg(a),h=z(t,{});t.look!==`handDrawn`&&(h.roughness=0,h.fillStyle=`solid`);let g=U(f),v=m.path(g,h),b=a.insert(()=>v,`:first-child`).attr(`transform`,`translate(${-u/2}, ${u/2})`);return p&&t.look!==`handDrawn`&&b.selectChildren(`path`).attr(`style`,p),i&&t.look!==`handDrawn`&&b.selectChildren(`path`).attr(`style`,i),t.width=l,t.height=u,V(t,b),s.attr(`transform`,`translate(${-o.width/2-(o.x-(o.left??0))}, ${u/2-(o.height+(t.padding??0)/(c?2:1)-(o.y-(o.top??0)))})`),t.intersect=function(e){return y.info(`Triangle intersect`,t,f,e),X.polygon(t,f,e)},a}P(Un,`triangle`);async function Wn(e,t){let{labelStyles:n,nodeStyles:r}=R(t);t.labelStyle=n;let{shapeSvg:i,bbox:a,label:o}=await B(e,t,H(t)),s=Math.max(a.width+(t.padding??0)*2,t?.width??0),c=Math.max(a.height+(t.padding??0)*2,t?.height??0),l=c/8,u=c+l,{cssStyles:d}=t,f=70-s,p=f>0?f/2:0,m=Y.svg(i),h=z(t,{});t.look!==`handDrawn`&&(h.roughness=0,h.fillStyle=`solid`);let g=[{x:-s/2-p,y:u/2},...W(-s/2-p,u/2,s/2+p,u/2,l,.8),{x:s/2+p,y:-u/2},{x:-s/2-p,y:-u/2}],_=U(g),v=m.path(_,h),y=i.insert(()=>v,`:first-child`);return y.attr(`class`,`basic label-container`),d&&t.look!==`handDrawn`&&y.selectAll(`path`).attr(`style`,d),r&&t.look!==`handDrawn`&&y.selectAll(`path`).attr(`style`,r),y.attr(`transform`,`translate(0,${-l/2})`),o.attr(`transform`,`translate(${-s/2+(t.padding??0)-(a.x-(a.left??0))},${-c/2+(t.padding??0)-l-(a.y-(a.top??0))})`),V(t,y),t.intersect=function(e){return X.polygon(t,g,e)},i}P(Wn,`waveEdgedRectangle`);async function Gn(e,t){let{labelStyles:n,nodeStyles:r}=R(t);t.labelStyle=n;let{shapeSvg:i,bbox:a}=await B(e,t,H(t)),o=Math.max(a.width+(t.padding??0)*2,t?.width??0),s=Math.max(a.height+(t.padding??0)*2,t?.height??0),c=o/s,l=o,u=s;l>u*c?u=l/c:l=u*c,l=Math.max(l,100),u=Math.max(u,50);let d=Math.min(u*.2,u/4),f=u+d*2,{cssStyles:p}=t,m=Y.svg(i),h=z(t,{});t.look!==`handDrawn`&&(h.roughness=0,h.fillStyle=`solid`);let g=[{x:-l/2,y:f/2},...W(-l/2,f/2,l/2,f/2,d,1),{x:l/2,y:-f/2},...W(l/2,-f/2,-l/2,-f/2,d,-1)],_=U(g),v=m.path(_,h),y=i.insert(()=>v,`:first-child`);return y.attr(`class`,`basic label-container`),p&&t.look!==`handDrawn`&&y.selectAll(`path`).attr(`style`,p),r&&t.look!==`handDrawn`&&y.selectAll(`path`).attr(`style`,r),V(t,y),t.intersect=function(e){return X.polygon(t,g,e)},i}P(Gn,`waveRectangle`);async function Kn(e,t){let{labelStyles:n,nodeStyles:r}=R(t);t.labelStyle=n;let{shapeSvg:i,bbox:a,label:o}=await B(e,t,H(t)),s=Math.max(a.width+(t.padding??0)*2,t?.width??0),c=Math.max(a.height+(t.padding??0)*2,t?.height??0),l=-s/2,u=-c/2,{cssStyles:d}=t,f=Y.svg(i),p=z(t,{}),m=[{x:l-5,y:u-5},{x:l-5,y:u+c},{x:l+s,y:u+c},{x:l+s,y:u-5}],h=`M${l-5},${u-5} L${l+s},${u-5} L${l+s},${u+c} L${l-5},${u+c} L${l-5},${u-5}
                M${l-5},${u} L${l+s},${u}
                M${l},${u-5} L${l},${u+c}`;t.look!==`handDrawn`&&(p.roughness=0,p.fillStyle=`solid`);let g=f.path(h,p),_=i.insert(()=>g,`:first-child`);return _.attr(`transform`,`translate(${5/2}, ${5/2})`),_.attr(`class`,`basic label-container`),d&&t.look!==`handDrawn`&&_.selectAll(`path`).attr(`style`,d),r&&t.look!==`handDrawn`&&_.selectAll(`path`).attr(`style`,r),o.attr(`transform`,`translate(${-(a.width/2)+5/2-(a.x-(a.left??0))}, ${-(a.height/2)+5/2-(a.y-(a.top??0))})`),V(t,_),t.intersect=function(e){return X.polygon(t,m,e)},i}P(Kn,`windowPane`);async function qn(e,t){let r=t;if(r.alias&&(t.label=r.alias),t.look===`handDrawn`){let{themeVariables:n}=T(),{background:r}=n;await qn(e,{...t,id:t.id+`-background`,look:`default`,cssStyles:[`stroke: none`,`fill: ${r}`]})}let i=T();t.useHtmlLabels=i.htmlLabels;let a=i.er?.diagramPadding??10,o=i.er?.entityPadding??6,{cssStyles:s}=t,{labelStyles:c,nodeStyles:l}=R(t);if(r.attributes.length===0&&t.label){let r={rx:0,ry:0,labelPaddingX:a,labelPaddingY:a*1.5,classes:``};v(t.label,i)+r.labelPaddingX*2<i.er.minEntityWidth&&(t.width=i.er.minEntityWidth);let o=await sn(e,t,r);if(!n(i.htmlLabels)){let e=o.select(`text`),t=e.node()?.getBBox();e.attr(`transform`,`translate(${-t.width/2}, 0)`)}return o}i.htmlLabels||(a*=1.25,o*=1.25);let u=H(t);u||=`node default`;let d=e.insert(`g`).attr(`class`,u).attr(`id`,t.domId||t.id),f=await Jn(d,t.label??``,i,0,0,[`name`],c);f.height+=o;let p=0,m=[],h=[],g=0,_=0,y=0,b=0,x=!0,S=!0;for(let e of r.attributes){let t=await Jn(d,e.type,i,0,p,[`attribute-type`],c);g=Math.max(g,t.width+a);let n=await Jn(d,e.name,i,0,p,[`attribute-name`],c);_=Math.max(_,n.width+a);let r=await Jn(d,e.keys.join(),i,0,p,[`attribute-keys`],c);y=Math.max(y,r.width+a);let s=await Jn(d,e.comment,i,0,p,[`attribute-comment`],c);b=Math.max(b,s.width+a);let l=Math.max(t.height,n.height,r.height,s.height)+o;h.push({yOffset:p,rowHeight:l}),p+=l}let w=4;y<=a&&(x=!1,y=0,w--),b<=a&&(S=!1,b=0,w--);let E=d.node().getBBox();if(f.width+a*2-(g+_+y+b)>0){let e=f.width+a*2-(g+_+y+b);g+=e/w,_+=e/w,y>0&&(y+=e/w),b>0&&(b+=e/w)}let D=g+_+y+b,O=Y.svg(d),k=z(t,{});t.look!==`handDrawn`&&(k.roughness=0,k.fillStyle=`solid`);let A=0;h.length>0&&(A=h.reduce((e,t)=>e+(t?.rowHeight??0),0));let j=Math.max(E.width+a*2,t?.width||0,D),M=Math.max((A??0)+f.height,t?.height||0),N=-j/2,P=-M/2;d.selectAll(`g:not(:first-child)`).each((e,t,n)=>{let r=C(n[t]),i=r.attr(`transform`),s=0,c=0;if(i){let e=RegExp(/translate\(([^,]+),([^)]+)\)/).exec(i);e&&(s=parseFloat(e[1]),c=parseFloat(e[2]),r.attr(`class`).includes(`attribute-name`)?s+=g:r.attr(`class`).includes(`attribute-keys`)?s+=g+_:r.attr(`class`).includes(`attribute-comment`)&&(s+=g+_+y))}r.attr(`transform`,`translate(${N+a/2+s}, ${c+P+f.height+o/2})`)}),d.select(`.name`).attr(`transform`,`translate(`+-f.width/2+`, `+(P+o/2)+`)`);let ee=O.rectangle(N,P,j,M,k),te=d.insert(()=>ee,`:first-child`).attr(`style`,s.join(``)),{themeVariables:ne}=T(),{rowEven:re,rowOdd:F,nodeBorder:I}=ne;m.push(0);for(let[e,t]of h.entries()){let n=(e+1)%2==0&&t.yOffset!==0,r=O.rectangle(N,f.height+P+t?.yOffset,j,t?.rowHeight,{...k,fill:n?re:F,stroke:I});d.insert(()=>r,`g.label`).attr(`style`,s.join(``)).attr(`class`,`row-rect-${n?`even`:`odd`}`)}let L=O.line(N,f.height+P,j+N,f.height+P,k);d.insert(()=>L).attr(`class`,`divider`),L=O.line(g+N,f.height+P,g+N,M+P,k),d.insert(()=>L).attr(`class`,`divider`),x&&(L=O.line(g+_+N,f.height+P,g+_+N,M+P,k),d.insert(()=>L).attr(`class`,`divider`)),S&&(L=O.line(g+_+y+N,f.height+P,g+_+y+N,M+P,k),d.insert(()=>L).attr(`class`,`divider`));for(let e of m)L=O.line(N,f.height+P+e,j+N,f.height+P+e,k),d.insert(()=>L).attr(`class`,`divider`);if(V(t,te),l&&t.look!==`handDrawn`){let e=l.split(`;`)?.filter(e=>e.includes(`stroke`))?.map(e=>`${e}`).join(`; `);d.selectAll(`path`).attr(`style`,e??``),d.selectAll(`.row-rect-even path`).attr(`style`,l)}return t.intersect=function(e){return X.rect(t,e)},d}P(qn,`erBox`);async function Jn(e,t,r,i=0,a=0,o=[],s=``){let c=e.insert(`g`).attr(`class`,`label ${o.join(` `)}`).attr(`transform`,`translate(${i}, ${a})`).attr(`style`,s);t!==b(t)&&(t=b(t),t=t.replaceAll(`<`,`&lt;`).replaceAll(`>`,`&gt;`));let l=c.node().appendChild(await E(c,t,{width:v(t,r)+100,style:s,useHtmlLabels:r.htmlLabels},r));if(t.includes(`&lt;`)||t.includes(`&gt;`)){let e=l.children[0];for(e.textContent=e.textContent.replaceAll(`&lt;`,`<`).replaceAll(`&gt;`,`>`);e.childNodes[0];)e=e.childNodes[0],e.textContent=e.textContent.replaceAll(`&lt;`,`<`).replaceAll(`&gt;`,`>`)}let u=l.getBBox();if(n(r.htmlLabels)){let e=l.children[0];e.style.textAlign=`start`;let t=C(l);u=e.getBoundingClientRect(),t.attr(`width`,u.width),t.attr(`height`,u.height)}return u}P(Jn,`addText`);async function Yn(e,t,n,r,i=n.class.padding??12){let a=r?0:3,o=e.insert(`g`).attr(`class`,H(t)).attr(`id`,t.domId||t.id),s=null,c=null,l=null,u=null,d=0,f=0,p=0;if(s=o.insert(`g`).attr(`class`,`annotation-group text`),t.annotations.length>0){let e=t.annotations[0];await Xn(s,{text:`\xAB${e}\xBB`},0),d=s.node().getBBox().height}c=o.insert(`g`).attr(`class`,`label-group text`),await Xn(c,t,0,[`font-weight: bolder`]);let m=c.node().getBBox();f=m.height,l=o.insert(`g`).attr(`class`,`members-group text`);let h=0;for(let e of t.members){let t=await Xn(l,e,h,[e.parseClassifier()]);h+=t+a}p=l.node().getBBox().height,p<=0&&(p=i/2),u=o.insert(`g`).attr(`class`,`methods-group text`);let g=0;for(let e of t.methods){let t=await Xn(u,e,g,[e.parseClassifier()]);g+=t+a}let _=o.node().getBBox();if(s!==null){let e=s.node().getBBox();s.attr(`transform`,`translate(${-e.width/2})`)}return c.attr(`transform`,`translate(${-m.width/2}, ${d})`),_=o.node().getBBox(),l.attr(`transform`,`translate(0, ${d+f+i*2})`),_=o.node().getBBox(),u.attr(`transform`,`translate(0, ${d+f+(p?p+i*4:i*2)})`),_=o.node().getBBox(),{shapeSvg:o,bbox:_}}P(Yn,`textHelper`);async function Xn(e,t,r,i=[]){let a=e.insert(`g`).attr(`class`,`label`).attr(`style`,i.join(`; `)),o=T(),s=`useHtmlLabels`in t?t.useHtmlLabels:n(o.htmlLabels)??!0,c=``;c=`text`in t?t.text:t.label,!s&&c.startsWith(`\\`)&&(c=c.substring(1)),A(c)&&(s=!0);let l=await E(a,w(M(c)),{width:v(c,o)+50,classes:`markdown-node-label`,useHtmlLabels:s},o),u,d=1;if(s){let e=l.children[0],t=C(l);d=e.innerHTML.split(`<br>`).length,e.innerHTML.includes(`</math>`)&&(d+=e.innerHTML.split(`<mrow>`).length-1);let n=e.getElementsByTagName(`img`);if(n){let e=c.replace(/<img[^>]*>/g,``).trim()===``;await Promise.all([...n].map(t=>new Promise(n=>{function r(){if(t.style.display=`flex`,t.style.flexDirection=`column`,e){let e=o.fontSize?.toString()??window.getComputedStyle(document.body).fontSize,n=parseInt(e,10)*5+`px`;t.style.minWidth=n,t.style.maxWidth=n}else t.style.width=`100%`;n(t)}P(r,`setupImage`),setTimeout(()=>{t.complete&&r()}),t.addEventListener(`error`,r),t.addEventListener(`load`,r)})))}u=e.getBoundingClientRect(),t.attr(`width`,u.width),t.attr(`height`,u.height)}else{i.includes(`font-weight: bolder`)&&C(l).selectAll(`tspan`).attr(`font-weight`,``),d=l.children.length;let e=l.children[0];(l.textContent===``||l.textContent.includes(`&gt`))&&(e.textContent=c[0]+c.substring(1).replaceAll(`&gt;`,`>`).replaceAll(`&lt;`,`<`).trim(),c[1]===` `&&(e.textContent=e.textContent[0]+` `+e.textContent.substring(1))),e.textContent===`undefined`&&(e.textContent=``),u=l.getBBox()}return a.attr(`transform`,`translate(0,`+(-u.height/(2*d)+r)+`)`),u.height}P(Xn,`addText`);async function Zn(e,t){let r=_(),i=r.class.padding??12,a=i,o=t.useHtmlLabels??n(r.htmlLabels)??!0,s=t;s.annotations=s.annotations??[],s.members=s.members??[],s.methods=s.methods??[];let{shapeSvg:c,bbox:l}=await Yn(e,t,r,o,a),{labelStyles:u,nodeStyles:d}=R(t);t.labelStyle=u,t.cssStyles=s.styles||``;let f=s.styles?.join(`;`)||d||``;t.cssStyles||=f.replaceAll(`!important`,``).split(`;`);let p=s.members.length===0&&s.methods.length===0&&!r.class?.hideEmptyMembersBox,m=Y.svg(c),h=z(t,{});t.look!==`handDrawn`&&(h.roughness=0,h.fillStyle=`solid`);let g=l.width,v=l.height;s.members.length===0&&s.methods.length===0?v+=a:s.members.length>0&&s.methods.length===0&&(v+=a*2);let y=-g/2,b=-v/2,x=m.rectangle(y-i,b-i-(p?i:s.members.length===0&&s.methods.length===0?-i/2:0),g+2*i,v+2*i+(p?i*2:s.members.length===0&&s.methods.length===0?-i:0),h),S=c.insert(()=>x,`:first-child`);S.attr(`class`,`basic label-container`);let w=S.node().getBBox();c.selectAll(`.text`).each((e,t,n)=>{let r=C(n[t]),a=r.attr(`transform`),l=0;if(a){let e=RegExp(/translate\(([^,]+),([^)]+)\)/).exec(a);e&&(l=parseFloat(e[2]))}let u=l+b+i-(p?i:s.members.length===0&&s.methods.length===0?-i/2:0);o||(u-=4);let d=y;(r.attr(`class`).includes(`label-group`)||r.attr(`class`).includes(`annotation-group`))&&(d=-r.node()?.getBBox().width/2||0,c.selectAll(`text`).each(function(e,t,n){window.getComputedStyle(n[t]).textAnchor===`middle`&&(d=0)})),r.attr(`transform`,`translate(${d}, ${u})`)});let T=c.select(`.annotation-group`).node().getBBox().height-(p?i/2:0)||0,E=c.select(`.label-group`).node().getBBox().height-(p?i/2:0)||0,D=c.select(`.members-group`).node().getBBox().height-(p?i/2:0)||0;if(s.members.length>0||s.methods.length>0||p){let e=m.line(w.x,T+E+b+i,w.x+w.width,T+E+b+i,h);c.insert(()=>e).attr(`class`,`divider`).attr(`style`,f)}if(p||s.members.length>0||s.methods.length>0){let e=m.line(w.x,T+E+D+b+a*2+i,w.x+w.width,T+E+D+b+i+a*2,h);c.insert(()=>e).attr(`class`,`divider`).attr(`style`,f)}if(s.look!==`handDrawn`&&c.selectAll(`path`).attr(`style`,f),S.select(`:nth-child(2)`).attr(`style`,f),c.selectAll(`.divider`).select(`path`).attr(`style`,f),t.labelStyle?c.selectAll(`span`).attr(`style`,t.labelStyle):c.selectAll(`span`).attr(`style`,f),!o){let e=RegExp(/color\s*:\s*([^;]*)/),t=e.exec(f);if(t){let e=t[0].replace(`color`,`fill`);c.selectAll(`tspan`).attr(`style`,e)}else if(u){let t=e.exec(u);if(t){let e=t[0].replace(`color`,`fill`);c.selectAll(`tspan`).attr(`style`,e)}}}return V(t,S),t.intersect=function(e){return X.rect(t,e)},c}P(Zn,`classBox`);async function Qn(e,t){let{labelStyles:n,nodeStyles:r}=R(t);t.labelStyle=n;let i=t,a=t,o=`verifyMethod`in t,s=H(t),c=e.insert(`g`).attr(`class`,s).attr(`id`,t.domId??t.id),l;l=o?await Q(c,`&lt;&lt;${i.type}&gt;&gt;`,0,t.labelStyle):await Q(c,`&lt;&lt;Element&gt;&gt;`,0,t.labelStyle);let u=l,d=await Q(c,i.name,u,t.labelStyle+`; font-weight: bold;`);if(u+=d+20,o){let e=await Q(c,`${i.requirementId?`ID: ${i.requirementId}`:``}`,u,t.labelStyle);u+=e;let n=await Q(c,`${i.text?`Text: ${i.text}`:``}`,u,t.labelStyle);u+=n;let r=await Q(c,`${i.risk?`Risk: ${i.risk}`:``}`,u,t.labelStyle);u+=r,await Q(c,`${i.verifyMethod?`Verification: ${i.verifyMethod}`:``}`,u,t.labelStyle)}else{let e=await Q(c,`${a.type?`Type: ${a.type}`:``}`,u,t.labelStyle);u+=e,await Q(c,`${a.docRef?`Doc Ref: ${a.docRef}`:``}`,u,t.labelStyle)}let f=(c.node()?.getBBox().width??200)+20,p=(c.node()?.getBBox().height??200)+20,m=-f/2,h=-p/2,g=Y.svg(c),_=z(t,{});t.look!==`handDrawn`&&(_.roughness=0,_.fillStyle=`solid`);let v=g.rectangle(m,h,f,p,_),y=c.insert(()=>v,`:first-child`);if(y.attr(`class`,`basic label-container`).attr(`style`,r),c.selectAll(`.label`).each((e,t,n)=>{let r=C(n[t]),i=r.attr(`transform`),a=0,o=0;if(i){let e=RegExp(/translate\(([^,]+),([^)]+)\)/).exec(i);e&&(a=parseFloat(e[1]),o=parseFloat(e[2]))}let s=o-p/2,c=m+20/2;(t===0||t===1)&&(c=a),r.attr(`transform`,`translate(${c}, ${s+20})`)}),u>l+d+20){let e=g.line(m,h+l+d+20,m+f,h+l+d+20,_);c.insert(()=>e).attr(`style`,r)}return V(t,y),t.intersect=function(e){return X.rect(t,e)},c}P(Qn,`requirementBox`);async function Q(e,t,n,r=``){if(t===``)return 0;let i=e.insert(`g`).attr(`class`,`label`).attr(`style`,r),a=_(),o=a.htmlLabels??!0,s=await E(i,w(M(t)),{width:v(t,a)+50,classes:`markdown-node-label`,useHtmlLabels:o,style:r},a),c;if(o){let e=s.children[0],t=C(s);c=e.getBoundingClientRect(),t.attr(`width`,c.width),t.attr(`height`,c.height)}else{let e=s.children[0];for(let t of e.children)t.textContent=t.textContent.replaceAll(`&gt;`,`>`).replaceAll(`&lt;`,`<`),r&&t.setAttribute(`style`,r);c=s.getBBox(),c.height+=6}return i.attr(`transform`,`translate(${-c.width/2},${-c.height/2+n})`),c.height}P(Q,`addText`);var $n=P(e=>{switch(e){case`Very High`:return`red`;case`High`:return`orange`;case`Medium`:return null;case`Low`:return`blue`;case`Very Low`:return`lightblue`}},`colorFromPriority`);async function er(e,t,{config:n}){let{labelStyles:r,nodeStyles:i}=R(t);t.labelStyle=r||``;let a=t.width;t.width=(t.width??200)-10;let{shapeSvg:o,bbox:s,label:c}=await B(e,t,H(t)),l=t.padding||10,u=``,d;`ticket`in t&&t.ticket&&n?.kanban?.ticketBaseUrl&&(u=n?.kanban?.ticketBaseUrl.replace(`#TICKET#`,t.ticket),d=o.insert(`svg:a`,`:first-child`).attr(`class`,`kanban-ticket-link`).attr(`xlink:href`,u).attr(`target`,`_blank`));let f={useHtmlLabels:t.useHtmlLabels,labelStyle:t.labelStyle||``,width:t.width,img:t.img,padding:t.padding||8,centerLabel:!1},p,m;d?{label:p,bbox:m}=await ie(d,`ticket`in t&&t.ticket||``,f):{label:p,bbox:m}=await ie(o,`ticket`in t&&t.ticket||``,f);let{label:h,bbox:g}=await ie(o,`assigned`in t&&t.assigned||``,f);t.width=a;let _=t?.width||0,v=Math.max(m.height,g.height)/2,y=Math.max(s.height+20,t?.height||0)+v,b=-_/2,x=-y/2;c.attr(`transform`,`translate(`+(l-_/2)+`, `+(-v-s.height/2)+`)`),p.attr(`transform`,`translate(`+(l-_/2)+`, `+(-v+s.height/2)+`)`),h.attr(`transform`,`translate(`+(l+_/2-g.width-20)+`, `+(-v+s.height/2)+`)`);let S,{rx:C,ry:w}=t,{cssStyles:T}=t;if(t.look===`handDrawn`){let e=Y.svg(o),n=z(t,{}),r=C||w?e.path(dt(b,x,_,y,C||0),n):e.rectangle(b,x,_,y,n);S=o.insert(()=>r,`:first-child`),S.attr(`class`,`basic label-container`).attr(`style`,T||null)}else{S=o.insert(`rect`,`:first-child`),S.attr(`class`,`basic label-container __APA__`).attr(`style`,i).attr(`rx`,C??5).attr(`ry`,w??5).attr(`x`,b).attr(`y`,x).attr(`width`,_).attr(`height`,y);let e=`priority`in t&&t.priority;if(e){let t=o.append(`line`),n=b+2,r=x+Math.floor((C??0)/2),i=x+y-Math.floor((C??0)/2);t.attr(`x1`,n).attr(`y1`,r).attr(`x2`,n).attr(`y2`,i).attr(`stroke-width`,`4`).attr(`stroke`,$n(e))}}return V(t,S),t.height=y,t.intersect=function(e){return X.rect(t,e)},o}P(er,`kanbanItem`);async function tr(e,t){let{labelStyles:n,nodeStyles:r}=R(t);t.labelStyle=n;let{shapeSvg:i,bbox:a,halfPadding:o,label:s}=await B(e,t,H(t)),c=a.width+10*o,l=a.height+8*o,u=.15*c,{cssStyles:d}=t,f=a.width+20,p=a.height+20,m=Math.max(c,f),h=Math.max(l,p);s.attr(`transform`,`translate(${-a.width/2}, ${-a.height/2})`);let g,_=`M0 0 
    a${u},${u} 1 0,0 ${m*.25},${-1*h*.1}
    a${u},${u} 1 0,0 ${m*.25},0
    a${u},${u} 1 0,0 ${m*.25},0
    a${u},${u} 1 0,0 ${m*.25},${h*.1}

    a${u},${u} 1 0,0 ${m*.15},${h*.33}
    a${u*.8},${u*.8} 1 0,0 0,${h*.34}
    a${u},${u} 1 0,0 ${-1*m*.15},${h*.33}

    a${u},${u} 1 0,0 ${-1*m*.25},${h*.15}
    a${u},${u} 1 0,0 ${-1*m*.25},0
    a${u},${u} 1 0,0 ${-1*m*.25},0
    a${u},${u} 1 0,0 ${-1*m*.25},${-1*h*.15}

    a${u},${u} 1 0,0 ${-1*m*.1},${-1*h*.33}
    a${u*.8},${u*.8} 1 0,0 0,${-1*h*.34}
    a${u},${u} 1 0,0 ${m*.1},${-1*h*.33}
  H0 V0 Z`;if(t.look===`handDrawn`){let e=Y.svg(i),n=z(t,{}),r=e.path(_,n);g=i.insert(()=>r,`:first-child`),g.attr(`class`,`basic label-container`).attr(`style`,k(d))}else g=i.insert(`path`,`:first-child`).attr(`class`,`basic label-container`).attr(`style`,r).attr(`d`,_);return g.attr(`transform`,`translate(${-m/2}, ${-h/2})`),V(t,g),t.calcIntersect=function(e,t){return X.rect(e,t)},t.intersect=function(e){return y.info(`Bang intersect`,t,e),X.rect(t,e)},i}P(tr,`bang`);async function nr(e,t){let{labelStyles:n,nodeStyles:r}=R(t);t.labelStyle=n;let{shapeSvg:i,bbox:a,halfPadding:o,label:s}=await B(e,t,H(t)),c=a.width+2*o,l=a.height+2*o,u=.15*c,d=.25*c,f=.35*c,p=.2*c,{cssStyles:m}=t,h,g=`M0 0 
    a${u},${u} 0 0,1 ${c*.25},${-1*c*.1}
    a${f},${f} 1 0,1 ${c*.4},${-1*c*.1}
    a${d},${d} 1 0,1 ${c*.35},${c*.2}

    a${u},${u} 1 0,1 ${c*.15},${l*.35}
    a${p},${p} 1 0,1 ${-1*c*.15},${l*.65}

    a${d},${u} 1 0,1 ${-1*c*.25},${c*.15}
    a${f},${f} 1 0,1 ${-1*c*.5},0
    a${u},${u} 1 0,1 ${-1*c*.25},${-1*c*.15}

    a${u},${u} 1 0,1 ${-1*c*.1},${-1*l*.35}
    a${p},${p} 1 0,1 ${c*.1},${-1*l*.65}
  H0 V0 Z`;if(t.look===`handDrawn`){let e=Y.svg(i),n=z(t,{}),r=e.path(g,n);h=i.insert(()=>r,`:first-child`),h.attr(`class`,`basic label-container`).attr(`style`,k(m))}else h=i.insert(`path`,`:first-child`).attr(`class`,`basic label-container`).attr(`style`,r).attr(`d`,g);return s.attr(`transform`,`translate(${-a.width/2}, ${-a.height/2})`),h.attr(`transform`,`translate(${-c/2}, ${-l/2})`),V(t,h),t.calcIntersect=function(e,t){return X.rect(e,t)},t.intersect=function(e){return y.info(`Cloud intersect`,t,e),X.rect(t,e)},i}P(nr,`cloud`);async function rr(e,t){let{labelStyles:n,nodeStyles:r}=R(t);t.labelStyle=n;let{shapeSvg:i,bbox:a,halfPadding:o,label:s}=await B(e,t,H(t)),c=a.width+8*o,l=a.height+2*o,u=`
    M${-c/2} ${l/2-5}
    v${-l+10}
    q0,-5 5,-5
    h${c-10}
    q5,0 5,5
    v${l-10}
    q0,5 -5,5
    h${-c+10}
    q-5,0 -5,-5
    Z
  `,d=i.append(`path`).attr(`id`,`node-`+t.id).attr(`class`,`node-bkg node-`+t.type).attr(`style`,r).attr(`d`,u);return i.append(`line`).attr(`class`,`node-line-`).attr(`x1`,-c/2).attr(`y1`,l/2).attr(`x2`,c/2).attr(`y2`,l/2),s.attr(`transform`,`translate(${-a.width/2}, ${-a.height/2})`),i.append(()=>s.node()),V(t,d),t.calcIntersect=function(e,t){return X.rect(e,t)},t.intersect=function(e){return X.rect(t,e)},i}P(rr,`defaultMindmapNode`);async function ir(e,t){return Nt(e,t,{padding:t.padding??0})}P(ir,`mindmapCircle`);var ar=[{semanticName:`Process`,name:`Rectangle`,shortName:`rect`,description:`Standard process shape`,aliases:[`proc`,`process`,`rectangle`],internalAliases:[`squareRect`],handler:On},{semanticName:`Event`,name:`Rounded Rectangle`,shortName:`rounded`,description:`Represents an event`,aliases:[`event`],internalAliases:[`roundedRect`],handler:Tn},{semanticName:`Terminal Point`,name:`Stadium`,shortName:`stadium`,description:`Terminal point`,aliases:[`terminal`,`pill`],handler:kn},{semanticName:`Subprocess`,name:`Framed Rectangle`,shortName:`fr-rect`,description:`Subprocess`,aliases:[`subprocess`,`subproc`,`framed-rectangle`,`subroutine`],handler:Nn},{semanticName:`Database`,name:`Cylinder`,shortName:`cyl`,description:`Database storage`,aliases:[`db`,`database`,`cylinder`],handler:Gt},{semanticName:`Start`,name:`Circle`,shortName:`circle`,description:`Starting point`,aliases:[`circ`],handler:Nt},{semanticName:`Bang`,name:`Bang`,shortName:`bang`,description:`Bang`,aliases:[`bang`],handler:tr},{semanticName:`Cloud`,name:`Cloud`,shortName:`cloud`,description:`cloud`,aliases:[`cloud`],handler:nr},{semanticName:`Decision`,name:`Diamond`,shortName:`diam`,description:`Decision-making step`,aliases:[`decision`,`diamond`,`question`],handler:xn},{semanticName:`Prepare Conditional`,name:`Hexagon`,shortName:`hex`,description:`Preparation or condition step`,aliases:[`hexagon`,`prepare`],handler:Qt},{semanticName:`Data Input/Output`,name:`Lean Right`,shortName:`lean-r`,description:`Represents input or output`,aliases:[`lean-right`,`in-out`],internalAliases:[`lean_right`],handler:un},{semanticName:`Data Input/Output`,name:`Lean Left`,shortName:`lean-l`,description:`Represents output or input`,aliases:[`lean-left`,`out-in`],internalAliases:[`lean_left`],handler:ln},{semanticName:`Priority Action`,name:`Trapezoid Base Bottom`,shortName:`trap-b`,description:`Priority action`,aliases:[`priority`,`trapezoid-bottom`,`trapezoid`],handler:Vn},{semanticName:`Manual Operation`,name:`Trapezoid Base Top`,shortName:`trap-t`,description:`Represents a manual task`,aliases:[`manual`,`trapezoid-top`,`inv-trapezoid`],internalAliases:[`inv_trapezoid`],handler:on},{semanticName:`Stop`,name:`Double Circle`,shortName:`dbl-circ`,description:`Represents a stop point`,aliases:[`double-circle`],internalAliases:[`doublecircle`],handler:qt},{semanticName:`Text Block`,name:`Text Block`,shortName:`text`,description:`Text block`,handler:In},{semanticName:`Card`,name:`Notched Rectangle`,shortName:`notch-rect`,description:`Represents a card`,aliases:[`card`,`notched-rectangle`],handler:jt},{semanticName:`Lined/Shaded Process`,name:`Lined Rectangle`,shortName:`lin-rect`,description:`Lined process shape`,aliases:[`lined-rectangle`,`lined-process`,`lin-proc`,`shaded-process`],handler:En},{semanticName:`Start`,name:`Small Circle`,shortName:`sm-circ`,description:`Small starting point`,aliases:[`start`,`small-circle`],internalAliases:[`stateStart`],handler:Mn},{semanticName:`Stop`,name:`Framed Circle`,shortName:`fr-circ`,description:`Stop point`,aliases:[`stop`,`framed-circle`],internalAliases:[`stateEnd`],handler:jn},{semanticName:`Fork/Join`,name:`Filled Rectangle`,shortName:`fork`,description:`Fork or join in process flow`,aliases:[`join`],internalAliases:[`forkJoin`],handler:Xt},{semanticName:`Collate`,name:`Hourglass`,shortName:`hourglass`,description:`Represents a collate operation`,aliases:[`hourglass`,`collate`],handler:$t},{semanticName:`Comment`,name:`Curly Brace`,shortName:`brace`,description:`Adds a comment`,aliases:[`comment`,`brace-l`],handler:Lt},{semanticName:`Comment Right`,name:`Curly Brace`,shortName:`brace-r`,description:`Adds a comment`,handler:zt},{semanticName:`Comment with braces on both sides`,name:`Curly Braces`,shortName:`braces`,description:`Adds a comment`,handler:Bt},{semanticName:`Com Link`,name:`Lightning Bolt`,shortName:`bolt`,description:`Communication link`,aliases:[`com-link`,`lightning-bolt`],handler:dn},{semanticName:`Document`,name:`Document`,shortName:`doc`,description:`Represents a document`,aliases:[`doc`,`document`],handler:Wn},{semanticName:`Delay`,name:`Half-Rounded Rectangle`,shortName:`delay`,description:`Represents a delay`,aliases:[`half-rounded-rectangle`],handler:Zt},{semanticName:`Direct Access Storage`,name:`Horizontal Cylinder`,shortName:`h-cyl`,description:`Direct access storage`,aliases:[`das`,`horizontal-cylinder`],handler:Bn},{semanticName:`Disk Storage`,name:`Lined Cylinder`,shortName:`lin-cyl`,description:`Disk storage`,aliases:[`disk`,`lined-cylinder`],handler:hn},{semanticName:`Display`,name:`Curved Trapezoid`,shortName:`curv-trap`,description:`Represents a display`,aliases:[`curved-trapezoid`,`display`],handler:Vt},{semanticName:`Divided Process`,name:`Divided Rectangle`,shortName:`div-rect`,description:`Divided process shape`,aliases:[`div-proc`,`divided-rectangle`,`divided-process`],handler:Kt},{semanticName:`Extract`,name:`Triangle`,shortName:`tri`,description:`Extraction process`,aliases:[`extract`,`triangle`],handler:Un},{semanticName:`Internal Storage`,name:`Window Pane`,shortName:`win-pane`,description:`Internal storage`,aliases:[`internal-storage`,`window-pane`],handler:Kn},{semanticName:`Junction`,name:`Filled Circle`,shortName:`f-circ`,description:`Junction point`,aliases:[`junction`,`filled-circle`],handler:Jt},{semanticName:`Loop Limit`,name:`Trapezoidal Pentagon`,shortName:`notch-pent`,description:`Loop limit step`,aliases:[`loop-limit`,`notched-pentagon`],handler:Hn},{semanticName:`Manual File`,name:`Flipped Triangle`,shortName:`flip-tri`,description:`Manual file operation`,aliases:[`manual-file`,`flipped-triangle`],handler:Yt},{semanticName:`Manual Input`,name:`Sloped Rectangle`,shortName:`sl-rect`,description:`Manual input step`,aliases:[`manual-input`,`sloped-rectangle`],handler:Dn},{semanticName:`Multi-Document`,name:`Stacked Document`,shortName:`docs`,description:`Multiple documents`,aliases:[`documents`,`st-doc`,`stacked-document`],handler:vn},{semanticName:`Multi-Process`,name:`Stacked Rectangle`,shortName:`st-rect`,description:`Multiple processes`,aliases:[`procs`,`processes`,`stacked-rectangle`],handler:_n},{semanticName:`Stored Data`,name:`Bow Tie Rectangle`,shortName:`bow-rect`,description:`Stored data`,aliases:[`stored-data`,`bow-tie-rectangle`],handler:kt},{semanticName:`Summary`,name:`Crossed Circle`,shortName:`cross-circ`,description:`Summary`,aliases:[`summary`,`crossed-circle`],handler:Ft},{semanticName:`Tagged Document`,name:`Tagged Document`,shortName:`tag-doc`,description:`Tagged document`,aliases:[`tag-doc`,`tagged-document`],handler:Fn},{semanticName:`Tagged Process`,name:`Tagged Rectangle`,shortName:`tag-rect`,description:`Tagged process`,aliases:[`tagged-rectangle`,`tag-proc`,`tagged-process`],handler:Pn},{semanticName:`Paper Tape`,name:`Flag`,shortName:`flag`,description:`Paper tape`,aliases:[`paper-tape`],handler:Gn},{semanticName:`Odd`,name:`Odd`,shortName:`odd`,description:`Odd shape`,internalAliases:[`rect_left_inv_arrow`],handler:Sn},{semanticName:`Lined Document`,name:`Lined Document`,shortName:`lin-doc`,description:`Lined document`,aliases:[`lined-document`],handler:gn}],or=P(()=>{let e=[...Object.entries({state:An,choice:Mt,note:yn,rectWithTitle:Cn,labelRect:cn,iconSquare:rn,iconCircle:tn,icon:en,iconRounded:nn,imageSquare:an,anchor:Dt,kanbanItem:er,mindmapCircle:ir,defaultMindmapNode:rr,classBox:Zn,erBox:qn,requirementBox:Qn}),...ar.flatMap(e=>[e.shortName,...`aliases`in e?e.aliases:[],...`internalAliases`in e?e.internalAliases:[]].map(t=>[t,e.handler]))];return Object.fromEntries(e)},`generateShapeMap`)();function sr(e){return e in or}P(sr,`isValidShape`);var cr=new Map;async function lr(e,t,n){let r,i;t.shape===`rect`&&(t.rx&&t.ry?t.shape=`roundedRect`:t.shape=`squareRect`);let a=t.shape?or[t.shape]:void 0;if(!a)throw Error(`No such shape: ${t.shape}. Please check your syntax.`);if(t.link){let o;n.config.securityLevel===`sandbox`?o=`_top`:t.linkTarget&&(o=t.linkTarget||`_blank`),r=e.insert(`svg:a`).attr(`xlink:href`,t.link).attr(`target`,o??null),i=await a(r,t,n)}else i=await a(e,t,n),r=i;return t.tooltip&&i.attr(`title`,t.tooltip),cr.set(t.id,r),t.haveCallback&&r.attr(`class`,r.attr(`class`)+` clickable`),r}P(lr,`insertNode`);var ur=P((e,t)=>{cr.set(t.id,e)},`setNodeElem`),dr=P(()=>{cr.clear()},`clear`),fr=P(e=>{let t=cr.get(e.id);y.trace(`Transforming node`,e.diff,e,`translate(`+(e.x-e.width/2-5)+`, `+e.width/2+`)`);let n=e.diff||0;return e.clusterNode?t.attr(`transform`,`translate(`+(e.x+n-e.width/2)+`, `+(e.y-e.height/2-8)+`)`):t.attr(`transform`,`translate(`+e.x+`, `+e.y+`)`),n},`positionNode`),pr=P((e,t,n,r,i,a)=>{t.arrowTypeStart&&hr(e,`start`,t.arrowTypeStart,n,r,i,a),t.arrowTypeEnd&&hr(e,`end`,t.arrowTypeEnd,n,r,i,a)},`addEdgeMarkers`),mr={arrow_cross:{type:`cross`,fill:!1},arrow_point:{type:`point`,fill:!0},arrow_barb:{type:`barb`,fill:!0},arrow_circle:{type:`circle`,fill:!1},aggregation:{type:`aggregation`,fill:!1},extension:{type:`extension`,fill:!1},composition:{type:`composition`,fill:!0},dependency:{type:`dependency`,fill:!0},lollipop:{type:`lollipop`,fill:!1},only_one:{type:`onlyOne`,fill:!1},zero_or_one:{type:`zeroOrOne`,fill:!1},one_or_more:{type:`oneOrMore`,fill:!1},zero_or_more:{type:`zeroOrMore`,fill:!1},requirement_arrow:{type:`requirement_arrow`,fill:!1},requirement_contains:{type:`requirement_contains`,fill:!1}},hr=P((e,t,n,r,i,a,o)=>{let s=mr[n];if(!s){y.warn(`Unknown arrow type: ${n}`);return}let c=`${i}_${a}-${s.type}${t===`start`?`Start`:`End`}`;if(o&&o.trim()!==``){let n=`${c}_${o.replace(/[^\dA-Za-z]/g,`_`)}`;if(!document.getElementById(n)){let e=document.getElementById(c);if(e){let t=e.cloneNode(!0);t.id=n,t.querySelectorAll(`path, circle, line`).forEach(e=>{e.setAttribute(`stroke`,o),s.fill&&e.setAttribute(`fill`,o)}),e.parentNode?.appendChild(t)}}e.attr(`marker-${t}`,`url(${r}#${n})`)}else e.attr(`marker-${t}`,`url(${r}#${c})`)},`addEdgeMarker`),gr=new Map,$=new Map,_r=P(()=>{gr.clear(),$.clear()},`clear`),vr=P(e=>e?e.reduce((e,t)=>e+`;`+t,``):``,`getLabelStyles`),yr=P(async(e,t)=>{let r=n(_().flowchart.htmlLabels),{labelStyles:i}=R(t);t.labelStyle=i;let a=await E(e,t.label,{style:t.labelStyle,useHtmlLabels:r,addSvgBackground:!0,isNode:!1});y.info(`abc82`,t,t.labelType);let o=e.insert(`g`).attr(`class`,`edgeLabel`),s=o.insert(`g`).attr(`class`,`label`).attr(`data-id`,t.id);s.node().appendChild(a);let c=a.getBBox();if(r){let e=a.children[0],t=C(a);c=e.getBoundingClientRect(),t.attr(`width`,c.width),t.attr(`height`,c.height)}s.attr(`transform`,`translate(`+-c.width/2+`, `+-c.height/2+`)`),gr.set(t.id,o),t.width=c.width,t.height=c.height;let l;if(t.startLabelLeft){let n=await ut(t.startLabelLeft,vr(t.labelStyle)),r=e.insert(`g`).attr(`class`,`edgeTerminals`),i=r.insert(`g`).attr(`class`,`inner`);l=i.node().appendChild(n);let a=n.getBBox();i.attr(`transform`,`translate(`+-a.width/2+`, `+-a.height/2+`)`),$.get(t.id)||$.set(t.id,{}),$.get(t.id).startLeft=r,br(l,t.startLabelLeft)}if(t.startLabelRight){let n=await ut(t.startLabelRight,vr(t.labelStyle)),r=e.insert(`g`).attr(`class`,`edgeTerminals`),i=r.insert(`g`).attr(`class`,`inner`);l=r.node().appendChild(n),i.node().appendChild(n);let a=n.getBBox();i.attr(`transform`,`translate(`+-a.width/2+`, `+-a.height/2+`)`),$.get(t.id)||$.set(t.id,{}),$.get(t.id).startRight=r,br(l,t.startLabelRight)}if(t.endLabelLeft){let n=await ut(t.endLabelLeft,vr(t.labelStyle)),r=e.insert(`g`).attr(`class`,`edgeTerminals`),i=r.insert(`g`).attr(`class`,`inner`);l=i.node().appendChild(n);let a=n.getBBox();i.attr(`transform`,`translate(`+-a.width/2+`, `+-a.height/2+`)`),r.node().appendChild(n),$.get(t.id)||$.set(t.id,{}),$.get(t.id).endLeft=r,br(l,t.endLabelLeft)}if(t.endLabelRight){let n=await ut(t.endLabelRight,vr(t.labelStyle)),r=e.insert(`g`).attr(`class`,`edgeTerminals`),i=r.insert(`g`).attr(`class`,`inner`);l=i.node().appendChild(n);let a=n.getBBox();i.attr(`transform`,`translate(`+-a.width/2+`, `+-a.height/2+`)`),r.node().appendChild(n),$.get(t.id)||$.set(t.id,{}),$.get(t.id).endRight=r,br(l,t.endLabelRight)}return a},`insertEdgeLabel`);function br(e,t){_().flowchart.htmlLabels&&e&&(e.style.width=t.length*9+`px`,e.style.height=`12px`)}P(br,`setTerminalWidth`);var xr=P((e,t)=>{y.debug(`Moving label abc88 `,e.id,e.label,gr.get(e.id),t);let n=t.updatedPath?t.updatedPath:t.originalPath,{subGraphTitleTotalMargin:r}=ne(_());if(e.label){let i=gr.get(e.id),a=e.x,o=e.y;if(n){let r=p.calcLabelPosition(n);y.debug(`Moving label `+e.label+` from (`,a,`,`,o,`) to (`,r.x,`,`,r.y,`) abc88`),t.updatedPath&&(a=r.x,o=r.y)}i.attr(`transform`,`translate(${a}, ${o+r/2})`)}if(e.startLabelLeft){let t=$.get(e.id).startLeft,r=e.x,i=e.y;if(n){let t=p.calcTerminalLabelPosition(e.arrowTypeStart?10:0,`start_left`,n);r=t.x,i=t.y}t.attr(`transform`,`translate(${r}, ${i})`)}if(e.startLabelRight){let t=$.get(e.id).startRight,r=e.x,i=e.y;if(n){let t=p.calcTerminalLabelPosition(e.arrowTypeStart?10:0,`start_right`,n);r=t.x,i=t.y}t.attr(`transform`,`translate(${r}, ${i})`)}if(e.endLabelLeft){let t=$.get(e.id).endLeft,r=e.x,i=e.y;if(n){let t=p.calcTerminalLabelPosition(e.arrowTypeEnd?10:0,`end_left`,n);r=t.x,i=t.y}t.attr(`transform`,`translate(${r}, ${i})`)}if(e.endLabelRight){let t=$.get(e.id).endRight,r=e.x,i=e.y;if(n){let t=p.calcTerminalLabelPosition(e.arrowTypeEnd?10:0,`end_right`,n);r=t.x,i=t.y}t.attr(`transform`,`translate(${r}, ${i})`)}},`positionEdgeLabel`),Sr=P((e,t)=>{let n=e.x,r=e.y,i=Math.abs(t.x-n),a=Math.abs(t.y-r),o=e.width/2,s=e.height/2;return i>=o||a>=s},`outsideNode`),Cr=P((e,t,n)=>{y.debug(`intersection calc abc89:
  outsidePoint: ${JSON.stringify(t)}
  insidePoint : ${JSON.stringify(n)}
  node        : x:${e.x} y:${e.y} w:${e.width} h:${e.height}`);let r=e.x,i=e.y,a=Math.abs(r-n.x),o=e.width/2,s=n.x<t.x?o-a:o+a,c=e.height/2,l=Math.abs(t.y-n.y),u=Math.abs(t.x-n.x);if(Math.abs(i-t.y)*o>Math.abs(r-t.x)*c){let e=n.y<t.y?t.y-c-i:i-c-t.y;s=u*e/l;let r={x:n.x<t.x?n.x+s:n.x-u+s,y:n.y<t.y?n.y+l-e:n.y-l+e};return s===0&&(r.x=t.x,r.y=t.y),u===0&&(r.x=t.x),l===0&&(r.y=t.y),y.debug(`abc89 top/bottom calc, Q ${l}, q ${e}, R ${u}, r ${s}`,r),r}else{s=n.x<t.x?t.x-o-r:r-o-t.x;let e=l*s/u,i=n.x<t.x?n.x+u-s:n.x-u+s,a=n.y<t.y?n.y+e:n.y-e;return y.debug(`sides calc abc89, Q ${l}, q ${e}, R ${u}, r ${s}`,{_x:i,_y:a}),s===0&&(i=t.x,a=t.y),u===0&&(i=t.x),l===0&&(a=t.y),{x:i,y:a}}},`intersection`),wr=P((e,t)=>{y.warn(`abc88 cutPathAtIntersect`,e,t);let n=[],r=e[0],i=!1;return e.forEach(e=>{if(y.info(`abc88 checking point`,e,t),!Sr(t,e)&&!i){let a=Cr(t,r,e);y.debug(`abc88 inside`,e,r,a),y.debug(`abc88 intersection`,a,t);let o=!1;n.forEach(e=>{o||=e.x===a.x&&e.y===a.y}),n.some(e=>e.x===a.x&&e.y===a.y)?y.warn(`abc88 no intersect`,a,n):n.push(a),i=!0}else y.warn(`abc88 outside`,e,r),r=e,i||n.push(e)}),y.debug(`returning points`,n),n},`cutPathAtIntersect`);function Tr(e){let t=[],n=[];for(let r=1;r<e.length-1;r++){let i=e[r-1],a=e[r],o=e[r+1];(i.x===a.x&&a.y===o.y&&Math.abs(a.x-o.x)>5&&Math.abs(a.y-i.y)>5||i.y===a.y&&a.x===o.x&&Math.abs(a.x-i.x)>5&&Math.abs(a.y-o.y)>5)&&(t.push(a),n.push(r))}return{cornerPoints:t,cornerPointPositions:n}}P(Tr,`extractCornerPoints`);var Er=P(function(e,t,n){let r=t.x-e.x,i=t.y-e.y,a=n/Math.sqrt(r*r+i*i);return{x:t.x-a*r,y:t.y-a*i}},`findAdjacentPoint`),Dr=P(function(e){let{cornerPointPositions:t}=Tr(e),n=[];for(let r=0;r<e.length;r++)if(t.includes(r)){let t=e[r-1],i=e[r+1],a=e[r],o=Er(t,a,5),s=Er(i,a,5),c=s.x-o.x,l=s.y-o.y;n.push(o);let u=Math.sqrt(2)*2,d={x:a.x,y:a.y};Math.abs(i.x-t.x)>10&&Math.abs(i.y-t.y)>=10?(y.debug(`Corner point fixing`,Math.abs(i.x-t.x),Math.abs(i.y-t.y)),d=a.x===o.x?{x:c<0?o.x-5+u:o.x+5-u,y:l<0?o.y-u:o.y+u}:{x:c<0?o.x-u:o.x+u,y:l<0?o.y-5+u:o.y+5-u}):y.debug(`Corner point skipping fixing`,Math.abs(i.x-t.x),Math.abs(i.y-t.y)),n.push(d,s)}else n.push(e[r]);return n},`fixCorners`),Or=P((e,t,n)=>{let r=e-t-n,i=Math.floor(r/4);return`0 ${t} ${Array(i).fill(`2 2`).join(` `)} ${n}`},`generateDashArray`),kr=P(function(n,a,l,d,h,g,v,b=!1){let{handDrawnSeed:S}=_(),w=a.points,T=!1,E=h;var O=g;let k=[];for(let e in a.cssCompiledStyles)L(e)||k.push(a.cssCompiledStyles[e]);y.debug(`UIO intersect check`,a.points,O.x,E.x),O.intersect&&E.intersect&&!b&&(w=w.slice(1,a.points.length-1),w.unshift(E.intersect(w[0])),y.debug(`Last point UIO`,a.start,`-->`,a.end,w[w.length-1],O,O.intersect(w[w.length-1])),w.push(O.intersect(w[w.length-1])));let A=btoa(JSON.stringify(w));a.toCluster&&(y.info(`to cluster abc88`,l.get(a.toCluster)),w=wr(a.points,l.get(a.toCluster).node),T=!0),a.fromCluster&&(y.debug(`from cluster abc88`,l.get(a.fromCluster),JSON.stringify(w,null,2)),w=wr(w.reverse(),l.get(a.fromCluster).node).reverse(),T=!0);let j=w.filter(e=>!Number.isNaN(e.y));j=Dr(j);let M=x;switch(M=c,a.curve){case`linear`:M=c;break;case`basis`:M=x;break;case`cardinal`:M=s;break;case`bumpX`:M=r;break;case`bumpY`:M=N;break;case`catmullRom`:M=f;break;case`monotoneX`:M=m;break;case`monotoneY`:M=t;break;case`natural`:M=D;break;case`step`:M=i;break;case`stepAfter`:M=e;break;case`stepBefore`:M=u;break;default:M=x}let{x:P,y:te}=ee(a),ne=o().x(P).y(te).curve(M),F;switch(a.thickness){case`normal`:F=`edge-thickness-normal`;break;case`thick`:F=`edge-thickness-thick`;break;case`invisible`:F=`edge-thickness-invisible`;break;default:F=`edge-thickness-normal`}switch(a.pattern){case`solid`:F+=` edge-pattern-solid`;break;case`dotted`:F+=` edge-pattern-dotted`;break;case`dashed`:F+=` edge-pattern-dashed`;break;default:F+=` edge-pattern-solid`}let I,R=a.curve===`rounded`?Ar(Mr(j,a),5):ne(j),z=Array.isArray(a.style)?a.style:[a.style],B=z.find(e=>e?.startsWith(`stroke:`)),ie=!1;if(a.look===`handDrawn`){let e=Y.svg(n);Object.assign([],j);let t=e.path(R,{roughness:.3,seed:S});F+=` transition`,I=C(t).select(`path`).attr(`id`,a.id).attr(`class`,` `+F+(a.classes?` `+a.classes:``)).attr(`style`,z?z.reduce((e,t)=>e+`;`+t,``):``);let r=I.attr(`d`);I.attr(`d`,r),n.node().appendChild(I.node())}else{let e=k.join(`;`),t=z?z.reduce((e,t)=>e+t+`;`,``):``,r=``;a.animate&&(r=` edge-animation-fast`),a.animation&&(r=` edge-animation-`+a.animation);let i=(e?e+`;`+t+`;`:t)+`;`+(z?z.reduce((e,t)=>e+`;`+t,``):``);I=n.append(`path`).attr(`d`,R).attr(`id`,a.id).attr(`class`,` `+F+(a.classes?` `+a.classes:``)+(r??``)).attr(`style`,i),B=i.match(/stroke:([^;]+)/)?.[1],ie=a.animate===!0||!!a.animation||e.includes(`animation`);let o=I.node(),s=typeof o.getTotalLength==`function`?o.getTotalLength():0,c=re[a.arrowTypeStart]||0,l=re[a.arrowTypeEnd]||0;if(a.look===`neo`&&!ie){let e=`stroke-dasharray: ${a.pattern===`dotted`||a.pattern===`dashed`?Or(s,c,l):`0 ${c} ${s-c-l} ${l}`}; stroke-dashoffset: 0;`;I.attr(`style`,e+I.attr(`style`))}}I.attr(`data-edge`,!0),I.attr(`data-et`,`edge`),I.attr(`data-id`,a.id),I.attr(`data-points`,A),a.showPoints&&j.forEach(e=>{n.append(`circle`).style(`stroke`,`red`).style(`fill`,`red`).attr(`r`,1).attr(`cx`,e.x).attr(`cy`,e.y)});let V=``;(_().flowchart.arrowMarkerAbsolute||_().state.arrowMarkerAbsolute)&&(V=window.location.protocol+`//`+window.location.host+window.location.pathname+window.location.search,V=V.replace(/\(/g,`\\(`).replace(/\)/g,`\\)`)),y.info(`arrowTypeStart`,a.arrowTypeStart),y.info(`arrowTypeEnd`,a.arrowTypeEnd),pr(I,a,V,v,d,B);let H=Math.floor(w.length/2),U=w[H];p.isLabelCoordinateInPath(U,I.attr(`d`))||(T=!0);let W={};return T&&(W.updatedPath=w),W.originalPath=a.points,W},`insertEdge`);function Ar(e,t){if(e.length<2)return``;let n=``,r=e.length,i=1e-5;for(let a=0;a<r;a++){let o=e[a],s=e[a-1],c=e[a+1];if(a===0)n+=`M${o.x},${o.y}`;else if(a===r-1)n+=`L${o.x},${o.y}`;else{let e=o.x-s.x,r=o.y-s.y,a=c.x-o.x,l=c.y-o.y,u=Math.hypot(e,r),d=Math.hypot(a,l);if(u<i||d<i){n+=`L${o.x},${o.y}`;continue}let f=e/u,p=r/u,m=a/d,h=l/d,g=f*m+p*h,_=Math.max(-1,Math.min(1,g)),v=Math.acos(_);if(v<i||Math.abs(Math.PI-v)<i){n+=`L${o.x},${o.y}`;continue}let y=Math.min(t/Math.sin(v/2),u/2,d/2),b=o.x-f*y,x=o.y-p*y,S=o.x+m*y,C=o.y+h*y;n+=`L${b},${x}`,n+=`Q${o.x},${o.y} ${S},${C}`}}return n}P(Ar,`generateRoundedPath`);function jr(e,t){if(!e||!t)return{angle:0,deltaX:0,deltaY:0};let n=t.x-e.x,r=t.y-e.y;return{angle:Math.atan2(r,n),deltaX:n,deltaY:r}}P(jr,`calculateDeltaAndAngle`);function Mr(e,t){let n=e.map(e=>({...e}));if(e.length>=2&&te[t.arrowTypeStart]){let r=te[t.arrowTypeStart],i=e[0],a=e[1],{angle:o}=jr(i,a),s=r*Math.cos(o),c=r*Math.sin(o);n[0].x=i.x+s,n[0].y=i.y+c}let r=e.length;if(r>=2&&te[t.arrowTypeEnd]){let i=te[t.arrowTypeEnd],a=e[r-1],o=e[r-2],{angle:s}=jr(o,a),c=i*Math.cos(s),l=i*Math.sin(s);n[r-1].x=a.x-c,n[r-1].y=a.y-l}return n}P(Mr,`applyMarkerOffsetsToPoints`);var Nr=P((e,t,n,r)=>{t.forEach(t=>{Pr[t](e,n,r)})},`insertMarkers`),Pr={extension:P((e,t,n)=>{y.trace(`Making markers for `,n),e.append(`defs`).append(`marker`).attr(`id`,n+`_`+t+`-extensionStart`).attr(`class`,`marker extension `+t).attr(`refX`,18).attr(`refY`,7).attr(`markerWidth`,190).attr(`markerHeight`,240).attr(`orient`,`auto`).append(`path`).attr(`d`,`M 1,7 L18,13 V 1 Z`),e.append(`defs`).append(`marker`).attr(`id`,n+`_`+t+`-extensionEnd`).attr(`class`,`marker extension `+t).attr(`refX`,1).attr(`refY`,7).attr(`markerWidth`,20).attr(`markerHeight`,28).attr(`orient`,`auto`).append(`path`).attr(`d`,`M 1,1 V 13 L18,7 Z`)},`extension`),composition:P((e,t,n)=>{e.append(`defs`).append(`marker`).attr(`id`,n+`_`+t+`-compositionStart`).attr(`class`,`marker composition `+t).attr(`refX`,18).attr(`refY`,7).attr(`markerWidth`,190).attr(`markerHeight`,240).attr(`orient`,`auto`).append(`path`).attr(`d`,`M 18,7 L9,13 L1,7 L9,1 Z`),e.append(`defs`).append(`marker`).attr(`id`,n+`_`+t+`-compositionEnd`).attr(`class`,`marker composition `+t).attr(`refX`,1).attr(`refY`,7).attr(`markerWidth`,20).attr(`markerHeight`,28).attr(`orient`,`auto`).append(`path`).attr(`d`,`M 18,7 L9,13 L1,7 L9,1 Z`)},`composition`),aggregation:P((e,t,n)=>{e.append(`defs`).append(`marker`).attr(`id`,n+`_`+t+`-aggregationStart`).attr(`class`,`marker aggregation `+t).attr(`refX`,18).attr(`refY`,7).attr(`markerWidth`,190).attr(`markerHeight`,240).attr(`orient`,`auto`).append(`path`).attr(`d`,`M 18,7 L9,13 L1,7 L9,1 Z`),e.append(`defs`).append(`marker`).attr(`id`,n+`_`+t+`-aggregationEnd`).attr(`class`,`marker aggregation `+t).attr(`refX`,1).attr(`refY`,7).attr(`markerWidth`,20).attr(`markerHeight`,28).attr(`orient`,`auto`).append(`path`).attr(`d`,`M 18,7 L9,13 L1,7 L9,1 Z`)},`aggregation`),dependency:P((e,t,n)=>{e.append(`defs`).append(`marker`).attr(`id`,n+`_`+t+`-dependencyStart`).attr(`class`,`marker dependency `+t).attr(`refX`,6).attr(`refY`,7).attr(`markerWidth`,190).attr(`markerHeight`,240).attr(`orient`,`auto`).append(`path`).attr(`d`,`M 5,7 L9,13 L1,7 L9,1 Z`),e.append(`defs`).append(`marker`).attr(`id`,n+`_`+t+`-dependencyEnd`).attr(`class`,`marker dependency `+t).attr(`refX`,13).attr(`refY`,7).attr(`markerWidth`,20).attr(`markerHeight`,28).attr(`orient`,`auto`).append(`path`).attr(`d`,`M 18,7 L9,13 L14,7 L9,1 Z`)},`dependency`),lollipop:P((e,t,n)=>{e.append(`defs`).append(`marker`).attr(`id`,n+`_`+t+`-lollipopStart`).attr(`class`,`marker lollipop `+t).attr(`refX`,13).attr(`refY`,7).attr(`markerWidth`,190).attr(`markerHeight`,240).attr(`orient`,`auto`).append(`circle`).attr(`stroke`,`black`).attr(`fill`,`transparent`).attr(`cx`,7).attr(`cy`,7).attr(`r`,6),e.append(`defs`).append(`marker`).attr(`id`,n+`_`+t+`-lollipopEnd`).attr(`class`,`marker lollipop `+t).attr(`refX`,1).attr(`refY`,7).attr(`markerWidth`,190).attr(`markerHeight`,240).attr(`orient`,`auto`).append(`circle`).attr(`stroke`,`black`).attr(`fill`,`transparent`).attr(`cx`,7).attr(`cy`,7).attr(`r`,6)},`lollipop`),point:P((e,t,n)=>{e.append(`marker`).attr(`id`,n+`_`+t+`-pointEnd`).attr(`class`,`marker `+t).attr(`viewBox`,`0 0 10 10`).attr(`refX`,5).attr(`refY`,5).attr(`markerUnits`,`userSpaceOnUse`).attr(`markerWidth`,8).attr(`markerHeight`,8).attr(`orient`,`auto`).append(`path`).attr(`d`,`M 0 0 L 10 5 L 0 10 z`).attr(`class`,`arrowMarkerPath`).style(`stroke-width`,1).style(`stroke-dasharray`,`1,0`),e.append(`marker`).attr(`id`,n+`_`+t+`-pointStart`).attr(`class`,`marker `+t).attr(`viewBox`,`0 0 10 10`).attr(`refX`,4.5).attr(`refY`,5).attr(`markerUnits`,`userSpaceOnUse`).attr(`markerWidth`,8).attr(`markerHeight`,8).attr(`orient`,`auto`).append(`path`).attr(`d`,`M 0 5 L 10 10 L 10 0 z`).attr(`class`,`arrowMarkerPath`).style(`stroke-width`,1).style(`stroke-dasharray`,`1,0`)},`point`),circle:P((e,t,n)=>{e.append(`marker`).attr(`id`,n+`_`+t+`-circleEnd`).attr(`class`,`marker `+t).attr(`viewBox`,`0 0 10 10`).attr(`refX`,11).attr(`refY`,5).attr(`markerUnits`,`userSpaceOnUse`).attr(`markerWidth`,11).attr(`markerHeight`,11).attr(`orient`,`auto`).append(`circle`).attr(`cx`,`5`).attr(`cy`,`5`).attr(`r`,`5`).attr(`class`,`arrowMarkerPath`).style(`stroke-width`,1).style(`stroke-dasharray`,`1,0`),e.append(`marker`).attr(`id`,n+`_`+t+`-circleStart`).attr(`class`,`marker `+t).attr(`viewBox`,`0 0 10 10`).attr(`refX`,-1).attr(`refY`,5).attr(`markerUnits`,`userSpaceOnUse`).attr(`markerWidth`,11).attr(`markerHeight`,11).attr(`orient`,`auto`).append(`circle`).attr(`cx`,`5`).attr(`cy`,`5`).attr(`r`,`5`).attr(`class`,`arrowMarkerPath`).style(`stroke-width`,1).style(`stroke-dasharray`,`1,0`)},`circle`),cross:P((e,t,n)=>{e.append(`marker`).attr(`id`,n+`_`+t+`-crossEnd`).attr(`class`,`marker cross `+t).attr(`viewBox`,`0 0 11 11`).attr(`refX`,12).attr(`refY`,5.2).attr(`markerUnits`,`userSpaceOnUse`).attr(`markerWidth`,11).attr(`markerHeight`,11).attr(`orient`,`auto`).append(`path`).attr(`d`,`M 1,1 l 9,9 M 10,1 l -9,9`).attr(`class`,`arrowMarkerPath`).style(`stroke-width`,2).style(`stroke-dasharray`,`1,0`),e.append(`marker`).attr(`id`,n+`_`+t+`-crossStart`).attr(`class`,`marker cross `+t).attr(`viewBox`,`0 0 11 11`).attr(`refX`,-1).attr(`refY`,5.2).attr(`markerUnits`,`userSpaceOnUse`).attr(`markerWidth`,11).attr(`markerHeight`,11).attr(`orient`,`auto`).append(`path`).attr(`d`,`M 1,1 l 9,9 M 10,1 l -9,9`).attr(`class`,`arrowMarkerPath`).style(`stroke-width`,2).style(`stroke-dasharray`,`1,0`)},`cross`),barb:P((e,t,n)=>{e.append(`defs`).append(`marker`).attr(`id`,n+`_`+t+`-barbEnd`).attr(`refX`,19).attr(`refY`,7).attr(`markerWidth`,20).attr(`markerHeight`,14).attr(`markerUnits`,`userSpaceOnUse`).attr(`orient`,`auto`).append(`path`).attr(`d`,`M 19,7 L9,13 L14,7 L9,1 Z`)},`barb`),only_one:P((e,t,n)=>{e.append(`defs`).append(`marker`).attr(`id`,n+`_`+t+`-onlyOneStart`).attr(`class`,`marker onlyOne `+t).attr(`refX`,0).attr(`refY`,9).attr(`markerWidth`,18).attr(`markerHeight`,18).attr(`orient`,`auto`).append(`path`).attr(`d`,`M9,0 L9,18 M15,0 L15,18`),e.append(`defs`).append(`marker`).attr(`id`,n+`_`+t+`-onlyOneEnd`).attr(`class`,`marker onlyOne `+t).attr(`refX`,18).attr(`refY`,9).attr(`markerWidth`,18).attr(`markerHeight`,18).attr(`orient`,`auto`).append(`path`).attr(`d`,`M3,0 L3,18 M9,0 L9,18`)},`only_one`),zero_or_one:P((e,t,n)=>{let r=e.append(`defs`).append(`marker`).attr(`id`,n+`_`+t+`-zeroOrOneStart`).attr(`class`,`marker zeroOrOne `+t).attr(`refX`,0).attr(`refY`,9).attr(`markerWidth`,30).attr(`markerHeight`,18).attr(`orient`,`auto`);r.append(`circle`).attr(`fill`,`white`).attr(`cx`,21).attr(`cy`,9).attr(`r`,6),r.append(`path`).attr(`d`,`M9,0 L9,18`);let i=e.append(`defs`).append(`marker`).attr(`id`,n+`_`+t+`-zeroOrOneEnd`).attr(`class`,`marker zeroOrOne `+t).attr(`refX`,30).attr(`refY`,9).attr(`markerWidth`,30).attr(`markerHeight`,18).attr(`orient`,`auto`);i.append(`circle`).attr(`fill`,`white`).attr(`cx`,9).attr(`cy`,9).attr(`r`,6),i.append(`path`).attr(`d`,`M21,0 L21,18`)},`zero_or_one`),one_or_more:P((e,t,n)=>{e.append(`defs`).append(`marker`).attr(`id`,n+`_`+t+`-oneOrMoreStart`).attr(`class`,`marker oneOrMore `+t).attr(`refX`,18).attr(`refY`,18).attr(`markerWidth`,45).attr(`markerHeight`,36).attr(`orient`,`auto`).append(`path`).attr(`d`,`M0,18 Q 18,0 36,18 Q 18,36 0,18 M42,9 L42,27`),e.append(`defs`).append(`marker`).attr(`id`,n+`_`+t+`-oneOrMoreEnd`).attr(`class`,`marker oneOrMore `+t).attr(`refX`,27).attr(`refY`,18).attr(`markerWidth`,45).attr(`markerHeight`,36).attr(`orient`,`auto`).append(`path`).attr(`d`,`M3,9 L3,27 M9,18 Q27,0 45,18 Q27,36 9,18`)},`one_or_more`),zero_or_more:P((e,t,n)=>{let r=e.append(`defs`).append(`marker`).attr(`id`,n+`_`+t+`-zeroOrMoreStart`).attr(`class`,`marker zeroOrMore `+t).attr(`refX`,18).attr(`refY`,18).attr(`markerWidth`,57).attr(`markerHeight`,36).attr(`orient`,`auto`);r.append(`circle`).attr(`fill`,`white`).attr(`cx`,48).attr(`cy`,18).attr(`r`,6),r.append(`path`).attr(`d`,`M0,18 Q18,0 36,18 Q18,36 0,18`);let i=e.append(`defs`).append(`marker`).attr(`id`,n+`_`+t+`-zeroOrMoreEnd`).attr(`class`,`marker zeroOrMore `+t).attr(`refX`,39).attr(`refY`,18).attr(`markerWidth`,57).attr(`markerHeight`,36).attr(`orient`,`auto`);i.append(`circle`).attr(`fill`,`white`).attr(`cx`,9).attr(`cy`,18).attr(`r`,6),i.append(`path`).attr(`d`,`M21,18 Q39,0 57,18 Q39,36 21,18`)},`zero_or_more`),requirement_arrow:P((e,t,n)=>{e.append(`defs`).append(`marker`).attr(`id`,n+`_`+t+`-requirement_arrowEnd`).attr(`refX`,20).attr(`refY`,10).attr(`markerWidth`,20).attr(`markerHeight`,20).attr(`orient`,`auto`).append(`path`).attr(`d`,`M0,0
      L20,10
      M20,10
      L0,20`)},`requirement_arrow`),requirement_contains:P((e,t,n)=>{let r=e.append(`defs`).append(`marker`).attr(`id`,n+`_`+t+`-requirement_containsStart`).attr(`refX`,0).attr(`refY`,10).attr(`markerWidth`,20).attr(`markerHeight`,20).attr(`orient`,`auto`).append(`g`);r.append(`circle`).attr(`cx`,10).attr(`cy`,10).attr(`r`,9).attr(`fill`,`none`),r.append(`line`).attr(`x1`,1).attr(`x2`,19).attr(`y1`,10).attr(`y2`,10),r.append(`line`).attr(`y1`,1).attr(`y2`,19).attr(`x1`,10).attr(`x2`,10)},`requirement_contains`)},Fr=Nr,Ir={common:g,getConfig:T,insertCluster:ht,insertEdge:kr,insertEdgeLabel:yr,insertMarkers:Fr,insertNode:lr,interpolateToCurve:j,labelHelper:B,log:y,positionEdgeLabel:xr},Lr={},Rr=P(e=>{for(let t of e)Lr[t.name]=t},`registerLayoutLoaders`);P(()=>{Rr([{name:`dagre`,loader:P(async()=>await a(()=>import(`./vendor-mermaid.B3CZdIAj.chunk.js`),__vite__mapDeps([0,1,2,3,4,5,6])),`loader`)},{name:`cose-bilkent`,loader:P(async()=>await a(()=>import(`./vendor-mermaid.DqVWL8RZ.chunk.js`),__vite__mapDeps([7,1,2,8])),`loader`)}])},`registerDefaultLayoutLoaders`)();var zr=P(async(e,t)=>{if(!(e.layoutAlgorithm in Lr))throw Error(`Unknown layout algorithm: ${e.layoutAlgorithm}`);let n=Lr[e.layoutAlgorithm];return(await n.loader()).render(e,t,Ir,{algorithm:n.algorithm})},`render`),Br=P((e=``,{fallback:t=`dagre`}={})=>{if(e in Lr)return e;if(t in Lr)return y.warn(`Layout algorithm ${e} is not registered. Using ${t} as fallback.`),t;throw Error(`Both layout algorithms ${e} and ${t} are not registered.`)},`getRegisteredLayoutAlgorithm`);export{xr as a,yr as c,dr as d,sr as f,ht as g,gt as h,_r as i,V as l,lr as m,Br as n,kr as o,ur as p,Rr as r,Fr as s,zr as t,fr as u};