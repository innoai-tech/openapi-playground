import{G as e,H as t,J as n,N as r,Nt as i,S as a,_ as o,bt as s,c,dt as l,et as u,gt as d,hn as f,jt as p,ln as m,q as h,rt as g,s as _,x as v}from"./vendor-min-mermaid~architectureDiagram-4X3Z3J56.BpJofp52.chunk.js";import{A as y,C as b,D as x,K as S,L as C,M as w,N as T,Q as E,U as D,Y as O,q as k,z as A}from"./vendor-min-mermaid~architecture-U656AL7Q-3ZQKGQJL.j2WEiM7o.chunk.js";var j=`\0`,M=`\0`,ee=``,N=class{static{E(this,`Graph`)}constructor(e={}){this._isDirected=Object.prototype.hasOwnProperty.call(e,`directed`)?e.directed:!0,this._isMultigraph=Object.prototype.hasOwnProperty.call(e,`multigraph`)?e.multigraph:!1,this._isCompound=Object.prototype.hasOwnProperty.call(e,`compound`)?e.compound:!1,this._label=void 0,this._defaultNodeLabelFn=k(void 0),this._defaultEdgeLabelFn=k(void 0),this._nodes={},this._isCompound&&(this._parent={},this._children={},this._children[M]={}),this._in={},this._preds={},this._out={},this._sucs={},this._edgeObjs={},this._edgeLabels={}}isDirected(){return this._isDirected}isMultigraph(){return this._isMultigraph}isCompound(){return this._isCompound}setGraph(e){return this._label=e,this}graph(){return this._label}setDefaultNodeLabel(e){return O(e)||(e=k(e)),this._defaultNodeLabelFn=e,this}nodeCount(){return this._nodeCount}nodes(){return A(this._nodes)}sources(){var e=this;return C(this.nodes(),function(t){return S(e._in[t])})}sinks(){var e=this;return C(this.nodes(),function(t){return S(e._out[t])})}setNodes(e,t){var n=arguments,r=this;return w(e,function(e){n.length>1?r.setNode(e,t):r.setNode(e)}),this}setNode(e,t){return Object.prototype.hasOwnProperty.call(this._nodes,e)?(arguments.length>1&&(this._nodes[e]=t),this):(this._nodes[e]=arguments.length>1?t:this._defaultNodeLabelFn(e),this._isCompound&&(this._parent[e]=M,this._children[e]={},this._children[M][e]=!0),this._in[e]={},this._preds[e]={},this._out[e]={},this._sucs[e]={},++this._nodeCount,this)}node(e){return this._nodes[e]}hasNode(e){return Object.prototype.hasOwnProperty.call(this._nodes,e)}removeNode(e){if(Object.prototype.hasOwnProperty.call(this._nodes,e)){var t=E(e=>this.removeEdge(this._edgeObjs[e]),`removeEdge`);delete this._nodes[e],this._isCompound&&(this._removeFromParentsChildList(e),delete this._parent[e],w(this.children(e),e=>{this.setParent(e)}),delete this._children[e]),w(A(this._in[e]),t),delete this._in[e],delete this._preds[e],w(A(this._out[e]),t),delete this._out[e],delete this._sucs[e],--this._nodeCount}return this}setParent(e,t){if(!this._isCompound)throw Error(`Cannot set parent in a non-compound graph`);if(D(t))t=M;else{t+=``;for(var n=t;!D(n);n=this.parent(n))if(n===e)throw Error(`Setting `+t+` as parent of `+e+` would create a cycle`);this.setNode(t)}return this.setNode(e),this._removeFromParentsChildList(e),this._parent[e]=t,this._children[t][e]=!0,this}_removeFromParentsChildList(e){delete this._children[this._parent[e]][e]}parent(e){if(this._isCompound){var t=this._parent[e];if(t!==M)return t}}children(e){if(D(e)&&(e=M),this._isCompound){var t=this._children[e];if(t)return A(t)}else{if(e===M)return this.nodes();if(this.hasNode(e))return[]}}predecessors(e){var t=this._preds[e];if(t)return A(t)}successors(e){var t=this._sucs[e];if(t)return A(t)}neighbors(e){var t=this.predecessors(e);if(t)return b(t,this.successors(e))}isLeaf(e){var t;return t=this.isDirected()?this.successors(e):this.neighbors(e),t.length===0}filterNodes(e){var t=new this.constructor({directed:this._isDirected,multigraph:this._isMultigraph,compound:this._isCompound});t.setGraph(this.graph());var n=this;w(this._nodes,function(n,r){e(r)&&t.setNode(r,n)}),w(this._edgeObjs,function(e){t.hasNode(e.v)&&t.hasNode(e.w)&&t.setEdge(e,n.edge(e))});var r={};function i(e){var a=n.parent(e);return a===void 0||t.hasNode(a)?(r[e]=a,a):a in r?r[a]:i(a)}return E(i,`findParent`),this._isCompound&&w(t.nodes(),function(e){t.setParent(e,i(e))}),t}setDefaultEdgeLabel(e){return O(e)||(e=k(e)),this._defaultEdgeLabelFn=e,this}edgeCount(){return this._edgeCount}edges(){return y(this._edgeObjs)}setPath(e,t){var n=this,r=arguments;return x(e,function(e,i){return r.length>1?n.setEdge(e,i,t):n.setEdge(e,i),i}),this}setEdge(){var e,t,n,r,i=!1,a=arguments[0];typeof a==`object`&&a&&`v`in a?(e=a.v,t=a.w,n=a.name,arguments.length===2&&(r=arguments[1],i=!0)):(e=a,t=arguments[1],n=arguments[3],arguments.length>2&&(r=arguments[2],i=!0)),e=``+e,t=``+t,D(n)||(n=``+n);var o=P(this._isDirected,e,t,n);if(Object.prototype.hasOwnProperty.call(this._edgeLabels,o))return i&&(this._edgeLabels[o]=r),this;if(!D(n)&&!this._isMultigraph)throw Error(`Cannot set a named edge when isMultigraph = false`);this.setNode(e),this.setNode(t),this._edgeLabels[o]=i?r:this._defaultEdgeLabelFn(e,t,n);var s=re(this._isDirected,e,t,n);return e=s.v,t=s.w,Object.freeze(s),this._edgeObjs[o]=s,te(this._preds[t],e),te(this._sucs[e],t),this._in[t][o]=s,this._out[e][o]=s,this._edgeCount++,this}edge(e,t,n){var r=arguments.length===1?F(this._isDirected,arguments[0]):P(this._isDirected,e,t,n);return this._edgeLabels[r]}hasEdge(e,t,n){var r=arguments.length===1?F(this._isDirected,arguments[0]):P(this._isDirected,e,t,n);return Object.prototype.hasOwnProperty.call(this._edgeLabels,r)}removeEdge(e,t,n){var r=arguments.length===1?F(this._isDirected,arguments[0]):P(this._isDirected,e,t,n),i=this._edgeObjs[r];return i&&(e=i.v,t=i.w,delete this._edgeLabels[r],delete this._edgeObjs[r],ne(this._preds[t],e),ne(this._sucs[e],t),delete this._in[t][r],delete this._out[e][r],this._edgeCount--),this}inEdges(e,t){var n=this._in[e];if(n){var r=y(n);return t?C(r,function(e){return e.v===t}):r}}outEdges(e,t){var n=this._out[e];if(n){var r=y(n);return t?C(r,function(e){return e.w===t}):r}}nodeEdges(e,t){var n=this.inEdges(e,t);if(n)return n.concat(this.outEdges(e,t))}};N.prototype._nodeCount=0,N.prototype._edgeCount=0;function te(e,t){e[t]?e[t]++:e[t]=1}E(te,`incrementOrInitEntry`);function ne(e,t){--e[t]||delete e[t]}E(ne,`decrementOrRemoveEntry`);function P(e,t,n,r){var i=``+t,a=``+n;if(!e&&i>a){var o=i;i=a,a=o}return i+ee+a+ee+(D(r)?j:r)}E(P,`edgeArgsToId`);function re(e,t,n,r){var i=``+t,a=``+n;if(!e&&i>a){var o=i;i=a,a=o}var s={v:i,w:a};return r&&(s.name=r),s}E(re,`edgeArgsToObj`);function F(e,t){return P(e,t.v,t.w,t.name)}E(F,`edgeObjToId`);var ie=E(()=>`
  /* Font Awesome icon styling - consolidated */
  .label-icon {
    display: inline-block;
    height: 1em;
    overflow: visible;
    vertical-align: -0.125em;
  }
  
  .node .label-icon path {
    fill: currentColor;
    stroke: revert;
    stroke-width: revert;
  }
`,`getIconStyles`),I={aggregation:17.25,extension:17.25,composition:17.25,dependency:6,lollipop:13.5,arrow_point:4},ae={arrow_point:9,arrow_cross:12.5,arrow_circle:12.5};function L(e,t){if(e===void 0||t===void 0)return{angle:0,deltaX:0,deltaY:0};e=R(e),t=R(t);let[n,r]=[e.x,e.y],[i,a]=[t.x,t.y],o=i-n,s=a-r;return{angle:Math.atan(s/o),deltaX:o,deltaY:s}}E(L,`calculateDeltaAndAngle`);var R=E(e=>Array.isArray(e)?{x:e[0],y:e[1]}:e,`pointTransformer`),oe=E(e=>({x:E(function(t,n,r){let i=0,a=R(r[0]).x<R(r[r.length-1]).x?`left`:`right`;if(n===0&&Object.hasOwn(I,e.arrowTypeStart)){let{angle:t,deltaX:n}=L(r[0],r[1]);i=I[e.arrowTypeStart]*Math.cos(t)*(n>=0?1:-1)}else if(n===r.length-1&&Object.hasOwn(I,e.arrowTypeEnd)){let{angle:t,deltaX:n}=L(r[r.length-1],r[r.length-2]);i=I[e.arrowTypeEnd]*Math.cos(t)*(n>=0?1:-1)}let o=Math.abs(R(t).x-R(r[r.length-1]).x),s=Math.abs(R(t).y-R(r[r.length-1]).y),c=Math.abs(R(t).x-R(r[0]).x),l=Math.abs(R(t).y-R(r[0]).y),u=I[e.arrowTypeStart],d=I[e.arrowTypeEnd];if(o<d&&o>0&&s<d){let e=d+1-o;e*=a===`right`?-1:1,i-=e}if(c<u&&c>0&&l<u){let e=u+1-c;e*=a===`right`?-1:1,i+=e}return R(t).x+i},`x`),y:E(function(t,n,r){let i=0,a=R(r[0]).y<R(r[r.length-1]).y?`down`:`up`;if(n===0&&Object.hasOwn(I,e.arrowTypeStart)){let{angle:t,deltaY:n}=L(r[0],r[1]);i=I[e.arrowTypeStart]*Math.abs(Math.sin(t))*(n>=0?1:-1)}else if(n===r.length-1&&Object.hasOwn(I,e.arrowTypeEnd)){let{angle:t,deltaY:n}=L(r[r.length-1],r[r.length-2]);i=I[e.arrowTypeEnd]*Math.abs(Math.sin(t))*(n>=0?1:-1)}let o=Math.abs(R(t).y-R(r[r.length-1]).y),s=Math.abs(R(t).x-R(r[r.length-1]).x),c=Math.abs(R(t).y-R(r[0]).y),l=Math.abs(R(t).x-R(r[0]).x),u=I[e.arrowTypeStart],d=I[e.arrowTypeEnd];if(o<d&&o>0&&s<d){let e=d+1-o;e*=a===`up`?-1:1,i-=e}if(c<u&&c>0&&l<u){let e=u+1-c;e*=a===`up`?-1:1,i+=e}return R(t).y+i},`y`)}),`getLineFunctionsWithOffset`),se=E(({flowchart:e})=>{let t=e?.subGraphTitleMargin?.top??0,n=e?.subGraphTitleMargin?.bottom??0;return{subGraphTitleTopMargin:t,subGraphTitleBottomMargin:n,subGraphTitleTotalMargin:t+n}},`getSubGraphTitleMargins`),ce=function(){var e=E(function(e,t,n,r){for(n||={},r=e.length;r--;n[e[r]]=t);return n},`o`),t=[1,15],n=[1,7],r=[1,13],i=[1,14],a=[1,19],o=[1,16],s=[1,17],c=[1,18],l=[8,30],u=[8,10,21,28,29,30,31,39,43,46],d=[1,23],f=[1,24],p=[8,10,15,16,21,28,29,30,31,39,43,46],m=[8,10,15,16,21,27,28,29,30,31,39,43,46],h=[1,49],g={trace:E(function(){},`trace`),yy:{},symbols_:{error:2,spaceLines:3,SPACELINE:4,NL:5,separator:6,SPACE:7,EOF:8,start:9,BLOCK_DIAGRAM_KEY:10,document:11,stop:12,statement:13,link:14,LINK:15,START_LINK:16,LINK_LABEL:17,STR:18,nodeStatement:19,columnsStatement:20,SPACE_BLOCK:21,blockStatement:22,classDefStatement:23,cssClassStatement:24,styleStatement:25,node:26,SIZE:27,COLUMNS:28,"id-block":29,end:30,NODE_ID:31,nodeShapeNLabel:32,dirList:33,DIR:34,NODE_DSTART:35,NODE_DEND:36,BLOCK_ARROW_START:37,BLOCK_ARROW_END:38,classDef:39,CLASSDEF_ID:40,CLASSDEF_STYLEOPTS:41,DEFAULT:42,class:43,CLASSENTITY_IDS:44,STYLECLASS:45,style:46,STYLE_ENTITY_IDS:47,STYLE_DEFINITION_DATA:48,$accept:0,$end:1},terminals_:{2:`error`,4:`SPACELINE`,5:`NL`,7:`SPACE`,8:`EOF`,10:`BLOCK_DIAGRAM_KEY`,15:`LINK`,16:`START_LINK`,17:`LINK_LABEL`,18:`STR`,21:`SPACE_BLOCK`,27:`SIZE`,28:`COLUMNS`,29:`id-block`,30:`end`,31:`NODE_ID`,34:`DIR`,35:`NODE_DSTART`,36:`NODE_DEND`,37:`BLOCK_ARROW_START`,38:`BLOCK_ARROW_END`,39:`classDef`,40:`CLASSDEF_ID`,41:`CLASSDEF_STYLEOPTS`,42:`DEFAULT`,43:`class`,44:`CLASSENTITY_IDS`,45:`STYLECLASS`,46:`style`,47:`STYLE_ENTITY_IDS`,48:`STYLE_DEFINITION_DATA`},productions_:[0,[3,1],[3,2],[3,2],[6,1],[6,1],[6,1],[9,3],[12,1],[12,1],[12,2],[12,2],[11,1],[11,2],[14,1],[14,4],[13,1],[13,1],[13,1],[13,1],[13,1],[13,1],[13,1],[19,3],[19,2],[19,1],[20,1],[22,4],[22,3],[26,1],[26,2],[33,1],[33,2],[32,3],[32,4],[23,3],[23,3],[24,3],[25,3]],performAction:E(function(e,t,n,r,i,a,o){var s=a.length-1;switch(i){case 4:r.getLogger().debug(`Rule: separator (NL) `);break;case 5:r.getLogger().debug(`Rule: separator (Space) `);break;case 6:r.getLogger().debug(`Rule: separator (EOF) `);break;case 7:r.getLogger().debug(`Rule: hierarchy: `,a[s-1]),r.setHierarchy(a[s-1]);break;case 8:r.getLogger().debug(`Stop NL `);break;case 9:r.getLogger().debug(`Stop EOF `);break;case 10:r.getLogger().debug(`Stop NL2 `);break;case 11:r.getLogger().debug(`Stop EOF2 `);break;case 12:r.getLogger().debug(`Rule: statement: `,a[s]),typeof a[s].length==`number`?this.$=a[s]:this.$=[a[s]];break;case 13:r.getLogger().debug(`Rule: statement #2: `,a[s-1]),this.$=[a[s-1]].concat(a[s]);break;case 14:r.getLogger().debug(`Rule: link: `,a[s],e),this.$={edgeTypeStr:a[s],label:``};break;case 15:r.getLogger().debug(`Rule: LABEL link: `,a[s-3],a[s-1],a[s]),this.$={edgeTypeStr:a[s],label:a[s-1]};break;case 18:let t=parseInt(a[s]);this.$={id:r.generateId(),type:`space`,label:``,width:t,children:[]};break;case 23:r.getLogger().debug(`Rule: (nodeStatement link node) `,a[s-2],a[s-1],a[s],` typestr: `,a[s-1].edgeTypeStr);let n=r.edgeStrToEdgeData(a[s-1].edgeTypeStr);this.$=[{id:a[s-2].id,label:a[s-2].label,type:a[s-2].type,directions:a[s-2].directions},{id:a[s-2].id+`-`+a[s].id,start:a[s-2].id,end:a[s].id,label:a[s-1].label,type:`edge`,directions:a[s].directions,arrowTypeEnd:n,arrowTypeStart:`arrow_open`},{id:a[s].id,label:a[s].label,type:r.typeStr2Type(a[s].typeStr),directions:a[s].directions}];break;case 24:r.getLogger().debug(`Rule: nodeStatement (abc88 node size) `,a[s-1],a[s]),this.$={id:a[s-1].id,label:a[s-1].label,type:r.typeStr2Type(a[s-1].typeStr),directions:a[s-1].directions,widthInColumns:parseInt(a[s],10)};break;case 25:r.getLogger().debug(`Rule: nodeStatement (node) `,a[s]),this.$={id:a[s].id,label:a[s].label,type:r.typeStr2Type(a[s].typeStr),directions:a[s].directions,widthInColumns:1};break;case 26:r.getLogger().debug(`APA123`,this?this:`na`),r.getLogger().debug(`COLUMNS: `,a[s]),this.$={type:`column-setting`,columns:a[s]===`auto`?-1:parseInt(a[s])};break;case 27:r.getLogger().debug(`Rule: id-block statement : `,a[s-2],a[s-1]),r.generateId(),this.$={...a[s-2],type:`composite`,children:a[s-1]};break;case 28:r.getLogger().debug(`Rule: blockStatement : `,a[s-2],a[s-1],a[s]),this.$={id:r.generateId(),type:`composite`,label:``,children:a[s-1]};break;case 29:r.getLogger().debug(`Rule: node (NODE_ID separator): `,a[s]),this.$={id:a[s]};break;case 30:r.getLogger().debug(`Rule: node (NODE_ID nodeShapeNLabel separator): `,a[s-1],a[s]),this.$={id:a[s-1],label:a[s].label,typeStr:a[s].typeStr,directions:a[s].directions};break;case 31:r.getLogger().debug(`Rule: dirList: `,a[s]),this.$=[a[s]];break;case 32:r.getLogger().debug(`Rule: dirList: `,a[s-1],a[s]),this.$=[a[s-1]].concat(a[s]);break;case 33:r.getLogger().debug(`Rule: nodeShapeNLabel: `,a[s-2],a[s-1],a[s]),this.$={typeStr:a[s-2]+a[s],label:a[s-1]};break;case 34:r.getLogger().debug(`Rule: BLOCK_ARROW nodeShapeNLabel: `,a[s-3],a[s-2],` #3:`,a[s-1],a[s]),this.$={typeStr:a[s-3]+a[s],label:a[s-2],directions:a[s-1]};break;case 35:case 36:this.$={type:`classDef`,id:a[s-1].trim(),css:a[s].trim()};break;case 37:this.$={type:`applyClass`,id:a[s-1].trim(),styleClass:a[s].trim()};break;case 38:this.$={type:`applyStyles`,id:a[s-1].trim(),stylesStr:a[s].trim()};break}},`anonymous`),table:[{9:1,10:[1,2]},{1:[3]},{10:t,11:3,13:4,19:5,20:6,21:n,22:8,23:9,24:10,25:11,26:12,28:r,29:i,31:a,39:o,43:s,46:c},{8:[1,20]},e(l,[2,12],{13:4,19:5,20:6,22:8,23:9,24:10,25:11,26:12,11:21,10:t,21:n,28:r,29:i,31:a,39:o,43:s,46:c}),e(u,[2,16],{14:22,15:d,16:f}),e(u,[2,17]),e(u,[2,18]),e(u,[2,19]),e(u,[2,20]),e(u,[2,21]),e(u,[2,22]),e(p,[2,25],{27:[1,25]}),e(u,[2,26]),{19:26,26:12,31:a},{10:t,11:27,13:4,19:5,20:6,21:n,22:8,23:9,24:10,25:11,26:12,28:r,29:i,31:a,39:o,43:s,46:c},{40:[1,28],42:[1,29]},{44:[1,30]},{47:[1,31]},e(m,[2,29],{32:32,35:[1,33],37:[1,34]}),{1:[2,7]},e(l,[2,13]),{26:35,31:a},{31:[2,14]},{17:[1,36]},e(p,[2,24]),{10:t,11:37,13:4,14:22,15:d,16:f,19:5,20:6,21:n,22:8,23:9,24:10,25:11,26:12,28:r,29:i,31:a,39:o,43:s,46:c},{30:[1,38]},{41:[1,39]},{41:[1,40]},{45:[1,41]},{48:[1,42]},e(m,[2,30]),{18:[1,43]},{18:[1,44]},e(p,[2,23]),{18:[1,45]},{30:[1,46]},e(u,[2,28]),e(u,[2,35]),e(u,[2,36]),e(u,[2,37]),e(u,[2,38]),{36:[1,47]},{33:48,34:h},{15:[1,50]},e(u,[2,27]),e(m,[2,33]),{38:[1,51]},{33:52,34:h,38:[2,31]},{31:[2,15]},e(m,[2,34]),{38:[2,32]}],defaultActions:{20:[2,7],23:[2,14],50:[2,15],52:[2,32]},parseError:E(function(e,t){if(t.recoverable)this.trace(e);else{var n=Error(e);throw n.hash=t,n}},`parseError`),parse:E(function(e){var t=this,n=[0],r=[],i=[null],a=[],o=this.table,s=``,c=0,l=0,u=0,d=2,f=1,p=a.slice.call(arguments,1),m=Object.create(this.lexer),h={yy:{}};for(var g in this.yy)Object.prototype.hasOwnProperty.call(this.yy,g)&&(h.yy[g]=this.yy[g]);m.setInput(e,h.yy),h.yy.lexer=m,h.yy.parser=this,typeof m.yylloc>`u`&&(m.yylloc={});var _=m.yylloc;a.push(_);var v=m.options&&m.options.ranges;typeof h.yy.parseError==`function`?this.parseError=h.yy.parseError:this.parseError=Object.getPrototypeOf(this).parseError;function y(e){n.length-=2*e,i.length-=e,a.length-=e}E(y,`popStack`);function b(){var e;return e=r.pop()||m.lex()||f,typeof e!=`number`&&(e instanceof Array&&(r=e,e=r.pop()),e=t.symbols_[e]||e),e}E(b,`lex`);for(var x,S,C,w,T,D={},O,k,A,j;;){if(C=n[n.length-1],this.defaultActions[C]?w=this.defaultActions[C]:((x===null||typeof x>`u`)&&(x=b()),w=o[C]&&o[C][x]),typeof w>`u`||!w.length||!w[0]){var M=``;for(O in j=[],o[C])this.terminals_[O]&&O>d&&j.push(`'`+this.terminals_[O]+`'`);M=m.showPosition?`Parse error on line `+(c+1)+`:
`+m.showPosition()+`
Expecting `+j.join(`, `)+`, got '`+(this.terminals_[x]||x)+`'`:`Parse error on line `+(c+1)+`: Unexpected `+(x==f?`end of input`:`'`+(this.terminals_[x]||x)+`'`),this.parseError(M,{text:m.match,token:this.terminals_[x]||x,line:m.yylineno,loc:_,expected:j})}if(w[0]instanceof Array&&w.length>1)throw Error(`Parse Error: multiple actions possible at state: `+C+`, token: `+x);switch(w[0]){case 1:n.push(x),i.push(m.yytext),a.push(m.yylloc),n.push(w[1]),x=null,S?(x=S,S=null):(l=m.yyleng,s=m.yytext,c=m.yylineno,_=m.yylloc,u>0&&u--);break;case 2:if(k=this.productions_[w[1]][1],D.$=i[i.length-k],D._$={first_line:a[a.length-(k||1)].first_line,last_line:a[a.length-1].last_line,first_column:a[a.length-(k||1)].first_column,last_column:a[a.length-1].last_column},v&&(D._$.range=[a[a.length-(k||1)].range[0],a[a.length-1].range[1]]),T=this.performAction.apply(D,[s,l,c,h.yy,w[1],i,a].concat(p)),typeof T<`u`)return T;k&&(n=n.slice(0,-1*k*2),i=i.slice(0,-1*k),a=a.slice(0,-1*k)),n.push(this.productions_[w[1]][0]),i.push(D.$),a.push(D._$),A=o[n[n.length-2]][n[n.length-1]],n.push(A);break;case 3:return!0}}return!0},`parse`)};g.lexer=function(){return{EOF:1,parseError:E(function(e,t){if(this.yy.parser)this.yy.parser.parseError(e,t);else throw Error(e)},`parseError`),setInput:E(function(e,t){return this.yy=t||this.yy||{},this._input=e,this._more=this._backtrack=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match=``,this.conditionStack=[`INITIAL`],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},`setInput`),input:E(function(){var e=this._input[0];return this.yytext+=e,this.yyleng++,this.offset++,this.match+=e,this.matched+=e,e.match(/(?:\r\n?|\n).*/g)?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),e},`input`),unput:E(function(e){var t=e.length,n=e.split(/(?:\r\n?|\n)/g);this._input=e+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-t),this.offset-=t;var r=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),n.length-1&&(this.yylineno-=n.length-1);var i=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:n?(n.length===r.length?this.yylloc.first_column:0)+r[r.length-n.length].length-n[0].length:this.yylloc.first_column-t},this.options.ranges&&(this.yylloc.range=[i[0],i[0]+this.yyleng-t]),this.yyleng=this.yytext.length,this},`unput`),more:E(function(){return this._more=!0,this},`more`),reject:E(function(){if(this.options.backtrack_lexer)this._backtrack=!0;else return this.parseError(`Lexical error on line `+(this.yylineno+1)+`. You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).
`+this.showPosition(),{text:``,token:null,line:this.yylineno});return this},`reject`),less:E(function(e){this.unput(this.match.slice(e))},`less`),pastInput:E(function(){var e=this.matched.substr(0,this.matched.length-this.match.length);return(e.length>20?`...`:``)+e.substr(-20).replace(/\n/g,``)},`pastInput`),upcomingInput:E(function(){var e=this.match;return e.length<20&&(e+=this._input.substr(0,20-e.length)),(e.substr(0,20)+(e.length>20?`...`:``)).replace(/\n/g,``)},`upcomingInput`),showPosition:E(function(){var e=this.pastInput(),t=Array(e.length+1).join(`-`);return e+this.upcomingInput()+`
`+t+`^`},`showPosition`),test_match:E(function(e,t){var n,r,i;if(this.options.backtrack_lexer&&(i={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done},this.options.ranges&&(i.yylloc.range=this.yylloc.range.slice(0))),r=e[0].match(/(?:\r\n?|\n).*/g),r&&(this.yylineno+=r.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:r?r[r.length-1].length-r[r.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+e[0].length},this.yytext+=e[0],this.match+=e[0],this.matches=e,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._backtrack=!1,this._input=this._input.slice(e[0].length),this.matched+=e[0],n=this.performAction.call(this,this.yy,this,t,this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),n)return n;if(this._backtrack){for(var a in i)this[a]=i[a];return!1}return!1},`test_match`),next:E(function(){if(this.done)return this.EOF;this._input||(this.done=!0);var e,t,n,r;this._more||(this.yytext=``,this.match=``);for(var i=this._currentRules(),a=0;a<i.length;a++)if(n=this._input.match(this.rules[i[a]]),n&&(!t||n[0].length>t[0].length)){if(t=n,r=a,this.options.backtrack_lexer){if(e=this.test_match(n,i[a]),e!==!1)return e;if(this._backtrack){t=!1;continue}else return!1}else if(!this.options.flex)break}return t?(e=this.test_match(t,i[r]),e===!1?!1:e):this._input===``?this.EOF:this.parseError(`Lexical error on line `+(this.yylineno+1)+`. Unrecognized text.
`+this.showPosition(),{text:``,token:null,line:this.yylineno})},`next`),lex:E(function(){return this.next()||this.lex()},`lex`),begin:E(function(e){this.conditionStack.push(e)},`begin`),popState:E(function(){return this.conditionStack.length-1>0?this.conditionStack.pop():this.conditionStack[0]},`popState`),_currentRules:E(function(){return this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]?this.conditions[this.conditionStack[this.conditionStack.length-1]].rules:this.conditions.INITIAL.rules},`_currentRules`),topState:E(function(e){return e=this.conditionStack.length-1-Math.abs(e||0),e>=0?this.conditionStack[e]:`INITIAL`},`topState`),pushState:E(function(e){this.begin(e)},`pushState`),stateStackSize:E(function(){return this.conditionStack.length},`stateStackSize`),options:{},performAction:E(function(e,t,n,r){switch(n){case 0:return e.getLogger().debug(`Found block-beta`),10;case 1:return e.getLogger().debug(`Found id-block`),29;case 2:return e.getLogger().debug(`Found block`),10;case 3:e.getLogger().debug(`.`,t.yytext);break;case 4:e.getLogger().debug(`_`,t.yytext);break;case 5:return 5;case 6:return t.yytext=-1,28;case 7:return t.yytext=t.yytext.replace(/columns\s+/,``),e.getLogger().debug(`COLUMNS (LEX)`,t.yytext),28;case 8:this.pushState(`md_string`);break;case 9:return`MD_STR`;case 10:this.popState();break;case 11:this.pushState(`string`);break;case 12:e.getLogger().debug(`LEX: POPPING STR:`,t.yytext),this.popState();break;case 13:return e.getLogger().debug(`LEX: STR end:`,t.yytext),`STR`;case 14:return t.yytext=t.yytext.replace(/space\:/,``),e.getLogger().debug(`SPACE NUM (LEX)`,t.yytext),21;case 15:return t.yytext=`1`,e.getLogger().debug(`COLUMNS (LEX)`,t.yytext),21;case 16:return 42;case 17:return`LINKSTYLE`;case 18:return`INTERPOLATE`;case 19:return this.pushState(`CLASSDEF`),39;case 20:return this.popState(),this.pushState(`CLASSDEFID`),`DEFAULT_CLASSDEF_ID`;case 21:return this.popState(),this.pushState(`CLASSDEFID`),40;case 22:return this.popState(),41;case 23:return this.pushState(`CLASS`),43;case 24:return this.popState(),this.pushState(`CLASS_STYLE`),44;case 25:return this.popState(),45;case 26:return this.pushState(`STYLE_STMNT`),46;case 27:return this.popState(),this.pushState(`STYLE_DEFINITION`),47;case 28:return this.popState(),48;case 29:return this.pushState(`acc_title`),`acc_title`;case 30:return this.popState(),`acc_title_value`;case 31:return this.pushState(`acc_descr`),`acc_descr`;case 32:return this.popState(),`acc_descr_value`;case 33:this.pushState(`acc_descr_multiline`);break;case 34:this.popState();break;case 35:return`acc_descr_multiline_value`;case 36:return 30;case 37:return this.popState(),e.getLogger().debug(`Lex: ((`),`NODE_DEND`;case 38:return this.popState(),e.getLogger().debug(`Lex: ((`),`NODE_DEND`;case 39:return this.popState(),e.getLogger().debug(`Lex: ))`),`NODE_DEND`;case 40:return this.popState(),e.getLogger().debug(`Lex: ((`),`NODE_DEND`;case 41:return this.popState(),e.getLogger().debug(`Lex: ((`),`NODE_DEND`;case 42:return this.popState(),e.getLogger().debug(`Lex: (-`),`NODE_DEND`;case 43:return this.popState(),e.getLogger().debug(`Lex: -)`),`NODE_DEND`;case 44:return this.popState(),e.getLogger().debug(`Lex: ((`),`NODE_DEND`;case 45:return this.popState(),e.getLogger().debug(`Lex: ]]`),`NODE_DEND`;case 46:return this.popState(),e.getLogger().debug(`Lex: (`),`NODE_DEND`;case 47:return this.popState(),e.getLogger().debug(`Lex: ])`),`NODE_DEND`;case 48:return this.popState(),e.getLogger().debug(`Lex: /]`),`NODE_DEND`;case 49:return this.popState(),e.getLogger().debug(`Lex: /]`),`NODE_DEND`;case 50:return this.popState(),e.getLogger().debug(`Lex: )]`),`NODE_DEND`;case 51:return this.popState(),e.getLogger().debug(`Lex: )`),`NODE_DEND`;case 52:return this.popState(),e.getLogger().debug(`Lex: ]>`),`NODE_DEND`;case 53:return this.popState(),e.getLogger().debug(`Lex: ]`),`NODE_DEND`;case 54:return e.getLogger().debug(`Lexa: -)`),this.pushState(`NODE`),35;case 55:return e.getLogger().debug(`Lexa: (-`),this.pushState(`NODE`),35;case 56:return e.getLogger().debug(`Lexa: ))`),this.pushState(`NODE`),35;case 57:return e.getLogger().debug(`Lexa: )`),this.pushState(`NODE`),35;case 58:return e.getLogger().debug(`Lex: (((`),this.pushState(`NODE`),35;case 59:return e.getLogger().debug(`Lexa: )`),this.pushState(`NODE`),35;case 60:return e.getLogger().debug(`Lexa: )`),this.pushState(`NODE`),35;case 61:return e.getLogger().debug(`Lexa: )`),this.pushState(`NODE`),35;case 62:return e.getLogger().debug(`Lexc: >`),this.pushState(`NODE`),35;case 63:return e.getLogger().debug(`Lexa: ([`),this.pushState(`NODE`),35;case 64:return e.getLogger().debug(`Lexa: )`),this.pushState(`NODE`),35;case 65:return this.pushState(`NODE`),35;case 66:return this.pushState(`NODE`),35;case 67:return this.pushState(`NODE`),35;case 68:return this.pushState(`NODE`),35;case 69:return this.pushState(`NODE`),35;case 70:return this.pushState(`NODE`),35;case 71:return this.pushState(`NODE`),35;case 72:return e.getLogger().debug(`Lexa: [`),this.pushState(`NODE`),35;case 73:return this.pushState(`BLOCK_ARROW`),e.getLogger().debug(`LEX ARR START`),37;case 74:return e.getLogger().debug(`Lex: NODE_ID`,t.yytext),31;case 75:return e.getLogger().debug(`Lex: EOF`,t.yytext),8;case 76:this.pushState(`md_string`);break;case 77:this.pushState(`md_string`);break;case 78:return`NODE_DESCR`;case 79:this.popState();break;case 80:e.getLogger().debug(`Lex: Starting string`),this.pushState(`string`);break;case 81:e.getLogger().debug(`LEX ARR: Starting string`),this.pushState(`string`);break;case 82:return e.getLogger().debug(`LEX: NODE_DESCR:`,t.yytext),`NODE_DESCR`;case 83:e.getLogger().debug(`LEX POPPING`),this.popState();break;case 84:e.getLogger().debug(`Lex: =>BAE`),this.pushState(`ARROW_DIR`);break;case 85:return t.yytext=t.yytext.replace(/^,\s*/,``),e.getLogger().debug(`Lex (right): dir:`,t.yytext),`DIR`;case 86:return t.yytext=t.yytext.replace(/^,\s*/,``),e.getLogger().debug(`Lex (left):`,t.yytext),`DIR`;case 87:return t.yytext=t.yytext.replace(/^,\s*/,``),e.getLogger().debug(`Lex (x):`,t.yytext),`DIR`;case 88:return t.yytext=t.yytext.replace(/^,\s*/,``),e.getLogger().debug(`Lex (y):`,t.yytext),`DIR`;case 89:return t.yytext=t.yytext.replace(/^,\s*/,``),e.getLogger().debug(`Lex (up):`,t.yytext),`DIR`;case 90:return t.yytext=t.yytext.replace(/^,\s*/,``),e.getLogger().debug(`Lex (down):`,t.yytext),`DIR`;case 91:return t.yytext=`]>`,e.getLogger().debug(`Lex (ARROW_DIR end):`,t.yytext),this.popState(),this.popState(),`BLOCK_ARROW_END`;case 92:return e.getLogger().debug(`Lex: LINK`,`#`+t.yytext+`#`),15;case 93:return e.getLogger().debug(`Lex: LINK`,t.yytext),15;case 94:return e.getLogger().debug(`Lex: LINK`,t.yytext),15;case 95:return e.getLogger().debug(`Lex: LINK`,t.yytext),15;case 96:return e.getLogger().debug(`Lex: START_LINK`,t.yytext),this.pushState(`LLABEL`),16;case 97:return e.getLogger().debug(`Lex: START_LINK`,t.yytext),this.pushState(`LLABEL`),16;case 98:return e.getLogger().debug(`Lex: START_LINK`,t.yytext),this.pushState(`LLABEL`),16;case 99:this.pushState(`md_string`);break;case 100:return e.getLogger().debug(`Lex: Starting string`),this.pushState(`string`),`LINK_LABEL`;case 101:return this.popState(),e.getLogger().debug(`Lex: LINK`,`#`+t.yytext+`#`),15;case 102:return this.popState(),e.getLogger().debug(`Lex: LINK`,t.yytext),15;case 103:return this.popState(),e.getLogger().debug(`Lex: LINK`,t.yytext),15;case 104:return e.getLogger().debug(`Lex: COLON`,t.yytext),t.yytext=t.yytext.slice(1),27}},`anonymous`),rules:[/^(?:block-beta\b)/,/^(?:block:)/,/^(?:block\b)/,/^(?:[\s]+)/,/^(?:[\n]+)/,/^(?:((\u000D\u000A)|(\u000A)))/,/^(?:columns\s+auto\b)/,/^(?:columns\s+[\d]+)/,/^(?:["][`])/,/^(?:[^`"]+)/,/^(?:[`]["])/,/^(?:["])/,/^(?:["])/,/^(?:[^"]*)/,/^(?:space[:]\d+)/,/^(?:space\b)/,/^(?:default\b)/,/^(?:linkStyle\b)/,/^(?:interpolate\b)/,/^(?:classDef\s+)/,/^(?:DEFAULT\s+)/,/^(?:\w+\s+)/,/^(?:[^\n]*)/,/^(?:class\s+)/,/^(?:(\w+)+((,\s*\w+)*))/,/^(?:[^\n]*)/,/^(?:style\s+)/,/^(?:(\w+)+((,\s*\w+)*))/,/^(?:[^\n]*)/,/^(?:accTitle\s*:\s*)/,/^(?:(?!\n||)*[^\n]*)/,/^(?:accDescr\s*:\s*)/,/^(?:(?!\n||)*[^\n]*)/,/^(?:accDescr\s*\{\s*)/,/^(?:[\}])/,/^(?:[^\}]*)/,/^(?:end\b\s*)/,/^(?:\(\(\()/,/^(?:\)\)\))/,/^(?:[\)]\))/,/^(?:\}\})/,/^(?:\})/,/^(?:\(-)/,/^(?:-\))/,/^(?:\(\()/,/^(?:\]\])/,/^(?:\()/,/^(?:\]\))/,/^(?:\\\])/,/^(?:\/\])/,/^(?:\)\])/,/^(?:[\)])/,/^(?:\]>)/,/^(?:[\]])/,/^(?:-\))/,/^(?:\(-)/,/^(?:\)\))/,/^(?:\))/,/^(?:\(\(\()/,/^(?:\(\()/,/^(?:\{\{)/,/^(?:\{)/,/^(?:>)/,/^(?:\(\[)/,/^(?:\()/,/^(?:\[\[)/,/^(?:\[\|)/,/^(?:\[\()/,/^(?:\)\)\))/,/^(?:\[\\)/,/^(?:\[\/)/,/^(?:\[\\)/,/^(?:\[)/,/^(?:<\[)/,/^(?:[^\(\[\n\-\)\{\}\s\<\>:]+)/,/^(?:$)/,/^(?:["][`])/,/^(?:["][`])/,/^(?:[^`"]+)/,/^(?:[`]["])/,/^(?:["])/,/^(?:["])/,/^(?:[^"]+)/,/^(?:["])/,/^(?:\]>\s*\()/,/^(?:,?\s*right\s*)/,/^(?:,?\s*left\s*)/,/^(?:,?\s*x\s*)/,/^(?:,?\s*y\s*)/,/^(?:,?\s*up\s*)/,/^(?:,?\s*down\s*)/,/^(?:\)\s*)/,/^(?:\s*[xo<]?--+[-xo>]\s*)/,/^(?:\s*[xo<]?==+[=xo>]\s*)/,/^(?:\s*[xo<]?-?\.+-[xo>]?\s*)/,/^(?:\s*~~[\~]+\s*)/,/^(?:\s*[xo<]?--\s*)/,/^(?:\s*[xo<]?==\s*)/,/^(?:\s*[xo<]?-\.\s*)/,/^(?:["][`])/,/^(?:["])/,/^(?:\s*[xo<]?--+[-xo>]\s*)/,/^(?:\s*[xo<]?==+[=xo>]\s*)/,/^(?:\s*[xo<]?-?\.+-[xo>]?\s*)/,/^(?::\d+)/],conditions:{STYLE_DEFINITION:{rules:[28],inclusive:!1},STYLE_STMNT:{rules:[27],inclusive:!1},CLASSDEFID:{rules:[22],inclusive:!1},CLASSDEF:{rules:[20,21],inclusive:!1},CLASS_STYLE:{rules:[25],inclusive:!1},CLASS:{rules:[24],inclusive:!1},LLABEL:{rules:[99,100,101,102,103],inclusive:!1},ARROW_DIR:{rules:[85,86,87,88,89,90,91],inclusive:!1},BLOCK_ARROW:{rules:[76,81,84],inclusive:!1},NODE:{rules:[37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,77,80],inclusive:!1},md_string:{rules:[9,10,78,79],inclusive:!1},space:{rules:[],inclusive:!1},string:{rules:[12,13,82,83],inclusive:!1},acc_descr_multiline:{rules:[34,35],inclusive:!1},acc_descr:{rules:[32],inclusive:!1},acc_title:{rules:[30],inclusive:!1},INITIAL:{rules:[0,1,2,3,4,5,6,7,8,11,14,15,16,17,18,19,23,26,29,31,33,36,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,92,93,94,95,96,97,98,104],inclusive:!0}}}}();function _(){this.yy={}}return E(_,`Parser`),_.prototype=g,g.Parser=_,new _}();ce.parser=ce;var le=ce,z=new Map,ue=[],de=new Map,fe=`color`,pe=`fill`,me=`bgFill`,he=`,`,ge=d(),B=new Map,_e=E(e=>l.sanitizeText(e,ge),`sanitizeText`),ve=E(function(e,t=``){let n=B.get(e);n||(n={id:e,styles:[],textStyles:[]},B.set(e,n)),t?.split(he).forEach(e=>{let t=e.replace(/([^;]*);/,`$1`).trim();if(RegExp(fe).exec(e)){let e=t.replace(pe,me).replace(fe,pe);n.textStyles.push(e)}n.styles.push(t)})},`addStyleClass`),ye=E(function(e,t=``){let n=z.get(e);t!=null&&(n.styles=t.split(he))},`addStyle2Node`),be=E(function(e,t){e.split(`,`).forEach(function(e){let n=z.get(e);if(n===void 0){let t=e.trim();n={id:t,type:`na`,children:[]},z.set(t,n)}n.classes||=[],n.classes.push(t)})},`setCssClass`),xe=E((e,t)=>{let n=e.flat(),r=[],i=n.find(e=>e?.type===`column-setting`)?.columns??-1;for(let e of n){if(typeof i==`number`&&i>0&&e.type!==`column-setting`&&typeof e.widthInColumns==`number`&&e.widthInColumns>i&&f.warn(`Block ${e.id} width ${e.widthInColumns} exceeds configured column width ${i}`),e.label&&=_e(e.label),e.type===`classDef`){ve(e.id,e.css);continue}if(e.type===`applyClass`){be(e.id,e?.styleClass??``);continue}if(e.type===`applyStyles`){e?.stylesStr&&ye(e.id,e?.stylesStr);continue}if(e.type===`column-setting`)t.columns=e.columns??-1;else if(e.type===`edge`){let t=(de.get(e.id)??0)+1;de.set(e.id,t),e.id=t+`-`+e.id,ue.push(e)}else{e.label||(e.type===`composite`?e.label=``:e.label=e.id);let t=z.get(e.id);if(t===void 0?z.set(e.id,e):(e.type!==`na`&&(t.type=e.type),e.label!==e.id&&(t.label=e.label)),e.children&&xe(e.children,e),e.type===`space`){let t=e.width??1;for(let n=0;n<t;n++){let t=T(e);t.id=t.id+`-`+n,z.set(t.id,t),r.push(t)}}else t===void 0&&r.push(e)}}t.children=r},`populateBlockDatabase`),Se=[],V={id:`root`,type:`composite`,children:[],columns:-1},Ce=E(()=>{f.debug(`Clear called`),e(),V={id:`root`,type:`composite`,children:[],columns:-1},z=new Map([[`root`,V]]),Se=[],B=new Map,ue=[],de=new Map},`clear`);function we(e){switch(f.debug(`typeStr2Type`,e),e){case`[]`:return`square`;case`()`:return f.debug(`we have a round`),`round`;case`(())`:return`circle`;case`>]`:return`rect_left_inv_arrow`;case`{}`:return`diamond`;case`{{}}`:return`hexagon`;case`([])`:return`stadium`;case`[[]]`:return`subroutine`;case`[()]`:return`cylinder`;case`((()))`:return`doublecircle`;case`[//]`:return`lean_right`;case`[\\\\]`:return`lean_left`;case`[/\\]`:return`trapezoid`;case`[\\/]`:return`inv_trapezoid`;case`<[]>`:return`block_arrow`;default:return`na`}}E(we,`typeStr2Type`);function Te(e){switch(f.debug(`typeStr2Type`,e),e){case`==`:return`thick`;default:return`normal`}}E(Te,`edgeTypeStr2Type`);function Ee(e){switch(e.replace(/^[\s-]+|[\s-]+$/g,``)){case`x`:return`arrow_cross`;case`o`:return`arrow_circle`;case`>`:return`arrow_point`;default:return``}}E(Ee,`edgeStrToEdgeData`);var De=0,Oe={getConfig:E(()=>h().block,`getConfig`),typeStr2Type:we,edgeTypeStr2Type:Te,edgeStrToEdgeData:Ee,getLogger:E(()=>f,`getLogger`),getBlocksFlat:E(()=>[...z.values()],`getBlocksFlat`),getBlocks:E(()=>Se||[],`getBlocks`),getEdges:E(()=>ue,`getEdges`),setHierarchy:E(e=>{V.children=e,xe(e,V),Se=V.children},`setHierarchy`),getBlock:E(e=>z.get(e),`getBlock`),setBlock:E(e=>{z.set(e.id,e)},`setBlock`),getColumns:E(e=>{let t=z.get(e);return t?t.columns?t.columns:t.children?t.children.length:-1:-1},`getColumns`),getClasses:E(function(){return B},`getClasses`),clear:Ce,generateId:E(()=>(De++,`id-`+Math.random().toString(36).substr(2,12)+`-`+De),`generateId`)},H=E((e,t)=>{let r=n;return g(r(e,`r`),r(e,`g`),r(e,`b`),t)},`fade`),ke=E(e=>`.label {
    font-family: ${e.fontFamily};
    color: ${e.nodeTextColor||e.textColor};
  }
  .cluster-label text {
    fill: ${e.titleColor};
  }
  .cluster-label span,p {
    color: ${e.titleColor};
  }



  .label text,span,p {
    fill: ${e.nodeTextColor||e.textColor};
    color: ${e.nodeTextColor||e.textColor};
  }

  .node rect,
  .node circle,
  .node ellipse,
  .node polygon,
  .node path {
    fill: ${e.mainBkg};
    stroke: ${e.nodeBorder};
    stroke-width: 1px;
  }
  .flowchart-label text {
    text-anchor: middle;
  }
  // .flowchart-label .text-outer-tspan {
  //   text-anchor: middle;
  // }
  // .flowchart-label .text-inner-tspan {
  //   text-anchor: start;
  // }

  .node .label {
    text-align: center;
  }
  .node.clickable {
    cursor: pointer;
  }

  .arrowheadPath {
    fill: ${e.arrowheadColor};
  }

  .edgePath .path {
    stroke: ${e.lineColor};
    stroke-width: 2.0px;
  }

  .flowchart-link {
    stroke: ${e.lineColor};
    fill: none;
  }

  .edgeLabel {
    background-color: ${e.edgeLabelBackground};
    rect {
      opacity: 0.5;
      background-color: ${e.edgeLabelBackground};
      fill: ${e.edgeLabelBackground};
    }
    text-align: center;
  }

  /* For html labels only */
  .labelBkg {
    background-color: ${H(e.edgeLabelBackground,.5)};
    // background-color:
  }

  .node .cluster {
    // fill: ${H(e.mainBkg,.5)};
    fill: ${H(e.clusterBkg,.5)};
    stroke: ${H(e.clusterBorder,.2)};
    box-shadow: rgba(50, 50, 93, 0.25) 0px 13px 27px -5px, rgba(0, 0, 0, 0.3) 0px 8px 16px -8px;
    stroke-width: 1px;
  }

  .cluster text {
    fill: ${e.titleColor};
  }

  .cluster span,p {
    color: ${e.titleColor};
  }
  /* .cluster div {
    color: ${e.titleColor};
  } */

  div.mermaidTooltip {
    position: absolute;
    text-align: center;
    max-width: 200px;
    padding: 2px;
    font-family: ${e.fontFamily};
    font-size: 12px;
    background: ${e.tertiaryColor};
    border: 1px solid ${e.border2};
    border-radius: 2px;
    pointer-events: none;
    z-index: 100;
  }

  .flowchartTitleText {
    text-anchor: middle;
    font-size: 18px;
    fill: ${e.textColor};
  }
  ${ie()}
`,`getStyles`),Ae=E((e,t,n,r)=>{t.forEach(t=>{je[t](e,n,r)})},`insertMarkers`),je={extension:E((e,t,n)=>{f.trace(`Making markers for `,n),e.append(`defs`).append(`marker`).attr(`id`,n+`_`+t+`-extensionStart`).attr(`class`,`marker extension `+t).attr(`refX`,18).attr(`refY`,7).attr(`markerWidth`,190).attr(`markerHeight`,240).attr(`orient`,`auto`).append(`path`).attr(`d`,`M 1,7 L18,13 V 1 Z`),e.append(`defs`).append(`marker`).attr(`id`,n+`_`+t+`-extensionEnd`).attr(`class`,`marker extension `+t).attr(`refX`,1).attr(`refY`,7).attr(`markerWidth`,20).attr(`markerHeight`,28).attr(`orient`,`auto`).append(`path`).attr(`d`,`M 1,1 V 13 L18,7 Z`)},`extension`),composition:E((e,t,n)=>{e.append(`defs`).append(`marker`).attr(`id`,n+`_`+t+`-compositionStart`).attr(`class`,`marker composition `+t).attr(`refX`,18).attr(`refY`,7).attr(`markerWidth`,190).attr(`markerHeight`,240).attr(`orient`,`auto`).append(`path`).attr(`d`,`M 18,7 L9,13 L1,7 L9,1 Z`),e.append(`defs`).append(`marker`).attr(`id`,n+`_`+t+`-compositionEnd`).attr(`class`,`marker composition `+t).attr(`refX`,1).attr(`refY`,7).attr(`markerWidth`,20).attr(`markerHeight`,28).attr(`orient`,`auto`).append(`path`).attr(`d`,`M 18,7 L9,13 L1,7 L9,1 Z`)},`composition`),aggregation:E((e,t,n)=>{e.append(`defs`).append(`marker`).attr(`id`,n+`_`+t+`-aggregationStart`).attr(`class`,`marker aggregation `+t).attr(`refX`,18).attr(`refY`,7).attr(`markerWidth`,190).attr(`markerHeight`,240).attr(`orient`,`auto`).append(`path`).attr(`d`,`M 18,7 L9,13 L1,7 L9,1 Z`),e.append(`defs`).append(`marker`).attr(`id`,n+`_`+t+`-aggregationEnd`).attr(`class`,`marker aggregation `+t).attr(`refX`,1).attr(`refY`,7).attr(`markerWidth`,20).attr(`markerHeight`,28).attr(`orient`,`auto`).append(`path`).attr(`d`,`M 18,7 L9,13 L1,7 L9,1 Z`)},`aggregation`),dependency:E((e,t,n)=>{e.append(`defs`).append(`marker`).attr(`id`,n+`_`+t+`-dependencyStart`).attr(`class`,`marker dependency `+t).attr(`refX`,6).attr(`refY`,7).attr(`markerWidth`,190).attr(`markerHeight`,240).attr(`orient`,`auto`).append(`path`).attr(`d`,`M 5,7 L9,13 L1,7 L9,1 Z`),e.append(`defs`).append(`marker`).attr(`id`,n+`_`+t+`-dependencyEnd`).attr(`class`,`marker dependency `+t).attr(`refX`,13).attr(`refY`,7).attr(`markerWidth`,20).attr(`markerHeight`,28).attr(`orient`,`auto`).append(`path`).attr(`d`,`M 18,7 L9,13 L14,7 L9,1 Z`)},`dependency`),lollipop:E((e,t,n)=>{e.append(`defs`).append(`marker`).attr(`id`,n+`_`+t+`-lollipopStart`).attr(`class`,`marker lollipop `+t).attr(`refX`,13).attr(`refY`,7).attr(`markerWidth`,190).attr(`markerHeight`,240).attr(`orient`,`auto`).append(`circle`).attr(`stroke`,`black`).attr(`fill`,`transparent`).attr(`cx`,7).attr(`cy`,7).attr(`r`,6),e.append(`defs`).append(`marker`).attr(`id`,n+`_`+t+`-lollipopEnd`).attr(`class`,`marker lollipop `+t).attr(`refX`,1).attr(`refY`,7).attr(`markerWidth`,190).attr(`markerHeight`,240).attr(`orient`,`auto`).append(`circle`).attr(`stroke`,`black`).attr(`fill`,`transparent`).attr(`cx`,7).attr(`cy`,7).attr(`r`,6)},`lollipop`),point:E((e,t,n)=>{e.append(`marker`).attr(`id`,n+`_`+t+`-pointEnd`).attr(`class`,`marker `+t).attr(`viewBox`,`0 0 10 10`).attr(`refX`,6).attr(`refY`,5).attr(`markerUnits`,`userSpaceOnUse`).attr(`markerWidth`,12).attr(`markerHeight`,12).attr(`orient`,`auto`).append(`path`).attr(`d`,`M 0 0 L 10 5 L 0 10 z`).attr(`class`,`arrowMarkerPath`).style(`stroke-width`,1).style(`stroke-dasharray`,`1,0`),e.append(`marker`).attr(`id`,n+`_`+t+`-pointStart`).attr(`class`,`marker `+t).attr(`viewBox`,`0 0 10 10`).attr(`refX`,4.5).attr(`refY`,5).attr(`markerUnits`,`userSpaceOnUse`).attr(`markerWidth`,12).attr(`markerHeight`,12).attr(`orient`,`auto`).append(`path`).attr(`d`,`M 0 5 L 10 10 L 10 0 z`).attr(`class`,`arrowMarkerPath`).style(`stroke-width`,1).style(`stroke-dasharray`,`1,0`)},`point`),circle:E((e,t,n)=>{e.append(`marker`).attr(`id`,n+`_`+t+`-circleEnd`).attr(`class`,`marker `+t).attr(`viewBox`,`0 0 10 10`).attr(`refX`,11).attr(`refY`,5).attr(`markerUnits`,`userSpaceOnUse`).attr(`markerWidth`,11).attr(`markerHeight`,11).attr(`orient`,`auto`).append(`circle`).attr(`cx`,`5`).attr(`cy`,`5`).attr(`r`,`5`).attr(`class`,`arrowMarkerPath`).style(`stroke-width`,1).style(`stroke-dasharray`,`1,0`),e.append(`marker`).attr(`id`,n+`_`+t+`-circleStart`).attr(`class`,`marker `+t).attr(`viewBox`,`0 0 10 10`).attr(`refX`,-1).attr(`refY`,5).attr(`markerUnits`,`userSpaceOnUse`).attr(`markerWidth`,11).attr(`markerHeight`,11).attr(`orient`,`auto`).append(`circle`).attr(`cx`,`5`).attr(`cy`,`5`).attr(`r`,`5`).attr(`class`,`arrowMarkerPath`).style(`stroke-width`,1).style(`stroke-dasharray`,`1,0`)},`circle`),cross:E((e,t,n)=>{e.append(`marker`).attr(`id`,n+`_`+t+`-crossEnd`).attr(`class`,`marker cross `+t).attr(`viewBox`,`0 0 11 11`).attr(`refX`,12).attr(`refY`,5.2).attr(`markerUnits`,`userSpaceOnUse`).attr(`markerWidth`,11).attr(`markerHeight`,11).attr(`orient`,`auto`).append(`path`).attr(`d`,`M 1,1 l 9,9 M 10,1 l -9,9`).attr(`class`,`arrowMarkerPath`).style(`stroke-width`,2).style(`stroke-dasharray`,`1,0`),e.append(`marker`).attr(`id`,n+`_`+t+`-crossStart`).attr(`class`,`marker cross `+t).attr(`viewBox`,`0 0 11 11`).attr(`refX`,-1).attr(`refY`,5.2).attr(`markerUnits`,`userSpaceOnUse`).attr(`markerWidth`,11).attr(`markerHeight`,11).attr(`orient`,`auto`).append(`path`).attr(`d`,`M 1,1 l 9,9 M 10,1 l -9,9`).attr(`class`,`arrowMarkerPath`).style(`stroke-width`,2).style(`stroke-dasharray`,`1,0`)},`cross`),barb:E((e,t,n)=>{e.append(`defs`).append(`marker`).attr(`id`,n+`_`+t+`-barbEnd`).attr(`refX`,19).attr(`refY`,7).attr(`markerWidth`,20).attr(`markerHeight`,14).attr(`markerUnits`,`strokeWidth`).attr(`orient`,`auto`).append(`path`).attr(`d`,`M 19,7 L9,13 L14,7 L9,1 Z`)},`barb`)},Me=Ae,U=d()?.block?.padding??8;function Ne(e,t){if(e===0||!Number.isInteger(e))throw Error(`Columns must be an integer !== 0.`);if(t<0||!Number.isInteger(t))throw Error(`Position must be a non-negative integer.`+t);return e<0?{px:t,py:0}:e===1?{px:0,py:t}:{px:t%e,py:Math.floor(t/e)}}E(Ne,`calculateBlockPosition`);var Pe=E(e=>{let t=0,n=0;for(let r of e.children){let{width:i,height:a,x:o,y:s}=r.size??{width:0,height:0,x:0,y:0};f.debug(`getMaxChildSize abc95 child:`,r.id,`width:`,i,`height:`,a,`x:`,o,`y:`,s,r.type),r.type!==`space`&&(i>t&&(t=i/(e.widthInColumns??1)),a>n&&(n=a))}return{width:t,height:n}},`getMaxChildSize`);function W(e,t,n=0,r=0){f.debug(`setBlockSizes abc95 (start)`,e.id,e?.size?.x,`block width =`,e?.size,`siblingWidth`,n),e?.size?.width||(e.size={width:n,height:r,x:0,y:0});let i=0,a=0;if(e.children?.length>0){for(let n of e.children)W(n,t);let o=Pe(e);i=o.width,a=o.height,f.debug(`setBlockSizes abc95 maxWidth of`,e.id,`:s children is `,i,a);for(let t of e.children)t.size&&(f.debug(`abc95 Setting size of children of ${e.id} id=${t.id} ${i} ${a} ${JSON.stringify(t.size)}`),t.size.width=i*(t.widthInColumns??1)+U*((t.widthInColumns??1)-1),t.size.height=a,t.size.x=0,t.size.y=0,f.debug(`abc95 updating size of ${e.id} children child:${t.id} maxWidth:${i} maxHeight:${a}`));for(let n of e.children)W(n,t,i,a);let s=e.columns??-1,c=0;for(let t of e.children)c+=t.widthInColumns??1;let l=e.children.length;s>0&&s<c&&(l=s);let u=Math.ceil(c/l),d=l*(i+U)+U,p=u*(a+U)+U;if(d<n){f.debug(`Detected to small sibling: abc95 ${e.id} siblingWidth ${n} siblingHeight ${r} width ${d}`),d=n,p=r;let t=(n-l*U-U)/l,o=(r-u*U-U)/u;f.debug(`Size indata abc88`,e.id,`childWidth`,t,`maxWidth`,i),f.debug(`Size indata abc88`,e.id,`childHeight`,o,`maxHeight`,a),f.debug(`Size indata abc88 xSize`,l,`padding`,U);for(let n of e.children)n.size&&(n.size.width=t,n.size.height=o,n.size.x=0,n.size.y=0)}if(f.debug(`abc95 (finale calc) ${e.id} xSize ${l} ySize ${u} columns ${s}${e.children.length} width=${Math.max(d,e.size?.width||0)}`),d<(e?.size?.width||0)){d=e?.size?.width||0;let t=s>0?Math.min(e.children.length,s):e.children.length;if(t>0){let n=(d-t*U-U)/t;f.debug(`abc95 (growing to fit) width`,e.id,d,e.size?.width,n);for(let t of e.children)t.size&&(t.size.width=n)}}e.size={width:d,height:p,x:0,y:0}}f.debug(`setBlockSizes abc94 (done)`,e.id,e?.size?.x,e?.size?.width,e?.size?.y,e?.size?.height)}E(W,`setBlockSizes`);function Fe(e,t){f.debug(`abc85 layout blocks (=>layoutBlocks) ${e.id} x: ${e?.size?.x} y: ${e?.size?.y} width: ${e?.size?.width}`);let n=e.columns??-1;if(f.debug(`layoutBlocks columns abc95`,e.id,`=>`,n,e),e.children&&e.children.length>0){let r=e?.children[0]?.size?.width??0,i=e.children.length*r+(e.children.length-1)*U;f.debug(`widthOfChildren 88`,i,`posX`);let a=0;f.debug(`abc91 block?.size?.x`,e.id,e?.size?.x);let o=e?.size?.x?e?.size?.x+(-e?.size?.width/2||0):-U,s=0;for(let r of e.children){let i=e;if(!r.size)continue;let{width:c,height:l}=r.size,{px:u,py:d}=Ne(n,a);if(d!=s&&(s=d,o=e?.size?.x?e?.size?.x+(-e?.size?.width/2||0):-U,f.debug(`New row in layout for block`,e.id,` and child `,r.id,s)),f.debug(`abc89 layout blocks (child) id: ${r.id} Pos: ${a} (px, py) ${u},${d} (${i?.size?.x},${i?.size?.y}) parent: ${i.id} width: ${c}${U}`),i.size){let e=c/2;r.size.x=o+U+e,f.debug(`abc91 layout blocks (calc) px, pyid:${r.id} startingPos=X${o} new startingPosX${r.size.x} ${e} padding=${U} width=${c} halfWidth=${e} => x:${r.size.x} y:${r.size.y} ${r.widthInColumns} (width * (child?.w || 1)) / 2 ${c*(r?.widthInColumns??1)/2}`),o=r.size.x+e,r.size.y=i.size.y-i.size.height/2+d*(l+U)+l/2+U,f.debug(`abc88 layout blocks (calc) px, pyid:${r.id}startingPosX${o}${U}${e}=>x:${r.size.x}y:${r.size.y}${r.widthInColumns}(width * (child?.w || 1)) / 2${c*(r?.widthInColumns??1)/2}`)}r.children&&Fe(r,t);let p=r?.widthInColumns??1;n>0&&(p=Math.min(p,n-a%n)),a+=p,f.debug(`abc88 columnsPos`,r,a)}}f.debug(`layout blocks (<==layoutBlocks) ${e.id} x: ${e?.size?.x} y: ${e?.size?.y} width: ${e?.size?.width}`)}E(Fe,`layoutBlocks`);function Ie(e,{minX:t,minY:n,maxX:r,maxY:i}={minX:0,minY:0,maxX:0,maxY:0}){if(e.size&&e.id!==`root`){let{x:a,y:o,width:s,height:c}=e.size;a-s/2<t&&(t=a-s/2),o-c/2<n&&(n=o-c/2),a+s/2>r&&(r=a+s/2),o+c/2>i&&(i=o+c/2)}if(e.children)for(let a of e.children)({minX:t,minY:n,maxX:r,maxY:i}=Ie(a,{minX:t,minY:n,maxX:r,maxY:i}));return{minX:t,minY:n,maxX:r,maxY:i}}E(Ie,`findBounds`);function Le(e){let t=e.getBlock(`root`);if(!t)return;W(t,e,0,0),Fe(t,e),f.debug(`getBlocks`,JSON.stringify(t,null,2));let{minX:n,minY:r,maxX:i,maxY:a}=Ie(t),o=a-r;return{x:n,y:r,width:i-n,height:o}}E(Le,`layout`);function Re(e,t){t&&e.attr(`style`,t)}E(Re,`applyStyle`);function ze(e,t){let n=m(document.createElementNS(`http://www.w3.org/2000/svg`,`foreignObject`)),r=n.append(`xhtml:div`),i=e.label,a=e.isNode?`nodeLabel`:`edgeLabel`,o=r.append(`span`);return o.html(s(i,t)),Re(o,e.labelStyle),o.attr(`class`,a),Re(r,e.labelStyle),r.style(`display`,`inline-block`),r.style(`white-space`,`nowrap`),r.attr(`xmlns`,`http://www.w3.org/1999/xhtml`),n.node()}E(ze,`addHtmlLabel`);var G=E(async(e,n,r,i)=>{let a=e||``;typeof a==`object`&&(a=a[0]);let o=d();if(t(o.flowchart.htmlLabels))return a=a.replace(/\\n|\n/g,`<br />`),f.debug(`vertexText`+a),ze({isNode:i,label:await c(v(a)),labelStyle:n.replace(`fill:`,`color:`)},o);{let e=document.createElementNS(`http://www.w3.org/2000/svg`,`text`);e.setAttribute(`style`,n.replace(`color:`,`fill:`));let t=[];t=typeof a==`string`?a.split(/\\n|\n|<br\s*\/?>/gi):Array.isArray(a)?a:[];for(let n of t){let t=document.createElementNS(`http://www.w3.org/2000/svg`,`tspan`);t.setAttributeNS(`http://www.w3.org/XML/1998/namespace`,`xml:space`,`preserve`),t.setAttribute(`dy`,`1em`),t.setAttribute(`x`,`0`),r?t.setAttribute(`class`,`title-row`):t.setAttribute(`class`,`row`),t.textContent=n.trim(),e.appendChild(t)}return e}},`createLabel`),Be=E((e,t,n,r,i)=>{t.arrowTypeStart&&He(e,`start`,t.arrowTypeStart,n,r,i),t.arrowTypeEnd&&He(e,`end`,t.arrowTypeEnd,n,r,i)},`addEdgeMarkers`),Ve={arrow_cross:`cross`,arrow_point:`point`,arrow_barb:`barb`,arrow_circle:`circle`,aggregation:`aggregation`,extension:`extension`,composition:`composition`,dependency:`dependency`,lollipop:`lollipop`},He=E((e,t,n,r,i,a)=>{let o=Ve[n];if(!o){f.warn(`Unknown arrow type: ${n}`);return}let s=t===`start`?`Start`:`End`;e.attr(`marker-${t}`,`url(${r}#${i}_${a}-${o}${s})`)},`addEdgeMarker`),Ue={},K={},We=E(async(e,n)=>{let r=d(),i=t(r.flowchart.htmlLabels),a=n.labelType===`markdown`?_(e,n.label,{style:n.labelStyle,useHtmlLabels:i,addSvgBackground:!0},r):await G(n.label,n.labelStyle),o=e.insert(`g`).attr(`class`,`edgeLabel`),s=o.insert(`g`).attr(`class`,`label`);s.node().appendChild(a);let c=a.getBBox();if(i){let e=a.children[0],t=m(a);c=e.getBoundingClientRect(),t.attr(`width`,c.width),t.attr(`height`,c.height)}s.attr(`transform`,`translate(`+-c.width/2+`, `+-c.height/2+`)`),Ue[n.id]=o,n.width=c.width,n.height=c.height;let l;if(n.startLabelLeft){let t=await G(n.startLabelLeft,n.labelStyle),r=e.insert(`g`).attr(`class`,`edgeTerminals`),i=r.insert(`g`).attr(`class`,`inner`);l=i.node().appendChild(t);let a=t.getBBox();i.attr(`transform`,`translate(`+-a.width/2+`, `+-a.height/2+`)`),K[n.id]||(K[n.id]={}),K[n.id].startLeft=r,q(l,n.startLabelLeft)}if(n.startLabelRight){let t=await G(n.startLabelRight,n.labelStyle),r=e.insert(`g`).attr(`class`,`edgeTerminals`),i=r.insert(`g`).attr(`class`,`inner`);l=r.node().appendChild(t),i.node().appendChild(t);let a=t.getBBox();i.attr(`transform`,`translate(`+-a.width/2+`, `+-a.height/2+`)`),K[n.id]||(K[n.id]={}),K[n.id].startRight=r,q(l,n.startLabelRight)}if(n.endLabelLeft){let t=await G(n.endLabelLeft,n.labelStyle),r=e.insert(`g`).attr(`class`,`edgeTerminals`),i=r.insert(`g`).attr(`class`,`inner`);l=i.node().appendChild(t);let a=t.getBBox();i.attr(`transform`,`translate(`+-a.width/2+`, `+-a.height/2+`)`),r.node().appendChild(t),K[n.id]||(K[n.id]={}),K[n.id].endLeft=r,q(l,n.endLabelLeft)}if(n.endLabelRight){let t=await G(n.endLabelRight,n.labelStyle),r=e.insert(`g`).attr(`class`,`edgeTerminals`),i=r.insert(`g`).attr(`class`,`inner`);l=i.node().appendChild(t);let a=t.getBBox();i.attr(`transform`,`translate(`+-a.width/2+`, `+-a.height/2+`)`),r.node().appendChild(t),K[n.id]||(K[n.id]={}),K[n.id].endRight=r,q(l,n.endLabelRight)}return a},`insertEdgeLabel`);function q(e,t){d().flowchart.htmlLabels&&e&&(e.style.width=t.length*9+`px`,e.style.height=`12px`)}E(q,`setTerminalWidth`);var Ge=E((e,t)=>{f.debug(`Moving label abc88 `,e.id,e.label,Ue[e.id],t);let n=t.updatedPath?t.updatedPath:t.originalPath,{subGraphTitleTotalMargin:r}=se(d());if(e.label){let i=Ue[e.id],a=e.x,s=e.y;if(n){let r=o.calcLabelPosition(n);f.debug(`Moving label `+e.label+` from (`,a,`,`,s,`) to (`,r.x,`,`,r.y,`) abc88`),t.updatedPath&&(a=r.x,s=r.y)}i.attr(`transform`,`translate(${a}, ${s+r/2})`)}if(e.startLabelLeft){let t=K[e.id].startLeft,r=e.x,i=e.y;if(n){let t=o.calcTerminalLabelPosition(e.arrowTypeStart?10:0,`start_left`,n);r=t.x,i=t.y}t.attr(`transform`,`translate(${r}, ${i})`)}if(e.startLabelRight){let t=K[e.id].startRight,r=e.x,i=e.y;if(n){let t=o.calcTerminalLabelPosition(e.arrowTypeStart?10:0,`start_right`,n);r=t.x,i=t.y}t.attr(`transform`,`translate(${r}, ${i})`)}if(e.endLabelLeft){let t=K[e.id].endLeft,r=e.x,i=e.y;if(n){let t=o.calcTerminalLabelPosition(e.arrowTypeEnd?10:0,`end_left`,n);r=t.x,i=t.y}t.attr(`transform`,`translate(${r}, ${i})`)}if(e.endLabelRight){let t=K[e.id].endRight,r=e.x,i=e.y;if(n){let t=o.calcTerminalLabelPosition(e.arrowTypeEnd?10:0,`end_right`,n);r=t.x,i=t.y}t.attr(`transform`,`translate(${r}, ${i})`)}},`positionEdgeLabel`),Ke=E((e,t)=>{let n=e.x,r=e.y,i=Math.abs(t.x-n),a=Math.abs(t.y-r),o=e.width/2,s=e.height/2;return i>=o||a>=s},`outsideNode`),qe=E((e,t,n)=>{f.debug(`intersection calc abc89:
  outsidePoint: ${JSON.stringify(t)}
  insidePoint : ${JSON.stringify(n)}
  node        : x:${e.x} y:${e.y} w:${e.width} h:${e.height}`);let r=e.x,i=e.y,a=Math.abs(r-n.x),o=e.width/2,s=n.x<t.x?o-a:o+a,c=e.height/2,l=Math.abs(t.y-n.y),u=Math.abs(t.x-n.x);if(Math.abs(i-t.y)*o>Math.abs(r-t.x)*c){let e=n.y<t.y?t.y-c-i:i-c-t.y;s=u*e/l;let r={x:n.x<t.x?n.x+s:n.x-u+s,y:n.y<t.y?n.y+l-e:n.y-l+e};return s===0&&(r.x=t.x,r.y=t.y),u===0&&(r.x=t.x),l===0&&(r.y=t.y),f.debug(`abc89 topp/bott calc, Q ${l}, q ${e}, R ${u}, r ${s}`,r),r}else{s=n.x<t.x?t.x-o-r:r-o-t.x;let e=l*s/u,i=n.x<t.x?n.x+u-s:n.x-u+s,a=n.y<t.y?n.y+e:n.y-e;return f.debug(`sides calc abc89, Q ${l}, q ${e}, R ${u}, r ${s}`,{_x:i,_y:a}),s===0&&(i=t.x,a=t.y),u===0&&(i=t.x),l===0&&(a=t.y),{x:i,y:a}}},`intersection`),Je=E((e,t)=>{f.debug(`abc88 cutPathAtIntersect`,e,t);let n=[],r=e[0],i=!1;return e.forEach(e=>{if(!Ke(t,e)&&!i){let a=qe(t,r,e),o=!1;n.forEach(e=>{o||=e.x===a.x&&e.y===a.y}),n.some(e=>e.x===a.x&&e.y===a.y)||n.push(a),i=!0}else r=e,i||n.push(e)}),n},`cutPathAtIntersect`),Ye=E(function(e,t,n,a,o,s,c){let l=n.points;f.debug(`abc88 InsertEdge: edge=`,n,`e=`,t);let u=!1,m=s.node(t.v);var h=s.node(t.w);h?.intersect&&m?.intersect&&(l=l.slice(1,n.points.length-1),l.unshift(m.intersect(l[0])),l.push(h.intersect(l[l.length-1]))),n.toCluster&&(f.debug(`to cluster abc88`,a[n.toCluster]),l=Je(n.points,a[n.toCluster].node),u=!0),n.fromCluster&&(f.debug(`from cluster abc88`,a[n.fromCluster]),l=Je(l.reverse(),a[n.fromCluster].node).reverse(),u=!0);let g=l.filter(e=>!Number.isNaN(e.y)),_=p;n.curve&&(o===`graph`||o===`flowchart`)&&(_=n.curve);let{x:v,y}=oe(n),b=i().x(v).y(y).curve(_),x;switch(n.thickness){case`normal`:x=`edge-thickness-normal`;break;case`thick`:x=`edge-thickness-thick`;break;case`invisible`:x=`edge-thickness-thick`;break;default:x=``}switch(n.pattern){case`solid`:x+=` edge-pattern-solid`;break;case`dotted`:x+=` edge-pattern-dotted`;break;case`dashed`:x+=` edge-pattern-dashed`;break}let S=e.append(`path`).attr(`d`,b(g)).attr(`id`,n.id).attr(`class`,` `+x+(n.classes?` `+n.classes:``)).attr(`style`,n.style),C=``;(d().flowchart.arrowMarkerAbsolute||d().state.arrowMarkerAbsolute)&&(C=r(!0)),Be(S,n,C,c,o);let w={};return u&&(w.updatedPath=l),w.originalPath=n.points,w},`insertEdge`),Xe=E(e=>{let t=new Set;for(let n of e)switch(n){case`x`:t.add(`right`),t.add(`left`);break;case`y`:t.add(`up`),t.add(`down`);break;default:t.add(n);break}return t},`expandAndDeduplicateDirections`),Ze=E((e,t,n)=>{let r=Xe(e),i=t.height+2*n.padding,a=i/2,o=t.width+2*a+n.padding,s=n.padding/2;return r.has(`right`)&&r.has(`left`)&&r.has(`up`)&&r.has(`down`)?[{x:0,y:0},{x:a,y:0},{x:o/2,y:2*s},{x:o-a,y:0},{x:o,y:0},{x:o,y:-i/3},{x:o+2*s,y:-i/2},{x:o,y:-2*i/3},{x:o,y:-i},{x:o-a,y:-i},{x:o/2,y:-i-2*s},{x:a,y:-i},{x:0,y:-i},{x:0,y:-2*i/3},{x:-2*s,y:-i/2},{x:0,y:-i/3}]:r.has(`right`)&&r.has(`left`)&&r.has(`up`)?[{x:a,y:0},{x:o-a,y:0},{x:o,y:-i/2},{x:o-a,y:-i},{x:a,y:-i},{x:0,y:-i/2}]:r.has(`right`)&&r.has(`left`)&&r.has(`down`)?[{x:0,y:0},{x:a,y:-i},{x:o-a,y:-i},{x:o,y:0}]:r.has(`right`)&&r.has(`up`)&&r.has(`down`)?[{x:0,y:0},{x:o,y:-a},{x:o,y:-i+a},{x:0,y:-i}]:r.has(`left`)&&r.has(`up`)&&r.has(`down`)?[{x:o,y:0},{x:0,y:-a},{x:0,y:-i+a},{x:o,y:-i}]:r.has(`right`)&&r.has(`left`)?[{x:a,y:0},{x:a,y:-s},{x:o-a,y:-s},{x:o-a,y:0},{x:o,y:-i/2},{x:o-a,y:-i},{x:o-a,y:-i+s},{x:a,y:-i+s},{x:a,y:-i},{x:0,y:-i/2}]:r.has(`up`)&&r.has(`down`)?[{x:o/2,y:0},{x:0,y:-s},{x:a,y:-s},{x:a,y:-i+s},{x:0,y:-i+s},{x:o/2,y:-i},{x:o,y:-i+s},{x:o-a,y:-i+s},{x:o-a,y:-s},{x:o,y:-s}]:r.has(`right`)&&r.has(`up`)?[{x:0,y:0},{x:o,y:-a},{x:0,y:-i}]:r.has(`right`)&&r.has(`down`)?[{x:0,y:0},{x:o,y:0},{x:0,y:-i}]:r.has(`left`)&&r.has(`up`)?[{x:o,y:0},{x:0,y:-a},{x:o,y:-i}]:r.has(`left`)&&r.has(`down`)?[{x:o,y:0},{x:0,y:0},{x:o,y:-i}]:r.has(`right`)?[{x:a,y:-s},{x:a,y:-s},{x:o-a,y:-s},{x:o-a,y:0},{x:o,y:-i/2},{x:o-a,y:-i},{x:o-a,y:-i+s},{x:a,y:-i+s},{x:a,y:-i+s}]:r.has(`left`)?[{x:a,y:0},{x:a,y:-s},{x:o-a,y:-s},{x:o-a,y:-i+s},{x:a,y:-i+s},{x:a,y:-i},{x:0,y:-i/2}]:r.has(`up`)?[{x:a,y:-s},{x:a,y:-i+s},{x:0,y:-i+s},{x:o/2,y:-i},{x:o,y:-i+s},{x:o-a,y:-i+s},{x:o-a,y:-s}]:r.has(`down`)?[{x:o/2,y:0},{x:0,y:-s},{x:a,y:-s},{x:a,y:-i+s},{x:o-a,y:-i+s},{x:o-a,y:-s},{x:o,y:-s}]:[{x:0,y:0}]},`getArrowPoints`);function Qe(e,t){return e.intersect(t)}E(Qe,`intersectNode`);var $e=Qe;function et(e,t,n,r){var i=e.x,a=e.y,o=i-r.x,s=a-r.y,c=Math.sqrt(t*t*s*s+n*n*o*o),l=Math.abs(t*n*o/c);r.x<i&&(l=-l);var u=Math.abs(t*n*s/c);return r.y<a&&(u=-u),{x:i+l,y:a+u}}E(et,`intersectEllipse`);var tt=et;function nt(e,t,n){return tt(e,t,t,n)}E(nt,`intersectCircle`);var rt=nt;function it(e,t,n,r){var i,a,o,s,c,l,u,d,f,p,m,h,g,_,v;if(i=t.y-e.y,o=e.x-t.x,c=t.x*e.y-e.x*t.y,f=i*n.x+o*n.y+c,p=i*r.x+o*r.y+c,!(f!==0&&p!==0&&at(f,p))&&(a=r.y-n.y,s=n.x-r.x,l=r.x*n.y-n.x*r.y,u=a*e.x+s*e.y+l,d=a*t.x+s*t.y+l,!(u!==0&&d!==0&&at(u,d))&&(m=i*s-a*o,m!==0)))return h=Math.abs(m/2),g=o*l-s*c,_=g<0?(g-h)/m:(g+h)/m,g=a*c-i*l,v=g<0?(g-h)/m:(g+h)/m,{x:_,y:v}}E(it,`intersectLine`);function at(e,t){return e*t>0}E(at,`sameSign`);var ot=it,st=ct;function ct(e,t,n){var r=e.x,i=e.y,a=[],o=1/0,s=1/0;typeof t.forEach==`function`?t.forEach(function(e){o=Math.min(o,e.x),s=Math.min(s,e.y)}):(o=Math.min(o,t.x),s=Math.min(s,t.y));for(var c=r-e.width/2-o,l=i-e.height/2-s,u=0;u<t.length;u++){var d=t[u],f=t[u<t.length-1?u+1:0],p=ot(e,n,{x:c+d.x,y:l+d.y},{x:c+f.x,y:l+f.y});p&&a.push(p)}return a.length?(a.length>1&&a.sort(function(e,t){var r=e.x-n.x,i=e.y-n.y,a=Math.sqrt(r*r+i*i),o=t.x-n.x,s=t.y-n.y,c=Math.sqrt(o*o+s*s);return a<c?-1:a===c?0:1}),a[0]):e}E(ct,`intersectPolygon`);var J={node:$e,circle:rt,ellipse:tt,polygon:st,rect:E((e,t)=>{var n=e.x,r=e.y,i=t.x-n,a=t.y-r,o=e.width/2,s=e.height/2,c,l;return Math.abs(a)*o>Math.abs(i)*s?(a<0&&(s=-s),c=a===0?0:s*i/a,l=s):(i<0&&(o=-o),c=o,l=i===0?0:o*a/i),{x:n+c,y:r+l}},`intersectRect`)},Y=E(async(e,n,r,i)=>{let a=d(),o,c=n.useHtmlLabels||t(a.flowchart.htmlLabels);o=r||`node default`;let l=e.insert(`g`).attr(`class`,o).attr(`id`,n.domId||n.id),u=l.insert(`g`).attr(`class`,`label`).attr(`style`,n.labelStyle),f;f=n.labelText===void 0?``:typeof n.labelText==`string`?n.labelText:n.labelText[0];let p=u.node(),h;h=n.labelType===`markdown`?_(u,s(v(f),a),{useHtmlLabels:c,width:n.width||a.flowchart.wrappingWidth,classes:`markdown-node-label`},a):p.appendChild(await G(s(v(f),a),n.labelStyle,!1,i));let g=h.getBBox(),y=n.padding/2;if(t(a.flowchart.htmlLabels)){let e=h.children[0],t=m(h),n=e.getElementsByTagName(`img`);if(n){let e=f.replace(/<img[^>]*>/g,``).trim()===``;await Promise.all([...n].map(t=>new Promise(n=>{function r(){if(t.style.display=`flex`,t.style.flexDirection=`column`,e){let e=a.fontSize?a.fontSize:window.getComputedStyle(document.body).fontSize,n=parseInt(e,10)*5+`px`;t.style.minWidth=n,t.style.maxWidth=n}else t.style.width=`100%`;n(t)}E(r,`setupImage`),setTimeout(()=>{t.complete&&r()}),t.addEventListener(`error`,r),t.addEventListener(`load`,r)})))}g=e.getBoundingClientRect(),t.attr(`width`,g.width),t.attr(`height`,g.height)}return c?u.attr(`transform`,`translate(`+-g.width/2+`, `+-g.height/2+`)`):u.attr(`transform`,`translate(0, `+-g.height/2+`)`),n.centerLabel&&u.attr(`transform`,`translate(`+-g.width/2+`, `+-g.height/2+`)`),u.insert(`rect`,`:first-child`),{shapeSvg:l,bbox:g,halfPadding:y,label:u}},`labelHelper`),X=E((e,t)=>{let n=t.node().getBBox();e.width=n.width,e.height=n.height},`updateNodeBounds`);function Z(e,t,n,r){return e.insert(`polygon`,`:first-child`).attr(`points`,r.map(function(e){return e.x+`,`+e.y}).join(` `)).attr(`class`,`label-container`).attr(`transform`,`translate(`+-t/2+`,`+n/2+`)`)}E(Z,`insertPolygonShape`);var lt=E(async(e,t)=>{t.useHtmlLabels||d().flowchart.htmlLabels||(t.centerLabel=!0);let{shapeSvg:n,bbox:r,halfPadding:i}=await Y(e,t,`node `+t.classes,!0);f.info(`Classes = `,t.classes);let a=n.insert(`rect`,`:first-child`);return a.attr(`rx`,t.rx).attr(`ry`,t.ry).attr(`x`,-r.width/2-i).attr(`y`,-r.height/2-i).attr(`width`,r.width+t.padding).attr(`height`,r.height+t.padding),X(t,a),t.intersect=function(e){return J.rect(t,e)},n},`note`),ut=E(e=>e?` `+e:``,`formatClass`),Q=E((e,t)=>`${t||`node default`}${ut(e.classes)} ${ut(e.class)}`,`getClassesFromNode`),dt=E(async(e,t)=>{let{shapeSvg:n,bbox:r}=await Y(e,t,Q(t,void 0),!0),i=r.width+t.padding+(r.height+t.padding),a=[{x:i/2,y:0},{x:i,y:-i/2},{x:i/2,y:-i},{x:0,y:-i/2}];f.info(`Question main (Circle)`);let o=Z(n,i,i,a);return o.attr(`style`,t.style),X(t,o),t.intersect=function(e){return f.warn(`Intersect called`),J.polygon(t,a,e)},n},`question`),ft=E((e,t)=>{let n=e.insert(`g`).attr(`class`,`node default`).attr(`id`,t.domId||t.id);return n.insert(`polygon`,`:first-child`).attr(`points`,[{x:0,y:28/2},{x:28/2,y:0},{x:0,y:-28/2},{x:-28/2,y:0}].map(function(e){return e.x+`,`+e.y}).join(` `)).attr(`class`,`state-start`).attr(`r`,7).attr(`width`,28).attr(`height`,28),t.width=28,t.height=28,t.intersect=function(e){return J.circle(t,14,e)},n},`choice`),pt=E(async(e,t)=>{let{shapeSvg:n,bbox:r}=await Y(e,t,Q(t,void 0),!0),i=r.height+t.padding,a=i/4,o=r.width+2*a+t.padding,s=[{x:a,y:0},{x:o-a,y:0},{x:o,y:-i/2},{x:o-a,y:-i},{x:a,y:-i},{x:0,y:-i/2}],c=Z(n,o,i,s);return c.attr(`style`,t.style),X(t,c),t.intersect=function(e){return J.polygon(t,s,e)},n},`hexagon`),mt=E(async(e,t)=>{let{shapeSvg:n,bbox:r}=await Y(e,t,void 0,!0),i=r.height+2*t.padding,a=i/2,o=r.width+2*a+t.padding,s=Ze(t.directions,r,t),c=Z(n,o,i,s);return c.attr(`style`,t.style),X(t,c),t.intersect=function(e){return J.polygon(t,s,e)},n},`block_arrow`),ht=E(async(e,t)=>{let{shapeSvg:n,bbox:r}=await Y(e,t,Q(t,void 0),!0),i=r.width+t.padding,a=r.height+t.padding,o=[{x:-a/2,y:0},{x:i,y:0},{x:i,y:-a},{x:-a/2,y:-a},{x:0,y:-a/2}];return Z(n,i,a,o).attr(`style`,t.style),t.width=i+a,t.height=a,t.intersect=function(e){return J.polygon(t,o,e)},n},`rect_left_inv_arrow`),gt=E(async(e,t)=>{let{shapeSvg:n,bbox:r}=await Y(e,t,Q(t),!0),i=r.width+t.padding,a=r.height+t.padding,o=[{x:-2*a/6,y:0},{x:i-a/6,y:0},{x:i+2*a/6,y:-a},{x:a/6,y:-a}],s=Z(n,i,a,o);return s.attr(`style`,t.style),X(t,s),t.intersect=function(e){return J.polygon(t,o,e)},n},`lean_right`),_t=E(async(e,t)=>{let{shapeSvg:n,bbox:r}=await Y(e,t,Q(t,void 0),!0),i=r.width+t.padding,a=r.height+t.padding,o=[{x:2*a/6,y:0},{x:i+a/6,y:0},{x:i-2*a/6,y:-a},{x:-a/6,y:-a}],s=Z(n,i,a,o);return s.attr(`style`,t.style),X(t,s),t.intersect=function(e){return J.polygon(t,o,e)},n},`lean_left`),vt=E(async(e,t)=>{let{shapeSvg:n,bbox:r}=await Y(e,t,Q(t,void 0),!0),i=r.width+t.padding,a=r.height+t.padding,o=[{x:-2*a/6,y:0},{x:i+2*a/6,y:0},{x:i-a/6,y:-a},{x:a/6,y:-a}],s=Z(n,i,a,o);return s.attr(`style`,t.style),X(t,s),t.intersect=function(e){return J.polygon(t,o,e)},n},`trapezoid`),yt=E(async(e,t)=>{let{shapeSvg:n,bbox:r}=await Y(e,t,Q(t,void 0),!0),i=r.width+t.padding,a=r.height+t.padding,o=[{x:a/6,y:0},{x:i-a/6,y:0},{x:i+2*a/6,y:-a},{x:-2*a/6,y:-a}],s=Z(n,i,a,o);return s.attr(`style`,t.style),X(t,s),t.intersect=function(e){return J.polygon(t,o,e)},n},`inv_trapezoid`),bt=E(async(e,t)=>{let{shapeSvg:n,bbox:r}=await Y(e,t,Q(t,void 0),!0),i=r.width+t.padding,a=r.height+t.padding,o=[{x:0,y:0},{x:i+a/2,y:0},{x:i,y:-a/2},{x:i+a/2,y:-a},{x:0,y:-a}],s=Z(n,i,a,o);return s.attr(`style`,t.style),X(t,s),t.intersect=function(e){return J.polygon(t,o,e)},n},`rect_right_inv_arrow`),xt=E(async(e,t)=>{let{shapeSvg:n,bbox:r}=await Y(e,t,Q(t,void 0),!0),i=r.width+t.padding,a=i/2,o=a/(2.5+i/50),s=r.height+o+t.padding,c=`M 0,`+o+` a `+a+`,`+o+` 0,0,0 `+i+` 0 a `+a+`,`+o+` 0,0,0 `+-i+` 0 l 0,`+s+` a `+a+`,`+o+` 0,0,0 `+i+` 0 l 0,`+-s;return X(t,n.attr(`label-offset-y`,o).insert(`path`,`:first-child`).attr(`style`,t.style).attr(`d`,c).attr(`transform`,`translate(`+-i/2+`,`+-(s/2+o)+`)`)),t.intersect=function(e){let n=J.rect(t,e),r=n.x-t.x;if(a!=0&&(Math.abs(r)<t.width/2||Math.abs(r)==t.width/2&&Math.abs(n.y-t.y)>t.height/2-o)){let i=o*o*(1-r*r/(a*a));i!=0&&(i=Math.sqrt(i)),i=o-i,e.y-t.y>0&&(i=-i),n.y+=i}return n},n},`cylinder`),St=E(async(e,t)=>{let{shapeSvg:n,bbox:r,halfPadding:i}=await Y(e,t,`node `+t.classes+` `+t.class,!0),a=n.insert(`rect`,`:first-child`),o=t.positioned?t.width:r.width+t.padding,s=t.positioned?t.height:r.height+t.padding,c=t.positioned?-o/2:-r.width/2-i,l=t.positioned?-s/2:-r.height/2-i;if(a.attr(`class`,`basic label-container`).attr(`style`,t.style).attr(`rx`,t.rx).attr(`ry`,t.ry).attr(`x`,c).attr(`y`,l).attr(`width`,o).attr(`height`,s),t.props){let e=new Set(Object.keys(t.props));t.props.borders&&($(a,t.props.borders,o,s),e.delete(`borders`)),e.forEach(e=>{f.warn(`Unknown node property ${e}`)})}return X(t,a),t.intersect=function(e){return J.rect(t,e)},n},`rect`),Ct=E(async(e,t)=>{let{shapeSvg:n,bbox:r,halfPadding:i}=await Y(e,t,`node `+t.classes,!0),a=n.insert(`rect`,`:first-child`),o=t.positioned?t.width:r.width+t.padding,s=t.positioned?t.height:r.height+t.padding,c=t.positioned?-o/2:-r.width/2-i,l=t.positioned?-s/2:-r.height/2-i;if(a.attr(`class`,`basic cluster composite label-container`).attr(`style`,t.style).attr(`rx`,t.rx).attr(`ry`,t.ry).attr(`x`,c).attr(`y`,l).attr(`width`,o).attr(`height`,s),t.props){let e=new Set(Object.keys(t.props));t.props.borders&&($(a,t.props.borders,o,s),e.delete(`borders`)),e.forEach(e=>{f.warn(`Unknown node property ${e}`)})}return X(t,a),t.intersect=function(e){return J.rect(t,e)},n},`composite`),wt=E(async(e,t)=>{let{shapeSvg:n}=await Y(e,t,`label`,!0);f.trace(`Classes = `,t.class);let r=n.insert(`rect`,`:first-child`);if(r.attr(`width`,0).attr(`height`,0),n.attr(`class`,`label edgeLabel`),t.props){let e=new Set(Object.keys(t.props));t.props.borders&&($(r,t.props.borders,0,0),e.delete(`borders`)),e.forEach(e=>{f.warn(`Unknown node property ${e}`)})}return X(t,r),t.intersect=function(e){return J.rect(t,e)},n},`labelRect`);function $(e,t,n,r){let i=[],a=E(e=>{i.push(e,0)},`addBorder`),o=E(e=>{i.push(0,e)},`skipBorder`);t.includes(`t`)?(f.debug(`add top border`),a(n)):o(n),t.includes(`r`)?(f.debug(`add right border`),a(r)):o(r),t.includes(`b`)?(f.debug(`add bottom border`),a(n)):o(n),t.includes(`l`)?(f.debug(`add left border`),a(r)):o(r),e.attr(`stroke-dasharray`,i.join(` `))}E($,`applyNodePropertyBorders`);var Tt=E(async(e,n)=>{let r;r=n.classes?`node `+n.classes:`node default`;let i=e.insert(`g`).attr(`class`,r).attr(`id`,n.domId||n.id),a=i.insert(`rect`,`:first-child`),o=i.insert(`line`),s=i.insert(`g`).attr(`class`,`label`),c=n.labelText.flat?n.labelText.flat():n.labelText,l=``;l=typeof c==`object`?c[0]:c,f.info(`Label text abc79`,l,c,typeof c==`object`);let u=s.node().appendChild(await G(l,n.labelStyle,!0,!0)),p={width:0,height:0};if(t(d().flowchart.htmlLabels)){let e=u.children[0],t=m(u);p=e.getBoundingClientRect(),t.attr(`width`,p.width),t.attr(`height`,p.height)}f.info(`Text 2`,c);let h=c.slice(1,c.length),g=u.getBBox(),_=s.node().appendChild(await G(h.join?h.join(`<br/>`):h,n.labelStyle,!0,!0));if(t(d().flowchart.htmlLabels)){let e=_.children[0],t=m(_);p=e.getBoundingClientRect(),t.attr(`width`,p.width),t.attr(`height`,p.height)}let v=n.padding/2;return m(_).attr(`transform`,`translate( `+(p.width>g.width?0:(g.width-p.width)/2)+`, `+(g.height+v+5)+`)`),m(u).attr(`transform`,`translate( `+(p.width<g.width?0:-(g.width-p.width)/2)+`, 0)`),p=s.node().getBBox(),s.attr(`transform`,`translate(`+-p.width/2+`, `+(-p.height/2-v+3)+`)`),a.attr(`class`,`outer title-state`).attr(`x`,-p.width/2-v).attr(`y`,-p.height/2-v).attr(`width`,p.width+n.padding).attr(`height`,p.height+n.padding),o.attr(`class`,`divider`).attr(`x1`,-p.width/2-v).attr(`x2`,p.width/2+v).attr(`y1`,-p.height/2-v+g.height+v).attr(`y2`,-p.height/2-v+g.height+v),X(n,a),n.intersect=function(e){return J.rect(n,e)},i},`rectWithTitle`),Et=E(async(e,t)=>{let{shapeSvg:n,bbox:r}=await Y(e,t,Q(t,void 0),!0),i=r.height+t.padding,a=r.width+i/4+t.padding;return X(t,n.insert(`rect`,`:first-child`).attr(`style`,t.style).attr(`rx`,i/2).attr(`ry`,i/2).attr(`x`,-a/2).attr(`y`,-i/2).attr(`width`,a).attr(`height`,i)),t.intersect=function(e){return J.rect(t,e)},n},`stadium`),Dt=E(async(e,t)=>{let{shapeSvg:n,bbox:r,halfPadding:i}=await Y(e,t,Q(t,void 0),!0),a=n.insert(`circle`,`:first-child`);return a.attr(`style`,t.style).attr(`rx`,t.rx).attr(`ry`,t.ry).attr(`r`,r.width/2+i).attr(`width`,r.width+t.padding).attr(`height`,r.height+t.padding),f.info(`Circle main`),X(t,a),t.intersect=function(e){return f.info(`Circle intersect`,t,r.width/2+i,e),J.circle(t,r.width/2+i,e)},n},`circle`),Ot=E(async(e,t)=>{let{shapeSvg:n,bbox:r,halfPadding:i}=await Y(e,t,Q(t,void 0),!0),a=n.insert(`g`,`:first-child`),o=a.insert(`circle`),s=a.insert(`circle`);return a.attr(`class`,t.class),o.attr(`style`,t.style).attr(`rx`,t.rx).attr(`ry`,t.ry).attr(`r`,r.width/2+i+5).attr(`width`,r.width+t.padding+10).attr(`height`,r.height+t.padding+10),s.attr(`style`,t.style).attr(`rx`,t.rx).attr(`ry`,t.ry).attr(`r`,r.width/2+i).attr(`width`,r.width+t.padding).attr(`height`,r.height+t.padding),f.info(`DoubleCircle main`),X(t,o),t.intersect=function(e){return f.info(`DoubleCircle intersect`,t,r.width/2+i+5,e),J.circle(t,r.width/2+i+5,e)},n},`doublecircle`),kt=E(async(e,t)=>{let{shapeSvg:n,bbox:r}=await Y(e,t,Q(t,void 0),!0),i=r.width+t.padding,a=r.height+t.padding,o=[{x:0,y:0},{x:i,y:0},{x:i,y:-a},{x:0,y:-a},{x:0,y:0},{x:-8,y:0},{x:i+8,y:0},{x:i+8,y:-a},{x:-8,y:-a},{x:-8,y:0}],s=Z(n,i,a,o);return s.attr(`style`,t.style),X(t,s),t.intersect=function(e){return J.polygon(t,o,e)},n},`subroutine`),At=E((e,t)=>{let n=e.insert(`g`).attr(`class`,`node default`).attr(`id`,t.domId||t.id),r=n.insert(`circle`,`:first-child`);return r.attr(`class`,`state-start`).attr(`r`,7).attr(`width`,14).attr(`height`,14),X(t,r),t.intersect=function(e){return J.circle(t,7,e)},n},`start`),jt=E((e,t,n)=>{let r=e.insert(`g`).attr(`class`,`node default`).attr(`id`,t.domId||t.id),i=70,a=10;return n===`LR`&&(i=10,a=70),X(t,r.append(`rect`).attr(`x`,-1*i/2).attr(`y`,-1*a/2).attr(`width`,i).attr(`height`,a).attr(`class`,`fork-join`)),t.height+=t.padding/2,t.width+=t.padding/2,t.intersect=function(e){return J.rect(t,e)},r},`forkJoin`),Mt={rhombus:dt,composite:Ct,question:dt,rect:St,labelRect:wt,rectWithTitle:Tt,choice:ft,circle:Dt,doublecircle:Ot,stadium:Et,hexagon:pt,block_arrow:mt,rect_left_inv_arrow:ht,lean_right:gt,lean_left:_t,trapezoid:vt,inv_trapezoid:yt,rect_right_inv_arrow:bt,cylinder:xt,start:At,end:E((e,t)=>{let n=e.insert(`g`).attr(`class`,`node default`).attr(`id`,t.domId||t.id),r=n.insert(`circle`,`:first-child`),i=n.insert(`circle`,`:first-child`);return i.attr(`class`,`state-start`).attr(`r`,7).attr(`width`,14).attr(`height`,14),r.attr(`class`,`state-end`).attr(`r`,5).attr(`width`,10).attr(`height`,10),X(t,i),t.intersect=function(e){return J.circle(t,7,e)},n},`end`),note:lt,subroutine:kt,fork:jt,join:jt,class_box:E(async(e,n)=>{let r=n.padding/2,i;i=n.classes?`node `+n.classes:`node default`;let a=e.insert(`g`).attr(`class`,i).attr(`id`,n.domId||n.id),o=a.insert(`rect`,`:first-child`),s=a.insert(`line`),c=a.insert(`line`),l=0,u=4,f=a.insert(`g`).attr(`class`,`label`),p=0,h=n.classData.annotations?.[0],g=n.classData.annotations[0]?``+n.classData.annotations[0]+``:``,_=f.node().appendChild(await G(g,n.labelStyle,!0,!0)),v=_.getBBox();if(t(d().flowchart.htmlLabels)){let e=_.children[0],t=m(_);v=e.getBoundingClientRect(),t.attr(`width`,v.width),t.attr(`height`,v.height)}n.classData.annotations[0]&&(u+=v.height+4,l+=v.width);let y=n.classData.label;n.classData.type!==void 0&&n.classData.type!==``&&(d().flowchart.htmlLabels?y+=`&lt;`+n.classData.type+`&gt;`:y+=`<`+n.classData.type+`>`);let b=f.node().appendChild(await G(y,n.labelStyle,!0,!0));m(b).attr(`class`,`classTitle`);let x=b.getBBox();if(t(d().flowchart.htmlLabels)){let e=b.children[0],t=m(b);x=e.getBoundingClientRect(),t.attr(`width`,x.width),t.attr(`height`,x.height)}u+=x.height+4,x.width>l&&(l=x.width);let S=[];n.classData.members.forEach(async e=>{let r=e.getDisplayDetails(),i=r.displayText;d().flowchart.htmlLabels&&(i=i.replace(/</g,`&lt;`).replace(/>/g,`&gt;`));let a=f.node().appendChild(await G(i,r.cssStyle?r.cssStyle:n.labelStyle,!0,!0)),o=a.getBBox();if(t(d().flowchart.htmlLabels)){let e=a.children[0],t=m(a);o=e.getBoundingClientRect(),t.attr(`width`,o.width),t.attr(`height`,o.height)}o.width>l&&(l=o.width),u+=o.height+4,S.push(a)}),u+=8;let C=[];if(n.classData.methods.forEach(async e=>{let r=e.getDisplayDetails(),i=r.displayText;d().flowchart.htmlLabels&&(i=i.replace(/</g,`&lt;`).replace(/>/g,`&gt;`));let a=f.node().appendChild(await G(i,r.cssStyle?r.cssStyle:n.labelStyle,!0,!0)),o=a.getBBox();if(t(d().flowchart.htmlLabels)){let e=a.children[0],t=m(a);o=e.getBoundingClientRect(),t.attr(`width`,o.width),t.attr(`height`,o.height)}o.width>l&&(l=o.width),u+=o.height+4,C.push(a)}),u+=8,h){let e=(l-v.width)/2;m(_).attr(`transform`,`translate( `+(-1*l/2+e)+`, `+-1*u/2+`)`),p=v.height+4}let w=(l-x.width)/2;return m(b).attr(`transform`,`translate( `+(-1*l/2+w)+`, `+(-1*u/2+p)+`)`),p+=x.height+4,s.attr(`class`,`divider`).attr(`x1`,-l/2-r).attr(`x2`,l/2+r).attr(`y1`,-u/2-r+8+p).attr(`y2`,-u/2-r+8+p),p+=8,S.forEach(e=>{m(e).attr(`transform`,`translate( `+-l/2+`, `+(-1*u/2+p+8/2)+`)`);let t=e?.getBBox();p+=(t?.height??0)+4}),p+=8,c.attr(`class`,`divider`).attr(`x1`,-l/2-r).attr(`x2`,l/2+r).attr(`y1`,-u/2-r+8+p).attr(`y2`,-u/2-r+8+p),p+=8,C.forEach(e=>{m(e).attr(`transform`,`translate( `+-l/2+`, `+(-1*u/2+p)+`)`);let t=e?.getBBox();p+=(t?.height??0)+4}),o.attr(`style`,n.style).attr(`class`,`outer title-state`).attr(`x`,-l/2-r).attr(`y`,-(u/2)-r).attr(`width`,l+n.padding).attr(`height`,u+n.padding),X(n,o),n.intersect=function(e){return J.rect(n,e)},a},`class_box`)},Nt={},Pt=E(async(e,t,n)=>{let r,i;if(t.link){let a;d().securityLevel===`sandbox`?a=`_top`:t.linkTarget&&(a=t.linkTarget||`_blank`),r=e.insert(`svg:a`).attr(`xlink:href`,t.link).attr(`target`,a),i=await Mt[t.shape](r,t,n)}else i=await Mt[t.shape](e,t,n),r=i;return t.tooltip&&i.attr(`title`,t.tooltip),t.class&&i.attr(`class`,`node default `+t.class),Nt[t.id]=r,t.haveCallback&&Nt[t.id].attr(`class`,Nt[t.id].attr(`class`)+` clickable`),r},`insertNode`),Ft=E(e=>{let t=Nt[e.id];f.trace(`Transforming node`,e.diff,e,`translate(`+(e.x-e.width/2-5)+`, `+e.width/2+`)`);let n=e.diff||0;return e.clusterNode?t.attr(`transform`,`translate(`+(e.x+n-e.width/2)+`, `+(e.y-e.height/2-8)+`)`):t.attr(`transform`,`translate(`+e.x+`, `+e.y+`)`),n},`positionNode`);function It(e,t,n=!1){let r=e,i=`default`;(r?.classes?.length||0)>0&&(i=(r?.classes??[]).join(` `)),i+=` flowchart-label`;let o=0,s=``,c;switch(r.type){case`round`:o=5,s=`rect`;break;case`composite`:o=0,s=`composite`,c=0;break;case`square`:s=`rect`;break;case`diamond`:s=`question`;break;case`hexagon`:s=`hexagon`;break;case`block_arrow`:s=`block_arrow`;break;case`odd`:s=`rect_left_inv_arrow`;break;case`lean_right`:s=`lean_right`;break;case`lean_left`:s=`lean_left`;break;case`trapezoid`:s=`trapezoid`;break;case`inv_trapezoid`:s=`inv_trapezoid`;break;case`rect_left_inv_arrow`:s=`rect_left_inv_arrow`;break;case`circle`:s=`circle`;break;case`ellipse`:s=`ellipse`;break;case`stadium`:s=`stadium`;break;case`subroutine`:s=`subroutine`;break;case`cylinder`:s=`cylinder`;break;case`group`:s=`rect`;break;case`doublecircle`:s=`doublecircle`;break;default:s=`rect`}let l=a(r?.styles??[]),u=r.label,d=r.size??{width:0,height:0,x:0,y:0};return{labelStyle:l.labelStyle,shape:s,labelText:u,rx:o,ry:o,class:i,style:l.style,id:r.id,directions:r.directions,width:d.width,height:d.height,x:d.x,y:d.y,positioned:n,intersect:void 0,type:r.type,padding:c??h()?.block?.padding??0}}E(It,`getNodeFromBlock`);async function Lt(e,t,n){let r=It(t,n,!1);if(r.type===`group`)return;let i=await Pt(e,r,{config:h()}),a=i.node().getBBox(),o=n.getBlock(r.id);o.size={width:a.width,height:a.height,x:0,y:0,node:i},n.setBlock(o),i.remove()}E(Lt,`calculateBlockSize`);async function Rt(e,t,n){let r=It(t,n,!0);n.getBlock(r.id).type!==`space`&&(await Pt(e,r,{config:h()}),t.intersect=r?.intersect,Ft(r))}E(Rt,`insertBlockPositioned`);async function zt(e,t,n,r){for(let i of t)await r(e,i,n),i.children&&await zt(e,i.children,n,r)}E(zt,`performOperations`);async function Bt(e,t,n){await zt(e,t,n,Lt)}E(Bt,`calculateBlockSizes`);async function Vt(e,t,n){await zt(e,t,n,Rt)}E(Vt,`insertBlocks`);async function Ht(e,t,n,r,i){let a=new N({multigraph:!0,compound:!0});a.setGraph({rankdir:`TB`,nodesep:10,ranksep:10,marginx:8,marginy:8});for(let e of n)e.size&&a.setNode(e.id,{width:e.size.width,height:e.size.height,intersect:e.intersect});for(let n of t)if(n.start&&n.end){let t=r.getBlock(n.start),o=r.getBlock(n.end);if(t?.size&&o?.size){let r=t.size,s=o.size,c=[{x:r.x,y:r.y},{x:r.x+(s.x-r.x)/2,y:r.y+(s.y-r.y)/2},{x:s.x,y:s.y}];Ye(e,{v:n.start,w:n.end,name:n.id},{...n,arrowTypeEnd:n.arrowTypeEnd,arrowTypeStart:n.arrowTypeStart,points:c,classes:`edge-thickness-normal edge-pattern-solid flowchart-link LS-a1 LE-b1`},void 0,`block`,a,i),n.label&&(await We(e,{...n,label:n.label,labelStyle:`stroke: #333; stroke-width: 1.5px;fill:none;`,arrowTypeEnd:n.arrowTypeEnd,arrowTypeStart:n.arrowTypeStart,points:c,classes:`edge-thickness-normal edge-pattern-solid flowchart-link LS-a1 LE-b1`}),Ge({...n,x:c[1].x,y:c[1].y},{originalPath:c}))}}}E(Ht,`insertEdges`);var Ut={parser:le,db:Oe,renderer:{draw:E(async function(e,t,n,r){let{securityLevel:i,block:a}=h(),o=r.db,s;i===`sandbox`&&(s=m(`#i`+t));let c=m(i===`sandbox`?s.nodes()[0].contentDocument.body:`body`),l=i===`sandbox`?c.select(`[id="${t}"]`):m(`[id="${t}"]`);Me(l,[`point`,`circle`,`cross`],r.type,t);let d=o.getBlocks(),p=o.getBlocksFlat(),g=o.getEdges(),_=l.insert(`g`).attr(`class`,`block`);await Bt(_,d,o);let v=Le(o);if(await Vt(_,d,o),await Ht(_,g,p,o,t),v){let e=v,t=Math.max(1,Math.round(.125*(e.width/e.height))),n=e.height+t+10,r=e.width+10,{useMaxWidth:i}=a;u(l,n,r,!!i),f.debug(`Here Bounds`,v,e),l.attr(`viewBox`,`${e.x-5} ${e.y-5} ${e.width+10} ${e.height+10}`)}},`draw`),getClasses:E(function(e,t){return t.db.getClasses()},`getClasses`)},styles:ke};export{oe as a,I as i,se as n,ie as o,ae as r,N as s,Ut as t};