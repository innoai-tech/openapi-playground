import { w, $ as $$1 } from "./vendor-min-mermaid~chunk-P7KHIEPL.BjjzEN9x.chunk.js";
import { S } from "./vendor-min-mermaid~chunk-54VS5GG6.CB8Wh_hC.chunk.js";
import { I as Ie$1, C as Ce$1 } from "./vendor-min-mermaid~chunk-UENA7NWE.DfvA4zio.chunk.js";
import { B as Bf, w as wf, S as Sf, v as vf, T as Tf, k as kf, t as tt, W as Wl, m as mC, b as bf } from "./vendor-min-mermaid~chunk-OR2G2HG5.D15VT8Rm.chunk.js";
import { m as m$1 } from "./vendor-min-mermaid~chunk-GTKDMUJJ.Q7R0ayzM.chunk.js";
var Pt = /* @__PURE__ */ function() {
  var t = /* @__PURE__ */ m$1(function(w2, c, u, a) {
    for (u = u || {}, a = w2.length; a--; u[w2[a]] = c) ;
    return u;
  }, "o"), e = [
    1,
    2
  ], l = [
    1,
    3
  ], n = [
    1,
    4
  ], p = [
    2,
    4
  ], i = [
    1,
    9
  ], d = [
    1,
    11
  ], E = [
    1,
    16
  ], o = [
    1,
    17
  ], _ = [
    1,
    18
  ], k = [
    1,
    19
  ], N = [
    1,
    32
  ], I = [
    1,
    20
  ], f = [
    1,
    21
  ], L = [
    1,
    22
  ], R = [
    1,
    23
  ], F = [
    1,
    24
  ], B = [
    1,
    26
  ], P = [
    1,
    27
  ], G = [
    1,
    28
  ], rt = [
    1,
    29
  ], it = [
    1,
    30
  ], nt = [
    1,
    31
  ], at = [
    1,
    34
  ], ot = [
    1,
    35
  ], ct = [
    1,
    36
  ], lt = [
    1,
    37
  ], Q = [
    1,
    33
  ], S2 = [
    1,
    4,
    5,
    16,
    17,
    19,
    21,
    22,
    24,
    25,
    26,
    27,
    28,
    29,
    33,
    35,
    37,
    38,
    42,
    45,
    48,
    49,
    50,
    51,
    54
  ], ut = [
    1,
    4,
    5,
    14,
    15,
    16,
    17,
    19,
    21,
    22,
    24,
    25,
    26,
    27,
    28,
    29,
    33,
    35,
    37,
    38,
    42,
    45,
    48,
    49,
    50,
    51,
    54
  ], ee = [
    4,
    5,
    16,
    17,
    19,
    21,
    22,
    24,
    25,
    26,
    27,
    28,
    29,
    33,
    35,
    37,
    38,
    42,
    45,
    48,
    49,
    50,
    51,
    54
  ], Ct = {
    trace: /* @__PURE__ */ m$1(function() {
    }, "trace"),
    yy: {},
    symbols_: {
      error: 2,
      start: 3,
      SPACE: 4,
      NL: 5,
      SD: 6,
      document: 7,
      line: 8,
      statement: 9,
      classDefStatement: 10,
      styleStatement: 11,
      cssClassStatement: 12,
      idStatement: 13,
      DESCR: 14,
      "-->": 15,
      HIDE_EMPTY: 16,
      scale: 17,
      WIDTH: 18,
      COMPOSIT_STATE: 19,
      STRUCT_START: 20,
      STRUCT_STOP: 21,
      STATE_DESCR: 22,
      AS: 23,
      ID: 24,
      FORK: 25,
      JOIN: 26,
      CHOICE: 27,
      CONCURRENT: 28,
      note: 29,
      notePosition: 30,
      NOTE_TEXT: 31,
      direction: 32,
      acc_title: 33,
      acc_title_value: 34,
      acc_descr: 35,
      acc_descr_value: 36,
      acc_descr_multiline_value: 37,
      classDef: 38,
      CLASSDEF_ID: 39,
      CLASSDEF_STYLEOPTS: 40,
      DEFAULT: 41,
      style: 42,
      STYLE_IDS: 43,
      STYLEDEF_STYLEOPTS: 44,
      class: 45,
      CLASSENTITY_IDS: 46,
      STYLECLASS: 47,
      direction_tb: 48,
      direction_bt: 49,
      direction_rl: 50,
      direction_lr: 51,
      eol: 52,
      ";": 53,
      EDGE_STATE: 54,
      STYLE_SEPARATOR: 55,
      left_of: 56,
      right_of: 57,
      $accept: 0,
      $end: 1
    },
    terminals_: {
      2: "error",
      4: "SPACE",
      5: "NL",
      6: "SD",
      14: "DESCR",
      15: "-->",
      16: "HIDE_EMPTY",
      17: "scale",
      18: "WIDTH",
      19: "COMPOSIT_STATE",
      20: "STRUCT_START",
      21: "STRUCT_STOP",
      22: "STATE_DESCR",
      23: "AS",
      24: "ID",
      25: "FORK",
      26: "JOIN",
      27: "CHOICE",
      28: "CONCURRENT",
      29: "note",
      31: "NOTE_TEXT",
      33: "acc_title",
      34: "acc_title_value",
      35: "acc_descr",
      36: "acc_descr_value",
      37: "acc_descr_multiline_value",
      38: "classDef",
      39: "CLASSDEF_ID",
      40: "CLASSDEF_STYLEOPTS",
      41: "DEFAULT",
      42: "style",
      43: "STYLE_IDS",
      44: "STYLEDEF_STYLEOPTS",
      45: "class",
      46: "CLASSENTITY_IDS",
      47: "STYLECLASS",
      48: "direction_tb",
      49: "direction_bt",
      50: "direction_rl",
      51: "direction_lr",
      53: ";",
      54: "EDGE_STATE",
      55: "STYLE_SEPARATOR",
      56: "left_of",
      57: "right_of"
    },
    productions_: [
      0,
      [
        3,
        2
      ],
      [
        3,
        2
      ],
      [
        3,
        2
      ],
      [
        7,
        0
      ],
      [
        7,
        2
      ],
      [
        8,
        2
      ],
      [
        8,
        1
      ],
      [
        8,
        1
      ],
      [
        9,
        1
      ],
      [
        9,
        1
      ],
      [
        9,
        1
      ],
      [
        9,
        1
      ],
      [
        9,
        2
      ],
      [
        9,
        3
      ],
      [
        9,
        4
      ],
      [
        9,
        1
      ],
      [
        9,
        2
      ],
      [
        9,
        1
      ],
      [
        9,
        4
      ],
      [
        9,
        3
      ],
      [
        9,
        6
      ],
      [
        9,
        1
      ],
      [
        9,
        1
      ],
      [
        9,
        1
      ],
      [
        9,
        1
      ],
      [
        9,
        4
      ],
      [
        9,
        4
      ],
      [
        9,
        1
      ],
      [
        9,
        2
      ],
      [
        9,
        2
      ],
      [
        9,
        1
      ],
      [
        10,
        3
      ],
      [
        10,
        3
      ],
      [
        11,
        3
      ],
      [
        12,
        3
      ],
      [
        32,
        1
      ],
      [
        32,
        1
      ],
      [
        32,
        1
      ],
      [
        32,
        1
      ],
      [
        52,
        1
      ],
      [
        52,
        1
      ],
      [
        13,
        1
      ],
      [
        13,
        1
      ],
      [
        13,
        3
      ],
      [
        13,
        3
      ],
      [
        30,
        1
      ],
      [
        30,
        1
      ]
    ],
    performAction: /* @__PURE__ */ m$1(function(c, u, a, y, T, r, Z) {
      var h = r.length - 1;
      switch (T) {
        case 3:
          return y.setRootDoc(r[h]), r[h];
        case 4:
          this.$ = [];
          break;
        case 5:
          r[h] != "nl" && (r[h - 1].push(r[h]), this.$ = r[h - 1]);
          break;
        case 6:
        case 7:
          this.$ = r[h];
          break;
        case 8:
          this.$ = "nl";
          break;
        case 12:
          this.$ = r[h];
          break;
        case 13:
          let ht = r[h - 1];
          ht.description = /* @__PURE__ */ y.trimColon(r[h]), this.$ = ht;
          break;
        case 14:
          this.$ = {
            stmt: "relation",
            state1: r[h - 2],
            state2: r[h]
          };
          break;
        case 15:
          let pt = /* @__PURE__ */ y.trimColon(r[h]);
          this.$ = {
            stmt: "relation",
            state1: r[h - 3],
            state2: r[h - 1],
            description: pt
          };
          break;
        case 19:
          this.$ = {
            stmt: "state",
            id: r[h - 3],
            type: "default",
            description: "",
            doc: r[h - 1]
          };
          break;
        case 20:
          var M = r[h], z = /* @__PURE__ */ r[h - 2].trim();
          if (r[h].match(":")) {
            var tt2 = /* @__PURE__ */ r[h].split(":");
            M = tt2[0], z = [
              z,
              tt2[1]
            ];
          }
          this.$ = {
            stmt: "state",
            id: M,
            type: "default",
            description: z
          };
          break;
        case 21:
          this.$ = {
            stmt: "state",
            id: r[h - 3],
            type: "default",
            description: r[h - 5],
            doc: r[h - 1]
          };
          break;
        case 22:
          this.$ = {
            stmt: "state",
            id: r[h],
            type: "fork"
          };
          break;
        case 23:
          this.$ = {
            stmt: "state",
            id: r[h],
            type: "join"
          };
          break;
        case 24:
          this.$ = {
            stmt: "state",
            id: r[h],
            type: "choice"
          };
          break;
        case 25:
          this.$ = {
            stmt: "state",
            id: /* @__PURE__ */ y.getDividerId(),
            type: "divider"
          };
          break;
        case 26:
          this.$ = {
            stmt: "state",
            id: /* @__PURE__ */ r[h - 1].trim(),
            note: {
              position: /* @__PURE__ */ r[h - 2].trim(),
              text: /* @__PURE__ */ r[h].trim()
            }
          };
          break;
        case 29:
          this.$ = /* @__PURE__ */ r[h].trim(), y.setAccTitle(this.$);
          break;
        case 30:
        case 31:
          this.$ = /* @__PURE__ */ r[h].trim(), y.setAccDescription(this.$);
          break;
        case 32:
        case 33:
          this.$ = {
            stmt: "classDef",
            id: /* @__PURE__ */ r[h - 1].trim(),
            classes: /* @__PURE__ */ r[h].trim()
          };
          break;
        case 34:
          this.$ = {
            stmt: "style",
            id: /* @__PURE__ */ r[h - 1].trim(),
            styleClass: /* @__PURE__ */ r[h].trim()
          };
          break;
        case 35:
          this.$ = {
            stmt: "applyClass",
            id: /* @__PURE__ */ r[h - 1].trim(),
            styleClass: /* @__PURE__ */ r[h].trim()
          };
          break;
        case 36:
          y.setDirection("TB"), this.$ = {
            stmt: "dir",
            value: "TB"
          };
          break;
        case 37:
          y.setDirection("BT"), this.$ = {
            stmt: "dir",
            value: "BT"
          };
          break;
        case 38:
          y.setDirection("RL"), this.$ = {
            stmt: "dir",
            value: "RL"
          };
          break;
        case 39:
          y.setDirection("LR"), this.$ = {
            stmt: "dir",
            value: "LR"
          };
          break;
        case 42:
        case 43:
          this.$ = {
            stmt: "state",
            id: /* @__PURE__ */ r[h].trim(),
            type: "default",
            description: ""
          };
          break;
        case 44:
          this.$ = {
            stmt: "state",
            id: /* @__PURE__ */ r[h - 2].trim(),
            classes: [
              /* @__PURE__ */ r[h].trim()
            ],
            type: "default",
            description: ""
          };
          break;
        case 45:
          this.$ = {
            stmt: "state",
            id: /* @__PURE__ */ r[h - 2].trim(),
            classes: [
              /* @__PURE__ */ r[h].trim()
            ],
            type: "default",
            description: ""
          };
          break;
      }
    }, "anonymous"),
    table: [
      {
        3: 1,
        4: e,
        5: l,
        6: n
      },
      {
        1: [
          3
        ]
      },
      {
        3: 5,
        4: e,
        5: l,
        6: n
      },
      {
        3: 6,
        4: e,
        5: l,
        6: n
      },
      /* @__PURE__ */ t([
        1,
        4,
        5,
        16,
        17,
        19,
        22,
        24,
        25,
        26,
        27,
        28,
        29,
        33,
        35,
        37,
        38,
        42,
        45,
        48,
        49,
        50,
        51,
        54
      ], p, {
        7: 7
      }),
      {
        1: [
          2,
          1
        ]
      },
      {
        1: [
          2,
          2
        ]
      },
      {
        1: [
          2,
          3
        ],
        4: i,
        5: d,
        8: 8,
        9: 10,
        10: 12,
        11: 13,
        12: 14,
        13: 15,
        16: E,
        17: o,
        19: _,
        22: k,
        24: N,
        25: I,
        26: f,
        27: L,
        28: R,
        29: F,
        32: 25,
        33: B,
        35: P,
        37: G,
        38: rt,
        42: it,
        45: nt,
        48: at,
        49: ot,
        50: ct,
        51: lt,
        54: Q
      },
      /* @__PURE__ */ t(S2, [
        2,
        5
      ]),
      {
        9: 38,
        10: 12,
        11: 13,
        12: 14,
        13: 15,
        16: E,
        17: o,
        19: _,
        22: k,
        24: N,
        25: I,
        26: f,
        27: L,
        28: R,
        29: F,
        32: 25,
        33: B,
        35: P,
        37: G,
        38: rt,
        42: it,
        45: nt,
        48: at,
        49: ot,
        50: ct,
        51: lt,
        54: Q
      },
      /* @__PURE__ */ t(S2, [
        2,
        7
      ]),
      /* @__PURE__ */ t(S2, [
        2,
        8
      ]),
      /* @__PURE__ */ t(S2, [
        2,
        9
      ]),
      /* @__PURE__ */ t(S2, [
        2,
        10
      ]),
      /* @__PURE__ */ t(S2, [
        2,
        11
      ]),
      /* @__PURE__ */ t(S2, [
        2,
        12
      ], {
        14: [
          1,
          39
        ],
        15: [
          1,
          40
        ]
      }),
      /* @__PURE__ */ t(S2, [
        2,
        16
      ]),
      {
        18: [
          1,
          41
        ]
      },
      /* @__PURE__ */ t(S2, [
        2,
        18
      ], {
        20: [
          1,
          42
        ]
      }),
      {
        23: [
          1,
          43
        ]
      },
      /* @__PURE__ */ t(S2, [
        2,
        22
      ]),
      /* @__PURE__ */ t(S2, [
        2,
        23
      ]),
      /* @__PURE__ */ t(S2, [
        2,
        24
      ]),
      /* @__PURE__ */ t(S2, [
        2,
        25
      ]),
      {
        30: 44,
        31: [
          1,
          45
        ],
        56: [
          1,
          46
        ],
        57: [
          1,
          47
        ]
      },
      /* @__PURE__ */ t(S2, [
        2,
        28
      ]),
      {
        34: [
          1,
          48
        ]
      },
      {
        36: [
          1,
          49
        ]
      },
      /* @__PURE__ */ t(S2, [
        2,
        31
      ]),
      {
        39: [
          1,
          50
        ],
        41: [
          1,
          51
        ]
      },
      {
        43: [
          1,
          52
        ]
      },
      {
        46: [
          1,
          53
        ]
      },
      /* @__PURE__ */ t(ut, [
        2,
        42
      ], {
        55: [
          1,
          54
        ]
      }),
      /* @__PURE__ */ t(ut, [
        2,
        43
      ], {
        55: [
          1,
          55
        ]
      }),
      /* @__PURE__ */ t(S2, [
        2,
        36
      ]),
      /* @__PURE__ */ t(S2, [
        2,
        37
      ]),
      /* @__PURE__ */ t(S2, [
        2,
        38
      ]),
      /* @__PURE__ */ t(S2, [
        2,
        39
      ]),
      /* @__PURE__ */ t(S2, [
        2,
        6
      ]),
      /* @__PURE__ */ t(S2, [
        2,
        13
      ]),
      {
        13: 56,
        24: N,
        54: Q
      },
      /* @__PURE__ */ t(S2, [
        2,
        17
      ]),
      /* @__PURE__ */ t(ee, p, {
        7: 57
      }),
      {
        24: [
          1,
          58
        ]
      },
      {
        24: [
          1,
          59
        ]
      },
      {
        23: [
          1,
          60
        ]
      },
      {
        24: [
          2,
          46
        ]
      },
      {
        24: [
          2,
          47
        ]
      },
      /* @__PURE__ */ t(S2, [
        2,
        29
      ]),
      /* @__PURE__ */ t(S2, [
        2,
        30
      ]),
      {
        40: [
          1,
          61
        ]
      },
      {
        40: [
          1,
          62
        ]
      },
      {
        44: [
          1,
          63
        ]
      },
      {
        47: [
          1,
          64
        ]
      },
      {
        24: [
          1,
          65
        ]
      },
      {
        24: [
          1,
          66
        ]
      },
      /* @__PURE__ */ t(S2, [
        2,
        14
      ], {
        14: [
          1,
          67
        ]
      }),
      {
        4: i,
        5: d,
        8: 8,
        9: 10,
        10: 12,
        11: 13,
        12: 14,
        13: 15,
        16: E,
        17: o,
        19: _,
        21: [
          1,
          68
        ],
        22: k,
        24: N,
        25: I,
        26: f,
        27: L,
        28: R,
        29: F,
        32: 25,
        33: B,
        35: P,
        37: G,
        38: rt,
        42: it,
        45: nt,
        48: at,
        49: ot,
        50: ct,
        51: lt,
        54: Q
      },
      /* @__PURE__ */ t(S2, [
        2,
        20
      ], {
        20: [
          1,
          69
        ]
      }),
      {
        31: [
          1,
          70
        ]
      },
      {
        24: [
          1,
          71
        ]
      },
      /* @__PURE__ */ t(S2, [
        2,
        32
      ]),
      /* @__PURE__ */ t(S2, [
        2,
        33
      ]),
      /* @__PURE__ */ t(S2, [
        2,
        34
      ]),
      /* @__PURE__ */ t(S2, [
        2,
        35
      ]),
      /* @__PURE__ */ t(ut, [
        2,
        44
      ]),
      /* @__PURE__ */ t(ut, [
        2,
        45
      ]),
      /* @__PURE__ */ t(S2, [
        2,
        15
      ]),
      /* @__PURE__ */ t(S2, [
        2,
        19
      ]),
      /* @__PURE__ */ t(ee, p, {
        7: 72
      }),
      /* @__PURE__ */ t(S2, [
        2,
        26
      ]),
      /* @__PURE__ */ t(S2, [
        2,
        27
      ]),
      {
        4: i,
        5: d,
        8: 8,
        9: 10,
        10: 12,
        11: 13,
        12: 14,
        13: 15,
        16: E,
        17: o,
        19: _,
        21: [
          1,
          73
        ],
        22: k,
        24: N,
        25: I,
        26: f,
        27: L,
        28: R,
        29: F,
        32: 25,
        33: B,
        35: P,
        37: G,
        38: rt,
        42: it,
        45: nt,
        48: at,
        49: ot,
        50: ct,
        51: lt,
        54: Q
      },
      /* @__PURE__ */ t(S2, [
        2,
        21
      ])
    ],
    defaultActions: {
      5: [
        2,
        1
      ],
      6: [
        2,
        2
      ],
      46: [
        2,
        46
      ],
      47: [
        2,
        47
      ]
    },
    parseError: /* @__PURE__ */ m$1(function(c, u) {
      if (u.recoverable) this.trace(c);
      else {
        var a = new Error(c);
        throw a.hash = u, a;
      }
    }, "parseError"),
    parse: /* @__PURE__ */ m$1(function(c) {
      var u = this, a = [
        0
      ], y = [], T = [
        null
      ], r = [], Z = this.table, h = "", M = 0, z = 0, tt2 = 0, ht = 2, pt = 1, ze = /* @__PURE__ */ r.slice.call(arguments, 1), b = /* @__PURE__ */ Object.create(this.lexer), V = {
        yy: {}
      };
      for (var It in this.yy) Object.prototype.hasOwnProperty.call(this.yy, It) && (V.yy[It] = this.yy[It]);
      b.setInput(c, V.yy), V.yy.lexer = b, V.yy.parser = this, typeof b.yylloc > "u" && (b.yylloc = {});
      var Rt = b.yylloc;
      r.push(Rt);
      var We = b.options && b.options.ranges;
      typeof V.yy.parseError == "function" ? this.parseError = V.yy.parseError : this.parseError = Object.getPrototypeOf(this).parseError;
      function Cs(A) {
        a.length = a.length - 2 * A, T.length = T.length - A, r.length = r.length - A;
      }
      m$1(Cs, "popStack");
      function Xe() {
        var A;
        return A = y.pop() || b.lex() || pt, typeof A != "number" && (A instanceof Array && (y = A, A = /* @__PURE__ */ y.pop()), A = u.symbols_[A] || A), A;
      }
      m$1(Xe, "lex");
      for (var m, vt, U, C, Ls, Ot, W = {}, ft, v, se, dt; ; ) {
        if (U = a[a.length - 1], this.defaultActions[U] ? C = this.defaultActions[U] : ((m === null || typeof m > "u") && (m = /* @__PURE__ */ Xe()), C = Z[U] && Z[U][m]), typeof C > "u" || !C.length || !C[0]) {
          var Nt = "";
          dt = [];
          for (ft in Z[U]) this.terminals_[ft] && ft > ht && dt.push("'" + this.terminals_[ft] + "'");
          b.showPosition ? Nt = "Parse error on line " + (M + 1) + `:
` + b.showPosition() + `
Expecting ` + dt.join(", ") + ", got '" + (this.terminals_[m] || m) + "'" : Nt = "Parse error on line " + (M + 1) + ": Unexpected " + (m == pt ? "end of input" : "'" + (this.terminals_[m] || m) + "'"), this.parseError(Nt, {
            text: b.match,
            token: this.terminals_[m] || m,
            line: b.yylineno,
            loc: Rt,
            expected: dt
          });
        }
        if (C[0] instanceof Array && C.length > 1) throw new Error("Parse Error: multiple actions possible at state: " + U + ", token: " + m);
        switch (C[0]) {
          case 1:
            a.push(m), T.push(b.yytext), r.push(b.yylloc), a.push(C[1]), m = null, vt ? (m = vt, vt = null) : (z = b.yyleng, h = b.yytext, M = b.yylineno, Rt = b.yylloc, tt2 > 0);
            break;
          case 2:
            if (v = this.productions_[C[1]][1], W.$ = T[T.length - v], W._$ = {
              first_line: r[r.length - (v || 1)].first_line,
              last_line: r[r.length - 1].last_line,
              first_column: r[r.length - (v || 1)].first_column,
              last_column: r[r.length - 1].last_column
            }, We && (W._$.range = [
              r[r.length - (v || 1)].range[0],
              r[r.length - 1].range[1]
            ]), Ot = /* @__PURE__ */ this.performAction.apply(W, /* @__PURE__ */ [
              h,
              z,
              M,
              V.yy,
              C[1],
              T,
              r
            ].concat(ze)), typeof Ot < "u") return Ot;
            v && (a = /* @__PURE__ */ a.slice(0, -1 * v * 2), T = /* @__PURE__ */ T.slice(0, -1 * v), r = /* @__PURE__ */ r.slice(0, -1 * v)), a.push(this.productions_[C[1]][0]), T.push(W.$), r.push(W._$), se = Z[a[a.length - 2]][a[a.length - 1]], a.push(se);
            break;
          case 3:
            return true;
        }
      }
      return true;
    }, "parse")
  }, je = /* @__PURE__ */ function() {
    var w2 = {
      EOF: 1,
      parseError: /* @__PURE__ */ m$1(function(u, a) {
        if (this.yy.parser) this.yy.parser.parseError(u, a);
        else throw new Error(u);
      }, "parseError"),
      setInput: /* @__PURE__ */ m$1(function(c, u) {
        return this.yy = u || this.yy || {}, this._input = c, this._more = this._backtrack = this.done = false, this.yylineno = this.yyleng = 0, this.yytext = this.matched = this.match = "", this.conditionStack = [
          "INITIAL"
        ], this.yylloc = {
          first_line: 1,
          first_column: 0,
          last_line: 1,
          last_column: 0
        }, this.options.ranges && (this.yylloc.range = [
          0,
          0
        ]), this.offset = 0, this;
      }, "setInput"),
      input: /* @__PURE__ */ m$1(function() {
        var c = this._input[0];
        this.yytext += c, this.yyleng++, this.offset++, this.match += c, this.matched += c;
        var u = /* @__PURE__ */ c.match(/(?:\r\n?|\n).*/g);
        return u ? (this.yylineno++, this.yylloc.last_line++) : this.yylloc.last_column++, this.options.ranges && this.yylloc.range[1]++, this._input = /* @__PURE__ */ this._input.slice(1), c;
      }, "input"),
      unput: /* @__PURE__ */ m$1(function(c) {
        var u = c.length, a = /* @__PURE__ */ c.split(/(?:\r\n?|\n)/g);
        this._input = c + this._input, this.yytext = /* @__PURE__ */ this.yytext.substr(0, this.yytext.length - u), this.offset -= u;
        var y = /* @__PURE__ */ this.match.split(/(?:\r\n?|\n)/g);
        this.match = /* @__PURE__ */ this.match.substr(0, this.match.length - 1), this.matched = /* @__PURE__ */ this.matched.substr(0, this.matched.length - 1), a.length - 1 && (this.yylineno -= a.length - 1);
        var T = this.yylloc.range;
        return this.yylloc = {
          first_line: this.yylloc.first_line,
          last_line: this.yylineno + 1,
          first_column: this.yylloc.first_column,
          last_column: a ? (a.length === y.length ? this.yylloc.first_column : 0) + y[y.length - a.length].length - a[0].length : this.yylloc.first_column - u
        }, this.options.ranges && (this.yylloc.range = [
          T[0],
          T[0] + this.yyleng - u
        ]), this.yyleng = this.yytext.length, this;
      }, "unput"),
      more: /* @__PURE__ */ m$1(function() {
        return this._more = true, this;
      }, "more"),
      reject: /* @__PURE__ */ m$1(function() {
        if (this.options.backtrack_lexer) this._backtrack = true;
        else return this.parseError("Lexical error on line " + (this.yylineno + 1) + `. You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).
` + this.showPosition(), {
          text: "",
          token: null,
          line: this.yylineno
        });
        return this;
      }, "reject"),
      less: /* @__PURE__ */ m$1(function(c) {
        this.unput(/* @__PURE__ */ this.match.slice(c));
      }, "less"),
      pastInput: /* @__PURE__ */ m$1(function() {
        var c = /* @__PURE__ */ this.matched.substr(0, this.matched.length - this.match.length);
        return (c.length > 20 ? "..." : "") + c.substr(-20).replace(/\n/g, "");
      }, "pastInput"),
      upcomingInput: /* @__PURE__ */ m$1(function() {
        var c = this.match;
        return c.length < 20 && (c += /* @__PURE__ */ this._input.substr(0, 20 - c.length)), (c.substr(0, 20) + (c.length > 20 ? "..." : "")).replace(/\n/g, "");
      }, "upcomingInput"),
      showPosition: /* @__PURE__ */ m$1(function() {
        var c = /* @__PURE__ */ this.pastInput(), u = /* @__PURE__ */ new Array(c.length + 1).join("-");
        return c + this.upcomingInput() + `
` + u + "^";
      }, "showPosition"),
      test_match: /* @__PURE__ */ m$1(function(c, u) {
        var a, y, T;
        if (this.options.backtrack_lexer && (T = {
          yylineno: this.yylineno,
          yylloc: {
            first_line: this.yylloc.first_line,
            last_line: this.last_line,
            first_column: this.yylloc.first_column,
            last_column: this.yylloc.last_column
          },
          yytext: this.yytext,
          match: this.match,
          matches: this.matches,
          matched: this.matched,
          yyleng: this.yyleng,
          offset: this.offset,
          _more: this._more,
          _input: this._input,
          yy: this.yy,
          conditionStack: /* @__PURE__ */ this.conditionStack.slice(0),
          done: this.done
        }, this.options.ranges && (T.yylloc.range = /* @__PURE__ */ this.yylloc.range.slice(0))), y = /* @__PURE__ */ c[0].match(/(?:\r\n?|\n).*/g), y && (this.yylineno += y.length), this.yylloc = {
          first_line: this.yylloc.last_line,
          last_line: this.yylineno + 1,
          first_column: this.yylloc.last_column,
          last_column: y ? y[y.length - 1].length - y[y.length - 1].match(/\r?\n?/)[0].length : this.yylloc.last_column + c[0].length
        }, this.yytext += c[0], this.match += c[0], this.matches = c, this.yyleng = this.yytext.length, this.options.ranges && (this.yylloc.range = [
          this.offset,
          this.offset += this.yyleng
        ]), this._more = false, this._backtrack = false, this._input = /* @__PURE__ */ this._input.slice(c[0].length), this.matched += c[0], a = /* @__PURE__ */ this.performAction.call(this, this.yy, this, u, this.conditionStack[this.conditionStack.length - 1]), this.done && this._input && (this.done = false), a) return a;
        if (this._backtrack) {
          for (var r in T) this[r] = T[r];
          return false;
        }
        return false;
      }, "test_match"),
      next: /* @__PURE__ */ m$1(function() {
        if (this.done) return this.EOF;
        this._input || (this.done = true);
        var c, u, a, y;
        this._more || (this.yytext = "", this.match = "");
        for (var T = /* @__PURE__ */ this._currentRules(), r = 0; r < T.length; r++) if (a = /* @__PURE__ */ this._input.match(this.rules[T[r]]), a && (!u || a[0].length > u[0].length)) {
          if (u = a, y = r, this.options.backtrack_lexer) {
            if (c = /* @__PURE__ */ this.test_match(a, T[r]), c !== false) return c;
            if (this._backtrack) {
              u = false;
              continue;
            } else return false;
          } else if (!this.options.flex) break;
        }
        return u ? (c = /* @__PURE__ */ this.test_match(u, T[y]), c !== false ? c : false) : this._input === "" ? this.EOF : this.parseError("Lexical error on line " + (this.yylineno + 1) + `. Unrecognized text.
` + this.showPosition(), {
          text: "",
          token: null,
          line: this.yylineno
        });
      }, "next"),
      lex: /* @__PURE__ */ m$1(function() {
        var u = /* @__PURE__ */ this.next();
        return u || this.lex();
      }, "lex"),
      begin: /* @__PURE__ */ m$1(function(u) {
        this.conditionStack.push(u);
      }, "begin"),
      popState: /* @__PURE__ */ m$1(function() {
        var u = this.conditionStack.length - 1;
        return u > 0 ? this.conditionStack.pop() : this.conditionStack[0];
      }, "popState"),
      _currentRules: /* @__PURE__ */ m$1(function() {
        return this.conditionStack.length && this.conditionStack[this.conditionStack.length - 1] ? this.conditions[this.conditionStack[this.conditionStack.length - 1]].rules : this.conditions.INITIAL.rules;
      }, "_currentRules"),
      topState: /* @__PURE__ */ m$1(function(u) {
        return u = this.conditionStack.length - 1 - Math.abs(u || 0), u >= 0 ? this.conditionStack[u] : "INITIAL";
      }, "topState"),
      pushState: /* @__PURE__ */ m$1(function(u) {
        this.begin(u);
      }, "pushState"),
      stateStackSize: /* @__PURE__ */ m$1(function() {
        return this.conditionStack.length;
      }, "stateStackSize"),
      options: {
        "case-insensitive": true
      },
      performAction: /* @__PURE__ */ m$1(function(u, a, y, T) {
        switch (y) {
          case 0:
            return 41;
          case 1:
            return 48;
          case 2:
            return 49;
          case 3:
            return 50;
          case 4:
            return 51;
          case 5:
            break;
          case 6:
            break;
          case 7:
            return 5;
          case 8:
            break;
          case 9:
            break;
          case 10:
            break;
          case 11:
            break;
          case 12:
            return this.pushState("SCALE"), 17;
          case 13:
            return 18;
          case 14:
            this.popState();
            break;
          case 15:
            return this.begin("acc_title"), 33;
          case 16:
            return this.popState(), "acc_title_value";
          case 17:
            return this.begin("acc_descr"), 35;
          case 18:
            return this.popState(), "acc_descr_value";
          case 19:
            this.begin("acc_descr_multiline");
            break;
          case 20:
            this.popState();
            break;
          case 21:
            return "acc_descr_multiline_value";
          case 22:
            return this.pushState("CLASSDEF"), 38;
          case 23:
            return this.popState(), this.pushState("CLASSDEFID"), "DEFAULT_CLASSDEF_ID";
          case 24:
            return this.popState(), this.pushState("CLASSDEFID"), 39;
          case 25:
            return this.popState(), 40;
          case 26:
            return this.pushState("CLASS"), 45;
          case 27:
            return this.popState(), this.pushState("CLASS_STYLE"), 46;
          case 28:
            return this.popState(), 47;
          case 29:
            return this.pushState("STYLE"), 42;
          case 30:
            return this.popState(), this.pushState("STYLEDEF_STYLES"), 43;
          case 31:
            return this.popState(), 44;
          case 32:
            return this.pushState("SCALE"), 17;
          case 33:
            return 18;
          case 34:
            this.popState();
            break;
          case 35:
            this.pushState("STATE");
            break;
          case 36:
            return this.popState(), a.yytext = /* @__PURE__ */ a.yytext.slice(0, -8).trim(), 25;
          case 37:
            return this.popState(), a.yytext = /* @__PURE__ */ a.yytext.slice(0, -8).trim(), 26;
          case 38:
            return this.popState(), a.yytext = /* @__PURE__ */ a.yytext.slice(0, -10).trim(), 27;
          case 39:
            return this.popState(), a.yytext = /* @__PURE__ */ a.yytext.slice(0, -8).trim(), 25;
          case 40:
            return this.popState(), a.yytext = /* @__PURE__ */ a.yytext.slice(0, -8).trim(), 26;
          case 41:
            return this.popState(), a.yytext = /* @__PURE__ */ a.yytext.slice(0, -10).trim(), 27;
          case 42:
            return 48;
          case 43:
            return 49;
          case 44:
            return 50;
          case 45:
            return 51;
          case 46:
            this.pushState("STATE_STRING");
            break;
          case 47:
            return this.pushState("STATE_ID"), "AS";
          case 48:
            return this.popState(), "ID";
          case 49:
            this.popState();
            break;
          case 50:
            return "STATE_DESCR";
          case 51:
            return 19;
          case 52:
            this.popState();
            break;
          case 53:
            return this.popState(), this.pushState("struct"), 20;
          case 54:
            break;
          case 55:
            return this.popState(), 21;
          case 56:
            break;
          case 57:
            return this.begin("NOTE"), 29;
          case 58:
            return this.popState(), this.pushState("NOTE_ID"), 56;
          case 59:
            return this.popState(), this.pushState("NOTE_ID"), 57;
          case 60:
            this.popState(), this.pushState("FLOATING_NOTE");
            break;
          case 61:
            return this.popState(), this.pushState("FLOATING_NOTE_ID"), "AS";
          case 62:
            break;
          case 63:
            return "NOTE_TEXT";
          case 64:
            return this.popState(), "ID";
          case 65:
            return this.popState(), this.pushState("NOTE_TEXT"), 24;
          case 66:
            return this.popState(), a.yytext = /* @__PURE__ */ a.yytext.substr(2).trim(), 31;
          case 67:
            return this.popState(), a.yytext = /* @__PURE__ */ a.yytext.slice(0, -8).trim(), 31;
          case 68:
            return 6;
          case 69:
            return 6;
          case 70:
            return 16;
          case 71:
            return 54;
          case 72:
            return 24;
          case 73:
            return a.yytext = /* @__PURE__ */ a.yytext.trim(), 14;
          case 74:
            return 15;
          case 75:
            return 28;
          case 76:
            return 55;
          case 77:
            return 5;
          case 78:
            return "INVALID";
        }
      }, "anonymous"),
      rules: [
        /^(?:default\b)/i,
        /^(?:.*direction\s+TB[^\n]*)/i,
        /^(?:.*direction\s+BT[^\n]*)/i,
        /^(?:.*direction\s+RL[^\n]*)/i,
        /^(?:.*direction\s+LR[^\n]*)/i,
        /^(?:%%(?!\{)[^\n]*)/i,
        /^(?:[^\}]%%[^\n]*)/i,
        /^(?:[\n]+)/i,
        /^(?:[\s]+)/i,
        /^(?:((?!\n)\s)+)/i,
        /^(?:#[^\n]*)/i,
        /^(?:%[^\n]*)/i,
        /^(?:scale\s+)/i,
        /^(?:\d+)/i,
        /^(?:\s+width\b)/i,
        /^(?:accTitle\s*:\s*)/i,
        /^(?:(?!\n||)*[^\n]*)/i,
        /^(?:accDescr\s*:\s*)/i,
        /^(?:(?!\n||)*[^\n]*)/i,
        /^(?:accDescr\s*\{\s*)/i,
        /^(?:[\}])/i,
        /^(?:[^\}]*)/i,
        /^(?:classDef\s+)/i,
        /^(?:DEFAULT\s+)/i,
        /^(?:\w+\s+)/i,
        /^(?:[^\n]*)/i,
        /^(?:class\s+)/i,
        /^(?:(\w+)+((,\s*\w+)*))/i,
        /^(?:[^\n]*)/i,
        /^(?:style\s+)/i,
        /^(?:[\w,]+\s+)/i,
        /^(?:[^\n]*)/i,
        /^(?:scale\s+)/i,
        /^(?:\d+)/i,
        /^(?:\s+width\b)/i,
        /^(?:state\s+)/i,
        /^(?:.*<<fork>>)/i,
        /^(?:.*<<join>>)/i,
        /^(?:.*<<choice>>)/i,
        /^(?:.*\[\[fork\]\])/i,
        /^(?:.*\[\[join\]\])/i,
        /^(?:.*\[\[choice\]\])/i,
        /^(?:.*direction\s+TB[^\n]*)/i,
        /^(?:.*direction\s+BT[^\n]*)/i,
        /^(?:.*direction\s+RL[^\n]*)/i,
        /^(?:.*direction\s+LR[^\n]*)/i,
        /^(?:["])/i,
        /^(?:\s*as\s+)/i,
        /^(?:[^\n\{]*)/i,
        /^(?:["])/i,
        /^(?:[^"]*)/i,
        /^(?:[^\n\s\{]+)/i,
        /^(?:\n)/i,
        /^(?:\{)/i,
        /^(?:%%(?!\{)[^\n]*)/i,
        /^(?:\})/i,
        /^(?:[\n])/i,
        /^(?:note\s+)/i,
        /^(?:left of\b)/i,
        /^(?:right of\b)/i,
        /^(?:")/i,
        /^(?:\s*as\s*)/i,
        /^(?:["])/i,
        /^(?:[^"]*)/i,
        /^(?:[^\n]*)/i,
        /^(?:\s*[^:\n\s\-]+)/i,
        /^(?:\s*:[^:\n;]+)/i,
        /^(?:[\s\S]*?end note\b)/i,
        /^(?:stateDiagram\s+)/i,
        /^(?:stateDiagram-v2\s+)/i,
        /^(?:hide empty description\b)/i,
        /^(?:\[\*\])/i,
        /^(?:[^:\n\s\-\{]+)/i,
        /^(?:\s*:[^:\n;]+)/i,
        /^(?:-->)/i,
        /^(?:--)/i,
        /^(?::::)/i,
        /^(?:$)/i,
        /^(?:.)/i
      ],
      conditions: {
        LINE: {
          rules: [
            9,
            10
          ],
          inclusive: false
        },
        struct: {
          rules: [
            9,
            10,
            22,
            26,
            29,
            35,
            42,
            43,
            44,
            45,
            54,
            55,
            56,
            57,
            71,
            72,
            73,
            74,
            75
          ],
          inclusive: false
        },
        FLOATING_NOTE_ID: {
          rules: [
            64
          ],
          inclusive: false
        },
        FLOATING_NOTE: {
          rules: [
            61,
            62,
            63
          ],
          inclusive: false
        },
        NOTE_TEXT: {
          rules: [
            66,
            67
          ],
          inclusive: false
        },
        NOTE_ID: {
          rules: [
            65
          ],
          inclusive: false
        },
        NOTE: {
          rules: [
            58,
            59,
            60
          ],
          inclusive: false
        },
        STYLEDEF_STYLEOPTS: {
          rules: [],
          inclusive: false
        },
        STYLEDEF_STYLES: {
          rules: [
            31
          ],
          inclusive: false
        },
        STYLE_IDS: {
          rules: [],
          inclusive: false
        },
        STYLE: {
          rules: [
            30
          ],
          inclusive: false
        },
        CLASS_STYLE: {
          rules: [
            28
          ],
          inclusive: false
        },
        CLASS: {
          rules: [
            27
          ],
          inclusive: false
        },
        CLASSDEFID: {
          rules: [
            25
          ],
          inclusive: false
        },
        CLASSDEF: {
          rules: [
            23,
            24
          ],
          inclusive: false
        },
        acc_descr_multiline: {
          rules: [
            20,
            21
          ],
          inclusive: false
        },
        acc_descr: {
          rules: [
            18
          ],
          inclusive: false
        },
        acc_title: {
          rules: [
            16
          ],
          inclusive: false
        },
        SCALE: {
          rules: [
            13,
            14,
            33,
            34
          ],
          inclusive: false
        },
        ALIAS: {
          rules: [],
          inclusive: false
        },
        STATE_ID: {
          rules: [
            48
          ],
          inclusive: false
        },
        STATE_STRING: {
          rules: [
            49,
            50
          ],
          inclusive: false
        },
        FORK_STATE: {
          rules: [],
          inclusive: false
        },
        STATE: {
          rules: [
            9,
            10,
            36,
            37,
            38,
            39,
            40,
            41,
            46,
            47,
            51,
            52,
            53
          ],
          inclusive: false
        },
        ID: {
          rules: [
            9,
            10
          ],
          inclusive: false
        },
        INITIAL: {
          rules: [
            0,
            1,
            2,
            3,
            4,
            5,
            6,
            7,
            8,
            10,
            11,
            12,
            15,
            17,
            19,
            22,
            26,
            29,
            32,
            35,
            53,
            57,
            68,
            69,
            70,
            71,
            72,
            73,
            74,
            76,
            77,
            78
          ],
          inclusive: true
        }
      }
    };
    return w2;
  }();
  Ct.lexer = je;
  function Lt() {
    this.yy = {};
  }
  return m$1(Lt, "Parser"), Lt.prototype = Ct, Ct.Parser = Lt, new Lt();
}();
Pt.parser = Pt;
var Is = Pt;
var Se = "LR", St = "TB", X = "state", et = "relation", ye = "classDef", Ee = "style", Te = "applyClass", H = "default", yt = "divider", Gt = "fill:none", wt = "fill: #333", $t = "c", Yt = "text", Ft = "normal", Et = "rect", Tt = "rectWithTitle", _e = "stateStart", ge = "stateEnd", Bt = "divider", Mt = "roundedWithTitle", be = "note", ke = "noteGroup", K = "statediagram", Ke = "state", me = `${K}-${Ke}`, Vt = "transition", Je = "note", qe = "note-edge", xe = `${Vt} ${qe}`, De = `${K}-${Je}`, Qe = "cluster", Ae = `${K}-${Qe}`, Ze = "cluster-alt", Ce = `${K}-${Ze}`, Ut = "parent", Ht = "note", Le = "state", _t = "----", Ie = `${_t}${Ht}`, jt = `${_t}${Ut}`;
var zt = /* @__PURE__ */ m$1(function(t) {
  let e = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : St;
  if (!t.doc) return e;
  let l = e;
  for (let n of t.doc) n.stmt === "dir" && (l = n.value);
  return l;
}, "getDir"), ts = /* @__PURE__ */ m$1(function(t, e) {
  return e.db.extract(/* @__PURE__ */ e.db.getRootDocV2()), e.db.getClasses();
}, "getClasses"), es = /* @__PURE__ */ m$1(async function(t, e, l, n) {
  tt.info("REF0:"), tt.info("Drawing state diagram (v2)", e);
  let { securityLevel: p, state: i, layout: d } = Wl();
  n.db.extract(/* @__PURE__ */ n.db.getRootDocV2());
  let E = /* @__PURE__ */ n.db.getData(), o = /* @__PURE__ */ w(e, p);
  E.type = n.type, E.layoutAlgorithm = d, E.nodeSpacing = (i == null ? void 0 : i.nodeSpacing) || 50, E.rankSpacing = (i == null ? void 0 : i.rankSpacing) || 50, E.markers = [
    "barb"
  ], E.diagramId = e, await S(E, o);
  let _ = 8;
  Ie$1.insertTitle(o, "statediagramTitleText", (i == null ? void 0 : i.titleTopMargin) ?? 25, /* @__PURE__ */ n.db.getDiagramTitle()), $$1(o, _, K, (i == null ? void 0 : i.useMaxWidth) ?? true);
}, "draw"), Bs = {
  getClasses: ts,
  draw: es,
  getDir: zt
};
var bt = /* @__PURE__ */ new Map(), $ = 0;
function Wt() {
  let t = arguments.length > 0 && arguments[0] !== void 0 ? arguments[0] : "", e = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : 0, l = arguments.length > 2 && arguments[2] !== void 0 ? arguments[2] : "", n = arguments.length > 3 && arguments[3] !== void 0 ? arguments[3] : _t;
  let p = l !== null && l.length > 0 ? `${n}${l}` : "";
  return `${Le}-${t}${p}-${e}`;
}
m$1(Wt, "stateDomId");
var ss = /* @__PURE__ */ m$1((t, e, l, n, p, i, d, E) => {
  tt.trace("items", e), e.forEach((o) => {
    switch (o.stmt) {
      case X:
        J(t, o, l, n, p, i, d, E);
        break;
      case H:
        J(t, o, l, n, p, i, d, E);
        break;
      case et:
        {
          J(t, o.state1, l, n, p, i, d, E), J(t, o.state2, l, n, p, i, d, E);
          let _ = {
            id: "edge" + $,
            start: o.state1.id,
            end: o.state2.id,
            arrowhead: "normal",
            arrowTypeEnd: "arrow_barb",
            style: Gt,
            labelStyle: "",
            label: /* @__PURE__ */ mC.sanitizeText(o.description, /* @__PURE__ */ Wl()),
            arrowheadStyle: wt,
            labelpos: $t,
            labelType: Yt,
            thickness: Ft,
            classes: Vt,
            look: d
          };
          p.push(_), $++;
        }
        break;
    }
  });
}, "setupDoc"), Re = /* @__PURE__ */ m$1(function(t) {
  let e = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : St;
  let l = e;
  if (t.doc) for (let n of t.doc) n.stmt === "dir" && (l = n.value);
  return l;
}, "getDir");
function gt(t, e, l) {
  if (!e.id || e.id === "</join></fork>" || e.id === "</choice>") return;
  e.cssClasses && (Array.isArray(e.cssCompiledStyles) || (e.cssCompiledStyles = []), e.cssClasses.split(" ").forEach((p) => {
    if (l.get(p)) {
      let i = /* @__PURE__ */ l.get(p);
      e.cssCompiledStyles = [
        ...e.cssCompiledStyles,
        ...i.styles
      ];
    }
  }));
  let n = /* @__PURE__ */ t.find((p) => p.id === e.id);
  n ? Object.assign(n, e) : t.push(e);
}
m$1(gt, "insertOrUpdateNode");
function rs(t) {
  var _a;
  return ((_a = t == null ? void 0 : t.classes) == null ? void 0 : _a.join(" ")) ?? "";
}
m$1(rs, "getClassesFromDbInfo");
function is(t) {
  return (t == null ? void 0 : t.styles) ?? [];
}
m$1(is, "getStylesFromDbInfo");
var J = /* @__PURE__ */ m$1((t, e, l, n, p, i, d, E) => {
  var _a, _b;
  let o = e.id, _ = /* @__PURE__ */ l.get(o), k = /* @__PURE__ */ rs(_), N = /* @__PURE__ */ is(_);
  if (tt.info("dataFetcher parsedItem", e, _, N), o !== "root") {
    let I = Et;
    e.start === true ? I = _e : e.start === false && (I = ge), e.type !== H && (I = e.type), bt.get(o) || bt.set(o, {
      id: o,
      shape: I,
      description: /* @__PURE__ */ mC.sanitizeText(o, /* @__PURE__ */ Wl()),
      cssClasses: `${k} ${me}`,
      cssStyles: N
    });
    let f = /* @__PURE__ */ bt.get(o);
    e.description && (Array.isArray(f.description) ? (f.shape = Tt, f.description.push(e.description)) : ((_a = f.description) == null ? void 0 : _a.length) > 0 ? (f.shape = Tt, f.description === o ? f.description = [
      e.description
    ] : f.description = [
      f.description,
      e.description
    ]) : (f.shape = Et, f.description = e.description), f.description = /* @__PURE__ */ mC.sanitizeTextOrArray(f.description, /* @__PURE__ */ Wl())), ((_b = f.description) == null ? void 0 : _b.length) === 1 && f.shape === Tt && (f.type === "group" ? f.shape = Mt : f.shape = Et), !f.type && e.doc && (tt.info("Setting cluster for XCX", o, /* @__PURE__ */ Re(e)), f.type = "group", f.isGroup = true, f.dir = /* @__PURE__ */ Re(e), f.shape = e.type === yt ? Bt : Mt, f.cssClasses = `${f.cssClasses} ${Ae} ${i ? Ce : ""}`);
    let L = {
      labelStyle: "",
      shape: f.shape,
      label: f.description,
      cssClasses: f.cssClasses,
      cssCompiledStyles: [],
      cssStyles: f.cssStyles,
      id: o,
      dir: f.dir,
      domId: /* @__PURE__ */ Wt(o, $),
      type: f.type,
      isGroup: f.type === "group",
      padding: 8,
      rx: 10,
      ry: 10,
      look: d
    };
    if (L.shape === Bt && (L.label = ""), t && t.id !== "root" && (tt.trace("Setting node ", o, " to be child of its parent ", t.id), L.parentId = t.id), L.centerLabel = true, e.note) {
      let R = {
        labelStyle: "",
        shape: be,
        label: e.note.text,
        cssClasses: De,
        cssStyles: [],
        cssCompilesStyles: [],
        id: o + Ie + "-" + $,
        domId: /* @__PURE__ */ Wt(o, $, Ht),
        type: f.type,
        isGroup: f.type === "group",
        padding: Wl().flowchart.padding,
        look: d,
        position: e.note.position
      }, F = o + jt, B = {
        labelStyle: "",
        shape: ke,
        label: e.note.text,
        cssClasses: f.cssClasses,
        cssStyles: [],
        id: o + jt,
        domId: /* @__PURE__ */ Wt(o, $, Ut),
        type: "group",
        isGroup: true,
        padding: 16,
        look: d,
        position: e.note.position
      };
      $++, B.id = F, R.parentId = F, gt(n, B, E), gt(n, R, E), gt(n, L, E);
      let P = o, G = R.id;
      e.note.position === "left of" && (P = R.id, G = o), p.push({
        id: P + "-" + G,
        start: P,
        end: G,
        arrowhead: "none",
        arrowTypeEnd: "",
        style: Gt,
        labelStyle: "",
        classes: xe,
        arrowheadStyle: wt,
        labelpos: $t,
        labelType: Yt,
        thickness: Ft,
        look: d
      });
    } else gt(n, L, E);
  }
  e.doc && (tt.trace("Adding nodes children "), ss(e, e.doc, l, n, p, !i, d, E));
}, "dataFetcher"), ve = /* @__PURE__ */ m$1(() => {
  bt.clear(), $ = 0;
}, "reset");
var qt = "[*]", Ge = "start", we = qt, $e = "end", Oe = "color", Ne = "fill", ns = "bgFill", as = ",";
function Ye() {
  return /* @__PURE__ */ new Map();
}
m$1(Ye, "newClassesList");
var xt = [], Qt = [], Fe = Se, Dt = [], q = /* @__PURE__ */ Ye(), Be = /* @__PURE__ */ m$1(() => ({
  relations: [],
  states: /* @__PURE__ */ new Map(),
  documents: {}
}), "newDoc"), At = {
  root: /* @__PURE__ */ Be()
}, D = At.root, st = 0, Pe = 0, os = {
  LINE: 0,
  DOTTED_LINE: 1
}, cs = {
  AGGREGATION: 0,
  EXTENSION: 1,
  COMPOSITION: 2,
  DEPENDENCY: 3
}, kt = /* @__PURE__ */ m$1((t) => JSON.parse(/* @__PURE__ */ JSON.stringify(t)), "clone"), ls = /* @__PURE__ */ m$1((t) => {
  tt.info("Setting root doc", t), Dt = t;
}, "setRootDoc"), us = /* @__PURE__ */ m$1(() => Dt, "getRootDoc"), mt = m$1((t, e, l) => {
  if (e.stmt === et) mt(t, e.state1, true), mt(t, e.state2, false);
  else if (e.stmt === X && (e.id === "[*]" ? (e.id = l ? t.id + "_start" : t.id + "_end", e.start = l) : e.id = /* @__PURE__ */ e.id.trim()), e.doc) {
    let n = [], p = [], i;
    for (i = 0; i < e.doc.length; i++) if (e.doc[i].type === yt) {
      let d = /* @__PURE__ */ kt(e.doc[i]);
      d.doc = /* @__PURE__ */ kt(p), n.push(d), p = [];
    } else p.push(e.doc[i]);
    if (n.length > 0 && p.length > 0) {
      let d = {
        stmt: X,
        id: /* @__PURE__ */ Ce$1(),
        type: "divider",
        doc: /* @__PURE__ */ kt(p)
      };
      n.push(/* @__PURE__ */ kt(d)), e.doc = n;
    }
    e.doc.forEach((d) => mt(e, d, true));
  }
}, "docTranslator"), Zt = /* @__PURE__ */ m$1(() => (mt({
  id: "root"
}, {
  id: "root",
  doc: Dt
}, true), {
  id: "root",
  doc: Dt
}), "getRootDocV2"), hs = /* @__PURE__ */ m$1((t) => {
  let e;
  t.doc ? e = t.doc : e = t, tt.info(e), Me(true), tt.info("Extract initial document:", e), e.forEach((i) => {
    switch (tt.warn("Statement", i.stmt), i.stmt) {
      case X:
        Y(/* @__PURE__ */ i.id.trim(), i.type, i.doc, i.description, i.note, i.classes, i.styles, i.textStyles);
        break;
      case et:
        Ue(i.state1, i.state2, i.description);
        break;
      case ye:
        He(/* @__PURE__ */ i.id.trim(), i.classes);
        break;
      case Ee:
        {
          let d = /* @__PURE__ */ i.id.trim().split(","), E = /* @__PURE__ */ i.styleClass.split(",");
          d.forEach((o) => {
            let _ = /* @__PURE__ */ j(o);
            if (_ === void 0) {
              let k = /* @__PURE__ */ o.trim();
              Y(k), _ = /* @__PURE__ */ j(k);
            }
            _.styles = /* @__PURE__ */ E.map((k) => {
              var _a;
              return (_a = k.replace(/;/g, "")) == null ? void 0 : _a.trim();
            });
          });
        }
        break;
      case Te:
        te(/* @__PURE__ */ i.id.trim(), i.styleClass);
        break;
    }
  });
  let l = /* @__PURE__ */ Ve(), p = Wl().look;
  ve(), J(void 0, /* @__PURE__ */ Zt(), l, xt, Qt, true, p, q), xt.forEach((i) => {
    if (Array.isArray(i.label)) {
      if (i.description = /* @__PURE__ */ i.label.slice(1), i.isGroup && i.description.length > 0) throw new Error("Group nodes can only have label. Remove the additional description for node [" + i.id + "]");
      i.label = i.label[0];
    }
  });
}, "extract"), Y = /* @__PURE__ */ m$1(function(t) {
  let e = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : H, l = arguments.length > 2 && arguments[2] !== void 0 ? arguments[2] : null, n = arguments.length > 3 && arguments[3] !== void 0 ? arguments[3] : null, p = arguments.length > 4 && arguments[4] !== void 0 ? arguments[4] : null, i = arguments.length > 5 && arguments[5] !== void 0 ? arguments[5] : null, d = arguments.length > 6 && arguments[6] !== void 0 ? arguments[6] : null, E = arguments.length > 7 && arguments[7] !== void 0 ? arguments[7] : null;
  let o = t == null ? void 0 : t.trim();
  if (D.states.has(o) ? (D.states.get(o).doc || (D.states.get(o).doc = l), D.states.get(o).type || (D.states.get(o).type = e)) : (tt.info("Adding state ", o, n), D.states.set(o, {
    id: o,
    descriptions: [],
    type: e,
    doc: l,
    note: p,
    classes: [],
    styles: [],
    textStyles: []
  })), n && (tt.info("Setting state description", o, n), typeof n == "string" && Jt(o, /* @__PURE__ */ n.trim()), typeof n == "object" && n.forEach((_) => Jt(o, /* @__PURE__ */ _.trim()))), p) {
    let _ = /* @__PURE__ */ D.states.get(o);
    _.note = p, _.note.text = /* @__PURE__ */ mC.sanitizeText(_.note.text, /* @__PURE__ */ Wl());
  }
  i && (tt.info("Setting state classes", o, i), (typeof i == "string" ? [
    i
  ] : i).forEach((k) => te(o, /* @__PURE__ */ k.trim()))), d && (tt.info("Setting state styles", o, d), (typeof d == "string" ? [
    d
  ] : d).forEach((k) => gs(o, /* @__PURE__ */ k.trim()))), E && (tt.info("Setting state styles", o, d), (typeof E == "string" ? [
    E
  ] : E).forEach((k) => bs(o, /* @__PURE__ */ k.trim())));
}, "addState"), Me = /* @__PURE__ */ m$1(function(t) {
  xt = [], Qt = [], At = {
    root: /* @__PURE__ */ Be()
  }, D = At.root, st = 0, q = /* @__PURE__ */ Ye(), t || bf();
}, "clear"), j = /* @__PURE__ */ m$1(function(t) {
  return D.states.get(t);
}, "getState"), Ve = /* @__PURE__ */ m$1(function() {
  return D.states;
}, "getStates"), ps = /* @__PURE__ */ m$1(function() {
  tt.info("Documents = ", At);
}, "logDocuments"), fs = /* @__PURE__ */ m$1(function() {
  return D.relations;
}, "getRelations");
function Xt() {
  let t = arguments.length > 0 && arguments[0] !== void 0 ? arguments[0] : "";
  let e = t;
  return t === qt && (st++, e = `${Ge}${st}`), e;
}
m$1(Xt, "startIdIfNeeded");
function Kt() {
  let t = arguments.length > 0 && arguments[0] !== void 0 ? arguments[0] : "", e = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : H;
  return t === qt ? Ge : e;
}
m$1(Kt, "startTypeIfNeeded");
function ds() {
  let t = arguments.length > 0 && arguments[0] !== void 0 ? arguments[0] : "";
  let e = t;
  return t === we && (st++, e = `${$e}${st}`), e;
}
m$1(ds, "endIdIfNeeded");
function Ss() {
  let t = arguments.length > 0 && arguments[0] !== void 0 ? arguments[0] : "", e = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : H;
  return t === we ? $e : e;
}
m$1(Ss, "endTypeIfNeeded");
function ys(t, e, l) {
  let n = /* @__PURE__ */ Xt(/* @__PURE__ */ t.id.trim()), p = /* @__PURE__ */ Kt(/* @__PURE__ */ t.id.trim(), t.type), i = /* @__PURE__ */ Xt(/* @__PURE__ */ e.id.trim()), d = /* @__PURE__ */ Kt(/* @__PURE__ */ e.id.trim(), e.type);
  Y(n, p, t.doc, t.description, t.note, t.classes, t.styles, t.textStyles), Y(i, d, e.doc, e.description, e.note, e.classes, e.styles, e.textStyles), D.relations.push({
    id1: n,
    id2: i,
    relationTitle: /* @__PURE__ */ mC.sanitizeText(l, /* @__PURE__ */ Wl())
  });
}
m$1(ys, "addRelationObjs");
var Ue = /* @__PURE__ */ m$1(function(t, e, l) {
  if (typeof t == "object") ys(t, e, l);
  else {
    let n = /* @__PURE__ */ Xt(/* @__PURE__ */ t.trim()), p = /* @__PURE__ */ Kt(t), i = /* @__PURE__ */ ds(/* @__PURE__ */ e.trim()), d = /* @__PURE__ */ Ss(e);
    Y(n, p), Y(i, d), D.relations.push({
      id1: n,
      id2: i,
      title: /* @__PURE__ */ mC.sanitizeText(l, /* @__PURE__ */ Wl())
    });
  }
}, "addRelation"), Jt = /* @__PURE__ */ m$1(function(t, e) {
  let l = /* @__PURE__ */ D.states.get(t), n = e.startsWith(":") ? e.replace(":", "").trim() : e;
  l.descriptions.push(/* @__PURE__ */ mC.sanitizeText(n, /* @__PURE__ */ Wl()));
}, "addDescription"), Es = /* @__PURE__ */ m$1(function(t) {
  return t.substring(0, 1) === ":" ? t.substr(2).trim() : t.trim();
}, "cleanupLabel"), Ts = /* @__PURE__ */ m$1(() => (Pe++, "divider-id-" + Pe), "getDividerId"), He = /* @__PURE__ */ m$1(function(t) {
  let e = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : "";
  q.has(t) || q.set(t, {
    id: t,
    styles: [],
    textStyles: []
  });
  let l = /* @__PURE__ */ q.get(t);
  e == null ? void 0 : e.split(as).forEach((n) => {
    let p = /* @__PURE__ */ n.replace(/([^;]*);/, "$1").trim();
    if (RegExp(Oe).exec(n)) {
      let d = /* @__PURE__ */ p.replace(Ne, ns).replace(Oe, Ne);
      l.textStyles.push(d);
    }
    l.styles.push(p);
  });
}, "addStyleClass"), _s = /* @__PURE__ */ m$1(function() {
  return q;
}, "getClasses"), te = /* @__PURE__ */ m$1(function(t, e) {
  t.split(",").forEach(function(l) {
    let n = /* @__PURE__ */ j(l);
    if (n === void 0) {
      let p = /* @__PURE__ */ l.trim();
      Y(p), n = /* @__PURE__ */ j(p);
    }
    n.classes.push(e);
  });
}, "setCssClass"), gs = /* @__PURE__ */ m$1(function(t, e) {
  let l = /* @__PURE__ */ j(t);
  l !== void 0 && l.styles.push(e);
}, "setStyle"), bs = /* @__PURE__ */ m$1(function(t, e) {
  let l = /* @__PURE__ */ j(t);
  l !== void 0 && l.textStyles.push(e);
}, "setTextStyle"), ks = /* @__PURE__ */ m$1(() => Fe, "getDirection"), ms = /* @__PURE__ */ m$1((t) => {
  Fe = t;
}, "setDirection"), xs = /* @__PURE__ */ m$1((t) => t && t[0] === ":" ? t.substr(1).trim() : t.trim(), "trimColon"), Ds = /* @__PURE__ */ m$1(() => {
  let t = /* @__PURE__ */ Wl();
  return {
    nodes: xt,
    edges: Qt,
    other: {},
    config: t,
    direction: /* @__PURE__ */ zt(/* @__PURE__ */ Zt())
  };
}, "getData"), rr = {
  getConfig: /* @__PURE__ */ m$1(() => Wl().state, "getConfig"),
  getData: Ds,
  addState: Y,
  clear: Me,
  getState: j,
  getStates: Ve,
  getRelations: fs,
  getClasses: _s,
  getDirection: ks,
  addRelation: Ue,
  getDividerId: Ts,
  setDirection: ms,
  cleanupLabel: Es,
  lineType: os,
  relationType: cs,
  logDocuments: ps,
  getRootDoc: us,
  setRootDoc: ls,
  getRootDocV2: Zt,
  extract: hs,
  trimColon: xs,
  getAccTitle: kf,
  setAccTitle: Tf,
  getAccDescription: vf,
  setAccDescription: Sf,
  addStyleClass: He,
  setCssClass: te,
  addDescription: Jt,
  setDiagramTitle: wf,
  getDiagramTitle: Bf
};
var As = /* @__PURE__ */ m$1((t) => `
defs #statediagram-barbEnd {
    fill: ${t.transitionColor};
    stroke: ${t.transitionColor};
  }
g.stateGroup text {
  fill: ${t.nodeBorder};
  stroke: none;
  font-size: 10px;
}
g.stateGroup text {
  fill: ${t.textColor};
  stroke: none;
  font-size: 10px;

}
g.stateGroup .state-title {
  font-weight: bolder;
  fill: ${t.stateLabelColor};
}

g.stateGroup rect {
  fill: ${t.mainBkg};
  stroke: ${t.nodeBorder};
}

g.stateGroup line {
  stroke: ${t.lineColor};
  stroke-width: 1;
}

.transition {
  stroke: ${t.transitionColor};
  stroke-width: 1;
  fill: none;
}

.stateGroup .composit {
  fill: ${t.background};
  border-bottom: 1px
}

.stateGroup .alt-composit {
  fill: #e0e0e0;
  border-bottom: 1px
}

.state-note {
  stroke: ${t.noteBorderColor};
  fill: ${t.noteBkgColor};

  text {
    fill: ${t.noteTextColor};
    stroke: none;
    font-size: 10px;
  }
}

.stateLabel .box {
  stroke: none;
  stroke-width: 0;
  fill: ${t.mainBkg};
  opacity: 0.5;
}

.edgeLabel .label rect {
  fill: ${t.labelBackgroundColor};
  opacity: 0.5;
}
.edgeLabel {
  background-color: ${t.edgeLabelBackground};
  p {
    background-color: ${t.edgeLabelBackground};
  }
  rect {
    opacity: 0.5;
    background-color: ${t.edgeLabelBackground};
    fill: ${t.edgeLabelBackground};
  }
  text-align: center;
}
.edgeLabel .label text {
  fill: ${t.transitionLabelColor || t.tertiaryTextColor};
}
.label div .edgeLabel {
  color: ${t.transitionLabelColor || t.tertiaryTextColor};
}

.stateLabel text {
  fill: ${t.stateLabelColor};
  font-size: 10px;
  font-weight: bold;
}

.node circle.state-start {
  fill: ${t.specialStateColor};
  stroke: ${t.specialStateColor};
}

.node .fork-join {
  fill: ${t.specialStateColor};
  stroke: ${t.specialStateColor};
}

.node circle.state-end {
  fill: ${t.innerEndBackground};
  stroke: ${t.background};
  stroke-width: 1.5
}
.end-state-inner {
  fill: ${t.compositeBackground || t.background};
  // stroke: ${t.background};
  stroke-width: 1.5
}

.node rect {
  fill: ${t.stateBkg || t.mainBkg};
  stroke: ${t.stateBorder || t.nodeBorder};
  stroke-width: 1px;
}
.node polygon {
  fill: ${t.mainBkg};
  stroke: ${t.stateBorder || t.nodeBorder};;
  stroke-width: 1px;
}
#statediagram-barbEnd {
  fill: ${t.lineColor};
}

.statediagram-cluster rect {
  fill: ${t.compositeTitleBackground};
  stroke: ${t.stateBorder || t.nodeBorder};
  stroke-width: 1px;
}

.cluster-label, .nodeLabel {
  color: ${t.stateLabelColor};
  // line-height: 1;
}

.statediagram-cluster rect.outer {
  rx: 5px;
  ry: 5px;
}
.statediagram-state .divider {
  stroke: ${t.stateBorder || t.nodeBorder};
}

.statediagram-state .title-state {
  rx: 5px;
  ry: 5px;
}
.statediagram-cluster.statediagram-cluster .inner {
  fill: ${t.compositeBackground || t.background};
}
.statediagram-cluster.statediagram-cluster-alt .inner {
  fill: ${t.altBackground ? t.altBackground : "#efefef"};
}

.statediagram-cluster .inner {
  rx:0;
  ry:0;
}

.statediagram-state rect.basic {
  rx: 5px;
  ry: 5px;
}
.statediagram-state rect.divider {
  stroke-dasharray: 10,10;
  fill: ${t.altBackground ? t.altBackground : "#efefef"};
}

.note-edge {
  stroke-dasharray: 5;
}

.statediagram-note rect {
  fill: ${t.noteBkgColor};
  stroke: ${t.noteBorderColor};
  stroke-width: 1px;
  rx: 0;
  ry: 0;
}
.statediagram-note rect {
  fill: ${t.noteBkgColor};
  stroke: ${t.noteBorderColor};
  stroke-width: 1px;
  rx: 0;
  ry: 0;
}

.statediagram-note text {
  fill: ${t.noteTextColor};
}

.statediagram-note .nodeLabel {
  color: ${t.noteTextColor};
}
.statediagram .edgeLabel {
  color: red; // ${t.noteTextColor};
}

#dependencyStart, #dependencyEnd {
  fill: ${t.lineColor};
  stroke: ${t.lineColor};
  stroke-width: 1;
}

.statediagramTitleText {
  text-anchor: middle;
  font-size: 18px;
  fill: ${t.textColor};
}
`, "getStyles"), ar = As;
export {
  Bs as B,
  Is as I,
  ar as a,
  rr as r
};
